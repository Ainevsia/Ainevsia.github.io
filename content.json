{"meta":{"title":"Ainevsia's Blog","subtitle":"Coding without learning ends in danger.","description":"Personal Blog","author":"Ainevsia","url":"https://ainevsia.github.io"},"pages":[{"title":"categories","date":"2018-08-15T12:21:57.000Z","updated":"2018-08-15T12:22:40.265Z","comments":true,"path":"categories/index.html","permalink":"https://ainevsia.github.io/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-08-15T12:20:23.000Z","updated":"2018-08-15T12:21:32.967Z","comments":true,"path":"tags/index.html","permalink":"https://ainevsia.github.io/tags/index.html","excerpt":"","text":""},{"title":"关于","date":"2018-10-17T05:56:43.000Z","updated":"2019-02-15T12:21:20.527Z","comments":true,"path":"about/index.html","permalink":"https://ainevsia.github.io/about/index.html","excerpt":"","text":"关于我学生，没有什么朋友。 关于本站系列文章本站有一些文章可成系列，其余文章则随心所致。成系列的文章，被收纳在系列当中： 浙大PAT 版权与协议若无特殊说明，本站所有文章均为原创文章，并遵循 CC BY-SA 4.0 协议发布。 你可以自由地对博客中内容进行分享、创作演绎直至商业性的使用，但必须在文章末尾或参考文献处注明文章的出处（文章链接）。完整的协议可以参看这里。"},{"title":"","date":"2019-02-15T07:32:38.714Z","updated":"2019-02-15T07:32:38.714Z","comments":true,"path":"lib/canvas-ribbon/canvas-ribbon.js","permalink":"https://ainevsia.github.io/lib/canvas-ribbon/canvas-ribbon.js","excerpt":"","text":"/** * Created by zproo on 2017/4/8. */ !function () { function getAttr(script, attr, default_val) { return Number(script.getAttribute(attr)) || default_val; } // 获取自定义配置 var ribbon = document.getElementById('ribbon'); // 当前加载的script config = { zIndex: getAttr(ribbon, \"zIndex\", -1), // z-index alpha: getAttr(ribbon, \"alpha\", 0.6), // alpha ribbon_width: getAttr(ribbon, \"size\", 90), // size }; var canvas = document.createElement(\"canvas\"); canvas.style.cssText = \"position:fixed;top:0;left:0;z-index:\"+config.zIndex; document.getElementsByTagName(\"body\")[0].appendChild(canvas); var canvasRibbon = canvas, ctx = canvasRibbon.getContext('2d'), // 获取canvas 2d上下文 dpr = window.devicePixelRatio || 1, // the size of one CSS pixel to the size of one physical pixel. width = window.innerWidth, // 返回窗口的文档显示区的宽高 height = window.innerHeight, RIBBON_WIDTH = config.ribbon_width, path, math = Math, r = 0, PI_2 = math.PI * 2, // 圆周率*2 cos = math.cos, // cos函数返回一个数值的余弦值（-1~1） random = math.random; // 返回0-1随机数 canvasRibbon.width = width * dpr; // 返回实际宽高 canvasRibbon.height = height * dpr; ctx.scale(dpr, dpr); // 水平、竖直方向缩放 ctx.globalAlpha = config.alpha; // 图形透明度 function init() { ctx.clearRect(0, 0, width, height); // 擦除之前绘制内容 path = [{x: 0, y: height * 0.7 + RIBBON_WIDTH}, {x: 0, y: height * 0.7 - RIBBON_WIDTH}]; // 路径没有填满屏幕宽度时，绘制路径 while (path[1].x < width + RIBBON_WIDTH) { draw(path[0], path[1]) } } function draw(start, end) { ctx.beginPath(); // 创建一个新的路径 ctx.moveTo(start.x, start.y); // path起点 ctx.lineTo(end.x, end.y); // path终点 var nextX = end.x + (random() * 2 - 0.25) * RIBBON_WIDTH, nextY = geneY(end.y); ctx.lineTo(nextX, nextY); ctx.closePath(); r -= PI_2 / -50; // 随机生成并设置canvas路径16进制颜色 ctx.fillStyle = '#' + (cos(r) * 127 + 128"},{"title":"","date":"2019-02-15T07:32:38.714Z","updated":"2019-02-15T07:32:38.714Z","comments":true,"path":"lib/canvas-ribbon/README.html","permalink":"https://ainevsia.github.io/lib/canvas-ribbon/README.html","excerpt":"","text":"canvas-ribbon.js for NexT Installation Step 1 &rarr; Go to NexT dir Change dir to NexT directory. There must be layout, source, languages and other directories: 123$ cd themes/next$ lsbower.json _config.yml docs gulpfile.coffee languages layout LICENSE.md package.json README.md scripts source test Step 2 &rarr; Get module Install module to source/lib directory: 1$ git clone https://github.com/theme-next/theme-next-canvas-ribbon source/lib/canvas-ribbon Step 3 &rarr; Set it up Enable module in NexT _config.yml file: 12canvas_ribbon: enable: true Update 12$ cd themes/next/source/lib/canvas-ribbon$ git pull"},{"title":"","date":"2019-02-15T07:57:56.277Z","updated":"2019-02-15T07:57:56.277Z","comments":true,"path":"lib/fancybox/README.html","permalink":"https://ainevsia.github.io/lib/fancybox/README.html","excerpt":"","text":"fancyBox 3 for NexT If you want fancybox v2, please go to theme-next-fancybox Installation Step 0 &rarr; Delete fancybox 2 (if you want to upgrade from v2) 1$ rm -rf themes/next/source/lib/fancybox Step 1 &rarr; Go to NexT dir Change dir to NexT directory. There must be layout, source, languages and other directories: 123$ cd themes/next$ lsbower.json _config.yml docs gulpfile.coffee languages layout LICENSE.md package.json README.md scripts source test Step 2 &rarr; Get module Install module to source/lib directory: 1$ git clone https://github.com/theme-next/theme-next-fancybox3 source/lib/fancybox Step 3 &rarr; Set it up Enable module in NexT _config.yml file: 1fancybox: true Update 12$ cd themes/next/source/lib/fancybox$ git pull"},{"title":"","date":"2019-02-15T07:41:43.389Z","updated":"2019-02-15T07:41:43.389Z","comments":true,"path":"lib/three/canvas_lines.min.js","permalink":"https://ainevsia.github.io/lib/three/canvas_lines.min.js","excerpt":"","text":"$(function(){var s,l,c,t=0,i=0,r=window.innerWidth/2,n=window.innerHeight/2;function p(){r=window.innerWidth/2,n=window.innerHeight/2,s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),c.setSize(window.innerWidth,window.innerHeight)}function E(e){t=e.clientX-r,i=e.clientY-n}function d(e){1"},{"title":"","date":"2019-02-15T07:41:43.389Z","updated":"2019-02-15T07:41:43.389Z","comments":true,"path":"lib/three/gulpfile.js","permalink":"https://ainevsia.github.io/lib/three/gulpfile.js","excerpt":"","text":"const fs = require('fs') const del = require('del') const gulp = require('gulp') const concat = require('gulp-concat') const uglify = require('gulp-uglify') gulp.task('clean', () => { del(['*.min.js', '!three.min.js']) }) gulp.task('scripts', () => { const sourceFiles = fs.readdirSync('src') sourceFiles.forEach(file => { const fileName = file.split('.')[0] return gulp.src([`src/${fileName}.js`, 'lib/*.js']) .pipe(concat(`${fileName}.min.js`)) .pipe(uglify()) .pipe(gulp.dest('./')) }) }) gulp.task('default', ['clean', 'scripts'])"},{"title":"","date":"2019-02-15T07:41:43.389Z","updated":"2019-02-15T07:41:43.389Z","comments":true,"path":"lib/three/canvas_sphere.min.js","permalink":"https://ainevsia.github.io/lib/three/canvas_sphere.min.js","excerpt":"","text":"$(function(){var c,p,E,d=window.innerWidth,h=window.innerHeight,t=0,r=0,i=window.innerWidth/2,n=window.innerHeight/2;function f(){i=window.innerWidth/2,n=window.innerHeight/2,c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix(),E.setSize(window.innerWidth,window.innerHeight)}function u(e){t=e.clientX-i,r=e.clientY-n}function m(e){1"},{"title":"","date":"2019-02-15T07:46:16.755Z","updated":"2019-02-15T07:46:16.755Z","comments":true,"path":"lib/pace/pace-theme-big-counter.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-big-counter.min.css","excerpt":"","text":".pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace.pace-inactive .pace-progress{display:none}.pace .pace-progress{position:fixed;z-index:2000;top:0;right:0;height:5rem;width:5rem;-webkit-transform:translate3d(0,0,0)!important;-ms-transform:translate3d(0,0,0)!important;transform:translate3d(0,0,0)!important}.pace .pace-progress:after{display:block;position:absolute;top:0;right:.5rem;content:attr(data-progress-text);font-family:\"Helvetica Neue\",sans-serif;font-weight:100;font-size:5rem;line-height:1;text-align:right;color:rgba(34,153,221,.19999999999999996)}"},{"title":"","date":"2019-02-15T07:46:16.746Z","updated":"2019-02-15T07:46:16.746Z","comments":true,"path":"lib/pace/README.html","permalink":"https://ainevsia.github.io/lib/pace/README.html","excerpt":"","text":"Load bar at the top for NexT Installation Step 1 &rarr; Go to NexT dir Change dir to NexT directory. There must be layout, source, languages and other directories: 123$ cd themes/next$ lsbower.json _config.yml docs gulpfile.coffee languages layout LICENSE.md package.json README.md scripts source test Step 2 &rarr; Get module Install module to source/lib directory: 1$ git clone https://github.com/theme-next/theme-next-pace source/lib/pace Step 3 &rarr; Set it up Enable module in NexT _config.yml file: 1pace: true Update 12$ cd themes/next/source/lib/pace$ git pull"},{"title":"","date":"2019-02-15T07:46:16.757Z","updated":"2019-02-15T07:46:16.757Z","comments":true,"path":"lib/pace/pace-theme-center-atom.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-center-atom.min.css","excerpt":"","text":".pace,.pace .pace-progress{z-index:2000;height:60px;width:100px}.pace .pace-activity,.pace .pace-progress:before{border-radius:50%;display:block;position:absolute}.pace.pace-inactive{display:none}.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;position:fixed;margin:auto;top:0;left:0;right:0;bottom:0}.pace .pace-progress{position:absolute;-webkit-transform:translate3d(0,0,0)!important;-ms-transform:translate3d(0,0,0)!important;transform:translate3d(0,0,0)!important}.pace .pace-progress:before{content:attr(data-progress-text);text-align:center;color:#fff;background:#29d;font-family:\"Helvetica Neue\",sans-serif;font-size:14px;font-weight:100;line-height:1;padding:20% 0 7px;width:50%;height:40%;margin:10px 0 0 30px;z-index:999}.pace .pace-activity{font-size:15px;line-height:1;z-index:2000;-webkit-animation:pace-theme-center-atom-spin 2s linear infinite;-moz-animation:pace-theme-center-atom-spin 2s linear infinite;-o-animation:pace-theme-center-atom-spin 2s linear infinite;animation:pace-theme-center-atom-spin 2s linear infinite;border:5px solid #29d;content:' ';top:0;left:0;height:60px;width:100px}.pace .pace-activity:after,.pace .pace-activity:before{content:' ';display:block;position:absolute;top:-5px;left:-5px;height:60px;width:100px}.pace .pace-activity:after{border-radius:50%;border:5px solid #29d;-webkit-transform:rotate(60deg);-moz-transform:rotate(60deg);-o-transform:rotate(60deg);transform:rotate(60deg)}.pace .pace-activity:before{border-radius:50%;border:5px solid #29d;-webkit-transform:rotate(120deg);-moz-transform:rotate(120deg);-o-transform:rotate(120deg);transform:rotate(120deg)}@-webkit-keyframes pace-theme-center-atom-spin{0%{-webkit-transform:rotate(0)}100%{-webkit-transform:rotate(359deg)}}@-moz-keyframes pace-theme-center-atom-spin{0%{-moz-transform:rotate(0)}100%{-moz-transform:rotate(359deg)}}@-o-keyframes pace-theme-center-atom-spin{0%{-o-transform:rotate(0)}100%{-o-transform:rotate(359deg)}}@keyframes pace-theme-center-atom-spin{0%{transform:rotate(0)}100%{transform:rotate(359deg)}}"},{"title":"","date":"2019-02-15T07:46:16.755Z","updated":"2019-02-15T07:46:16.755Z","comments":true,"path":"lib/pace/pace-theme-barber-shop.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-barber-shop.min.css","excerpt":"","text":".pace,.pace .pace-progress{width:100%;overflow:hidden}.pace,.pace .pace-activity{position:fixed;top:0;left:0}.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:2000;height:12px;background:#fff}.pace-inactive{display:none}.pace .pace-progress{background-color:#29d;position:fixed;top:0;bottom:0;right:100%}.pace .pace-activity{right:-32px;bottom:0;-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0);background-image:-webkit-gradient(linear,0 100%,100% 0,color-stop(.25,rgba(255,255,255,.2)),color-stop(.25,transparent),color-stop(.5,transparent),color-stop(.5,rgba(255,255,255,.2)),color-stop(.75,rgba(255,255,255,.2)),color-stop(.75,transparent),to(transparent));background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.2) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.2) 50%,rgba(255,255,255,.2) 75%,transparent 75%,transparent);background-image:-moz-linear-gradient(45deg,rgba(255,255,255,.2) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.2) 50%,rgba(255,255,255,.2) 75%,transparent 75%,transparent);background-image:-o-linear-gradient(45deg,rgba(255,255,255,.2) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.2) 50%,rgba(255,255,255,.2) 75%,transparent 75%,transparent);background-image:linear-gradient(45deg,rgba(255,255,255,.2) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.2) 50%,rgba(255,255,255,.2) 75%,transparent 75%,transparent);-webkit-background-size:32px 32px;-moz-background-size:32px 32px;-o-background-size:32px 32px;background-size:32px 32px;-webkit-animation:pace-theme-barber-shop-motion .5s linear infinite;-moz-animation:pace-theme-barber-shop-motion .5s linear infinite;-ms-animation:pace-theme-barber-shop-motion .5s linear infinite;-o-animation:pace-theme-barber-shop-motion .5s linear infinite;animation:pace-theme-barber-shop-motion .5s linear infinite}@-webkit-keyframes pace-theme-barber-shop-motion{0%{-webkit-transform:none;transform:none}100%{-webkit-transform:translate(-32px,0);transform:translate(-32px,0)}}@-moz-keyframes pace-theme-barber-shop-motion{0%{-moz-transform:none;transform:none}100%{-moz-transform:translate(-32px,0);transform:translate(-32px,0)}}@-o-keyframes pace-theme-barber-shop-motion{0%{-o-transform:none;transform:none}100%{-o-transform:translate(-32px,0);transform:translate(-32px,0)}}@-ms-keyframes pace-theme-barber-shop-motion{0%{-ms-transform:none;transform:none}100%{-ms-transform:translate(-32px,0);transform:translate(-32px,0)}}@keyframes pace-theme-barber-shop-motion{0%{transform:none}100%{transform:translate(-32px,0)}}"},{"title":"","date":"2019-02-15T07:46:16.757Z","updated":"2019-02-15T07:46:16.757Z","comments":true,"path":"lib/pace/pace-theme-bounce.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-bounce.min.css","excerpt":"","text":".pace{width:140px;height:300px;position:fixed;top:-90px;right:-20px;z-index:2000;-webkit-transform:scale(0);-moz-transform:scale(0);-ms-transform:scale(0);-o-transform:scale(0);transform:scale(0);opacity:0;-webkit-transition:all 2s linear 0s;-moz-transition:all 2s linear 0s;transition:all 2s linear 0s}.pace.pace-active{-webkit-transform:scale(.25);-moz-transform:scale(.25);-ms-transform:scale(.25);-o-transform:scale(.25);transform:scale(.25);opacity:1}.pace .pace-activity{width:140px;height:140px;border-radius:70px;background:#29d;position:absolute;top:0;z-index:1911;-webkit-animation:pace-bounce 1s infinite;-moz-animation:pace-bounce 1s infinite;-o-animation:pace-bounce 1s infinite;-ms-animation:pace-bounce 1s infinite;animation:pace-bounce 1s infinite}.pace .pace-progress{position:absolute;display:block;left:50%;bottom:0;z-index:1910;margin-left:-30px;width:60px;height:75px;background:rgba(20,20,20,.1);box-shadow:0 0 20px 35px rgba(20,20,20,.1);border-radius:30px/40px;-webkit-transform:scaleY(.3)!important;-moz-transform:scaleY(.3)!important;-ms-transform:scaleY(.3)!important;-o-transform:scaleY(.3)!important;transform:scaleY(.3)!important;-webkit-animation:pace-compress .5s infinite alternate;-moz-animation:pace-compress .5s infinite alternate;-o-animation:pace-compress .5s infinite alternate;-ms-animation:pace-compress .5s infinite alternate;animation:pace-compress .5s infinite alternate}@-webkit-keyframes pace-bounce{0%,100%,95%{top:0;-webkit-animation-timing-function:ease-in}50%{top:140px;height:140px;-webkit-animation-timing-function:ease-out}55%{top:160px;height:120px;border-radius:70px/60px;-webkit-animation-timing-function:ease-in}65%{top:120px;height:140px;border-radius:70px;-webkit-animation-timing-function:ease-out}}@-moz-keyframes pace-bounce{0%,100%,95%{top:0;-moz-animation-timing-function:ease-in}50%{top:140px;height:140px;-moz-animation-timing-function:ease-out}55%{top:160px;height:120px;border-radius:70px/60px;-moz-animation-timing-function:ease-in}65%{top:120px;height:140px;border-radius:70px;-moz-animation-timing-function:ease-out}}@keyframes pace-bounce{0%,100%,95%{top:0;animation-timing-function:ease-in}50%{top:140px;height:140px;animation-timing-function:ease-out}55%{top:160px;height:120px;border-radius:70px/60px;animation-timing-function:ease-in}65%{top:120px;height:140px;border-radius:70px;animation-timing-function:ease-out}}@-webkit-keyframes pace-compress{0%{bottom:0;margin-left:-30px;width:60px;height:75px;background:rgba(20,20,20,.1);box-shadow:0 0 20px 35px rgba(20,20,20,.1);border-radius:30px/40px;-webkit-animation-timing-function:ease-in}100%{bottom:30px;margin-left:-10px;width:20px;height:5px;background:rgba(20,20,20,.3);box-shadow:0 0 20px 35px rgba(20,20,20,.3);border-radius:20px;-webkit-animation-timing-function:ease-out}}@-moz-keyframes pace-compress{0%{bottom:0;margin-left:-30px;width:60px;height:75px;background:rgba(20,20,20,.1);box-shadow:0 0 20px 35px rgba(20,20,20,.1);border-radius:30px/40px;-moz-animation-timing-function:ease-in}100%{bottom:30px;margin-left:-10px;width:20px;height:5px;background:rgba(20,20,20,.3);box-shadow:0 0 20px 35px rgba(20,20,20,.3);border-radius:20px;-moz-animation-timing-function:ease-out}}@keyframes pace-compress{0%{bottom:0;margin-left:-30px;width:60px;height:75px;background:rgba(20,20,20,.1);box-shadow:0 0 20px 35px rgba(20,20,20,.1);border-radius:30px/40px;animation-timing-function:ease-in}100%{bottom:30px;margin-left:-10px;width:20px;height:5px;background:rgba(20,20,20,.3);box-shadow:0 0 20px 35px rgba(20,20,20,.3);border-radius:20px;animation-timing-function:ease-out}}"},{"title":"","date":"2019-02-15T07:46:16.758Z","updated":"2019-02-15T07:46:16.758Z","comments":true,"path":"lib/pace/pace-theme-center-circle.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-center-circle.min.css","excerpt":"","text":".pace,.pace .pace-progress{z-index:2000;left:0;top:0;height:6rem}.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-perspective:12rem;-moz-perspective:12rem;-ms-perspective:12rem;-o-perspective:12rem;perspective:12rem;position:fixed;width:6rem;margin:auto;right:0;bottom:0}.pace.pace-inactive .pace-progress{display:none}.pace .pace-progress{display:block;position:absolute;width:6rem!important;line-height:6rem;font-size:2rem;border-radius:50%;background:rgba(34,153,221,.8);color:#fff;font-family:\"Helvetica Neue\",sans-serif;font-weight:100;text-align:center;-webkit-animation:pace-theme-center-circle-spin linear infinite 2s;-moz-animation:pace-theme-center-circle-spin linear infinite 2s;-ms-animation:pace-theme-center-circle-spin linear infinite 2s;-o-animation:pace-theme-center-circle-spin linear infinite 2s;animation:pace-theme-center-circle-spin linear infinite 2s;-webkit-transform-style:preserve-3d;-moz-transform-style:preserve-3d;-ms-transform-style:preserve-3d;-o-transform-style:preserve-3d;transform-style:preserve-3d}.pace .pace-progress:after{content:attr(data-progress-text);display:block}@-webkit-keyframes pace-theme-center-circle-spin{from{-webkit-transform:rotateY(0)}to{-webkit-transform:rotateY(360deg)}}@-moz-keyframes pace-theme-center-circle-spin{from{-moz-transform:rotateY(0)}to{-moz-transform:rotateY(360deg)}}@-ms-keyframes pace-theme-center-circle-spin{from{-ms-transform:rotateY(0)}to{-ms-transform:rotateY(360deg)}}@-o-keyframes pace-theme-center-circle-spin{from{-o-transform:rotateY(0)}to{-o-transform:rotateY(360deg)}}@keyframes pace-theme-center-circle-spin{from{transform:rotateY(0)}to{transform:rotateY(360deg)}}"},{"title":"","date":"2019-02-15T07:46:16.758Z","updated":"2019-02-15T07:46:16.758Z","comments":true,"path":"lib/pace/pace-theme-center-radar.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-center-radar.min.css","excerpt":"","text":".pace,.pace .pace-activity{z-index:2000;height:90px;width:90px}.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;position:fixed;margin:auto;top:0;left:0;right:0;bottom:0}.pace.pace-inactive .pace-activity{display:none}.pace .pace-activity,.pace .pace-activity:before{position:absolute;display:block;border-color:#29d transparent transparent;border-radius:50%}.pace .pace-activity{left:-30px;top:-30px;border-width:30px;border-style:double;-webkit-animation:spin 1s linear infinite;-moz-animation:spin 1s linear infinite;-o-animation:spin 1s linear infinite;animation:spin 1s linear infinite}.pace .pace-activity:before{content:' ';top:10px;left:10px;height:50px;width:50px;border-width:10px;border-style:solid}@-webkit-keyframes spin{100%{-webkit-transform:rotate(359deg)}}@-moz-keyframes spin{100%{-moz-transform:rotate(359deg)}}@-o-keyframes spin{100%{-moz-transform:rotate(359deg)}}@keyframes spin{100%{transform:rotate(359deg)}}"},{"title":"","date":"2019-02-15T07:46:16.759Z","updated":"2019-02-15T07:46:16.759Z","comments":true,"path":"lib/pace/pace-theme-fill-left.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-fill-left.min.css","excerpt":"","text":".pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background-color:rgba(34,153,221,.19999999999999996);position:fixed;z-index:-1;top:0;right:100%;bottom:0;width:100%}"},{"title":"","date":"2019-02-15T07:46:16.758Z","updated":"2019-02-15T07:46:16.758Z","comments":true,"path":"lib/pace/pace-theme-center-simple.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-center-simple.min.css","excerpt":"","text":".pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:2000;position:fixed;margin:auto;top:0;left:0;right:0;bottom:0;height:5px;width:200px;background:#fff;border:1px solid #29d;overflow:hidden}.pace .pace-progress{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;-o-box-sizing:border-box;box-sizing:border-box;-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0);max-width:200px;z-index:2000;display:block;position:absolute;top:0;right:100%;height:100%;width:100%;background:#29d}.pace.pace-inactive{display:none}"},{"title":"","date":"2019-02-15T07:46:16.759Z","updated":"2019-02-15T07:46:16.759Z","comments":true,"path":"lib/pace/pace-theme-corner-indicator.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-corner-indicator.min.css","excerpt":"","text":".pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace .pace-activity{display:block;position:fixed;z-index:2000;top:0;right:0;width:300px;height:300px;background:#29d;-webkit-transition:-webkit-transform .3s;transition:transform .3s;-webkit-transform:translateX(100%) translateY(-100%) rotate(45deg);transform:translateX(100%) translateY(-100%) rotate(45deg);pointer-events:none}.pace.pace-active .pace-activity{-webkit-transform:translateX(50%) translateY(-50%) rotate(45deg);transform:translateX(50%) translateY(-50%) rotate(45deg)}.pace .pace-activity::after,.pace .pace-activity::before{-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;bottom:30px;left:50%;display:block;border:5px solid #fff;border-radius:50%;content:''}.pace .pace-activity::before{margin-left:-40px;width:80px;height:80px;border-right-color:rgba(0,0,0,.2);border-left-color:rgba(0,0,0,.2);-webkit-animation:pace-theme-corner-indicator-spin 3s linear infinite;animation:pace-theme-corner-indicator-spin 3s linear infinite}.pace .pace-activity::after{bottom:50px;margin-left:-20px;width:40px;height:40px;border-top-color:rgba(0,0,0,.2);border-bottom-color:rgba(0,0,0,.2);-webkit-animation:pace-theme-corner-indicator-spin 1s linear infinite;animation:pace-theme-corner-indicator-spin 1s linear infinite}@-webkit-keyframes pace-theme-corner-indicator-spin{0%{-webkit-transform:rotate(0)}100%{-webkit-transform:rotate(359deg)}}@keyframes pace-theme-corner-indicator-spin{0%{transform:rotate(0)}100%{transform:rotate(359deg)}}"},{"title":"","date":"2019-02-15T07:46:16.760Z","updated":"2019-02-15T07:46:16.760Z","comments":true,"path":"lib/pace/pace-theme-flash.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-flash.min.css","excerpt":"","text":".pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#29d;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}.pace .pace-progress-inner{display:block;position:absolute;right:0;width:100px;height:100%;box-shadow:0 0 10px #29d,0 0 5px #29d;opacity:1;-webkit-transform:rotate(3deg) translate(0,-4px);-moz-transform:rotate(3deg) translate(0,-4px);-ms-transform:rotate(3deg) translate(0,-4px);-o-transform:rotate(3deg) translate(0,-4px);transform:rotate(3deg) translate(0,-4px)}.pace .pace-activity{display:block;position:fixed;z-index:2000;top:15px;right:15px;width:14px;height:14px;border:2px solid transparent;border-top-color:#29d;border-left-color:#29d;border-radius:10px;-webkit-animation:pace-spinner .4s linear infinite;-moz-animation:pace-spinner .4s linear infinite;-ms-animation:pace-spinner .4s linear infinite;-o-animation:pace-spinner .4s linear infinite;animation:pace-spinner .4s linear infinite}@-webkit-keyframes pace-spinner{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes pace-spinner{0%{-moz-transform:rotate(0);transform:rotate(0)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes pace-spinner{0%{-o-transform:rotate(0);transform:rotate(0)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@-ms-keyframes pace-spinner{0%{-ms-transform:rotate(0);transform:rotate(0)}100%{-ms-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes pace-spinner{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}"},{"title":"","date":"2019-02-15T07:41:43.379Z","updated":"2019-02-15T07:41:43.379Z","comments":true,"path":"lib/three/README.html","permalink":"https://ainevsia.github.io/lib/three/README.html","excerpt":"","text":"JavaScript 3D library for NexT Installation Step 1 &rarr; Go to NexT dir Change dir to NexT directory. There must be layout, source, languages and other directories: 123$ cd themes/next$ lsbower.json _config.yml docs gulpfile.coffee languages layout LICENSE.md package.json README.md scripts source test Step 2 &rarr; Get module Install module to source/lib directory: 1$ git clone https://github.com/theme-next/theme-next-three source/lib/three Step 3 &rarr; Set it up Enable module in NexT _config.yml file: 12345three_waves: trueORcanvas_lines: trueORcanvas_sphere: true Update 12$ cd themes/next/source/lib/three$ git pull"},{"title":"","date":"2019-02-15T07:46:16.761Z","updated":"2019-02-15T07:46:16.761Z","comments":true,"path":"lib/pace/pace-theme-mac-osx.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-mac-osx.min.css","excerpt":"","text":".pace,.pace .pace-progress{width:100%;height:12px;overflow:hidden}.pace,.pace .pace-activity{position:fixed;top:0;left:0}.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:2000;background:#fff}.pace-inactive{display:none}.pace .pace-progress{background-color:#0087E1;position:fixed;top:0;right:100%;-webkit-border-radius:0 0 4px;-moz-border-radius:0 0 4px;-o-border-radius:0 0 4px;border-radius:0 0 4px;-webkit-box-shadow:inset -1px 0 #00558F,inset 0 -1px #00558F,inset 0 2px rgba(255,255,255,.5),inset 0 6px rgba(255,255,255,.3);-moz-box-shadow:inset -1px 0 #00558F,inset 0 -1px #00558F,inset 0 2px rgba(255,255,255,.5),inset 0 6px rgba(255,255,255,.3);-o-box-shadow:inset -1px 0 #00558F,inset 0 -1px #00558F,inset 0 2px rgba(255,255,255,.5),inset 0 6px rgba(255,255,255,.3);box-shadow:inset -1px 0 #00558F,inset 0 -1px #00558F,inset 0 2px rgba(255,255,255,.5),inset 0 6px rgba(255,255,255,.3)}.pace .pace-activity{right:-28px;bottom:0;-webkit-background-image:radial-gradient(rgba(255,255,255,.65) 0,rgba(255,255,255,.15) 100%);-moz-background-image:radial-gradient(rgba(255,255,255,.65) 0,rgba(255,255,255,.15) 100%);-o-background-image:radial-gradient(rgba(255,255,255,.65) 0,rgba(255,255,255,.15) 100%);background-image:radial-gradient(rgba(255,255,255,.65) 0,rgba(255,255,255,.15) 100%);-webkit-background-size:28px 100%;-moz-background-size:28px 100%;-o-background-size:28px 100%;background-size:28px 100%;-webkit-animation:pace-theme-mac-osx-motion .5s linear infinite;-moz-animation:pace-theme-mac-osx-motion .5s linear infinite;-ms-animation:pace-theme-mac-osx-motion .5s linear infinite;-o-animation:pace-theme-mac-osx-motion .5s linear infinite;animation:pace-theme-mac-osx-motion .5s linear infinite}@-webkit-keyframes pace-theme-mac-osx-motion{0%{-webkit-transform:none;transform:none}100%{-webkit-transform:translate(-28px,0);transform:translate(-28px,0)}}@-moz-keyframes pace-theme-mac-osx-motion{0%{-moz-transform:none;transform:none}100%{-moz-transform:translate(-28px,0);transform:translate(-28px,0)}}@-o-keyframes pace-theme-mac-osx-motion{0%{-o-transform:none;transform:none}100%{-o-transform:translate(-28px,0);transform:translate(-28px,0)}}@-ms-keyframes pace-theme-mac-osx-motion{0%{-ms-transform:none;transform:none}100%{-ms-transform:translate(-28px,0);transform:translate(-28px,0)}}@keyframes pace-theme-mac-osx-motion{0%{transform:none}100%{transform:translate(-28px,0)}}"},{"title":"","date":"2019-02-15T07:46:16.761Z","updated":"2019-02-15T07:46:16.761Z","comments":true,"path":"lib/pace/pace-theme-minimal.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-minimal.min.css","excerpt":"","text":".pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#29d;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}"},{"title":"","date":"2019-02-15T07:46:16.760Z","updated":"2019-02-15T07:46:16.760Z","comments":true,"path":"lib/pace/pace-theme-loading-bar.min.css","permalink":"https://ainevsia.github.io/lib/pace/pace-theme-loading-bar.min.css","excerpt":"","text":".pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;-o-box-sizing:border-box;box-sizing:border-box;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-webkit-background-clip:padding-box;-moz-background-clip:padding;background-clip:padding-box;z-index:2000;position:fixed;margin:auto;top:12px;left:0;right:0;bottom:0;width:200px;height:50px;overflow:hidden}.pace .pace-progress{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;-o-box-sizing:border-box;box-sizing:border-box;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-webkit-background-clip:padding-box;-moz-background-clip:padding;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);display:block;position:absolute;right:100%;margin-right:-7px;width:93%;top:7px;height:14px;font-size:12px;background:#29d;color:#29d;line-height:60px;font-weight:700;font-family:Helvetica,Arial,\"Lucida Grande\",sans-serif;-webkit-box-shadow:120px 0 #fff,240px 0 #fff;-ms-box-shadow:120px 0 #fff,240px 0 #fff;box-shadow:120px 0 #fff,240px 0 #fff}.pace .pace-progress:after{content:attr(data-progress-text);display:inline-block;position:fixed;width:45px;text-align:right;right:0;padding-right:16px;top:4px}.pace .pace-progress[data-progress-text=\"0%\"]:after{right:-200px}.pace .pace-progress[data-progress-text=\"1%\"]:after{right:-198.14px}.pace .pace-progress[data-progress-text=\"2%\"]:after{right:-196.28px}.pace .pace-progress[data-progress-text=\"3%\"]:after{right:-194.42px}.pace .pace-progress[data-progress-text=\"4%\"]:after{right:-192.56px}.pace .pace-progress[data-progress-text=\"5%\"]:after{right:-190.7px}.pace .pace-progress[data-progress-text=\"6%\"]:after{right:-188.84px}.pace .pace-progress[data-progress-text=\"7%\"]:after{right:-186.98px}.pace .pace-progress[data-progress-text=\"8%\"]:after{right:-185.12px}.pace .pace-progress[data-progress-text=\"9%\"]:after{right:-183.26px}.pace .pace-progress[data-progress-text=\"10%\"]:after{right:-181.4px}.pace .pace-progress[data-progress-text=\"11%\"]:after{right:-179.54px}.pace .pace-progress[data-progress-text=\"12%\"]:after{right:-177.68px}.pace .pace-progress[data-progress-text=\"13%\"]:after{right:-175.82px}.pace .pace-progress[data-progress-text=\"14%\"]:after{right:-173.96px}.pace .pace-progress[data-progress-text=\"15%\"]:after{right:-172.1px}.pace .pace-progress[data-progress-text=\"16%\"]:after{right:-170.24px}.pace .pace-progress[data-progress-text=\"17%\"]:after{right:-168.38px}.pace .pace-progress[data-progress-text=\"18%\"]:after{right:-166.52px}.pace .pace-progress[data-progress-text=\"19%\"]:after{right:-164.66px}.pace .pace-progress[data-progress-text=\"20%\"]:after{right:-162.8px}.pace .pace-progress[data-progress-text=\"21%\"]:after{right:-160.94px}.pace .pace-progress[data-progress-text=\"22%\"]:after{right:-159.08px}.pace .pace-progress[data-progress-text=\"23%\"]:after{right:-157.22px}.pace .pace-progress[data-progress-text=\"24%\"]:after{right:-155.36px}.pace .pace-progress[data-progress-text=\"25%\"]:after{right:-153.5px}.pace .pace-progress[data-progress-text=\"26%\"]:after{right:-151.64px}.pace .pace-progress[data-progress-text=\"27%\"]:after{right:-149.78px}.pace .pace-progress[data-progress-text=\"28%\"]:after{right:-147.92px}.pace .pace-progress[data-progress-text=\"29%\"]:after{right:-146.06px}.pace .pace-progress[data-progress-text=\"30%\"]:after{right:-144.2px}.pace .pace-progress[data-progress-text=\"31%\"]:after{right:-142.34px}.pace .pace-progress[data-progress-text=\"32%\"]:after{right:-140.48px}.pace .pace-progress[data-progress-text=\"33%\"]:after{right:-138.62px}.pace .pace-progress[data-progress-text=\"34%\"]:after{right:-136.76px}.pace .pace-progress[data-progress-text=\"35%\"]:after{right:-134.9px}.pace .pace-progress[data-progress-text=\"36%\"]:after{right:-133.04px}.pace .pace-progress[data-progress-text=\"37%\"]:after{right:-131.18px}.pace .pace-progress[data-progress-text=\"38%\"]:after{right:-129.32px}.pace .pace-progress[data-progress-text=\"39%\"]:after{right:-127.46px}.pace .pace-progress[data-progress-text=\"40%\"]:after{right:-125.6px}.pace .pace-progress[data-progress-text=\"41%\"]:after{right:-123.74px}.pace .pace-progress[data-progress-text=\"42%\"]:after{right:-121.88px}.pace .pace-progress[data-progress-text=\"43%\"]:after{right:-120.02px}.pace .pace-progress[data-progress-text=\"44%\"]:after{right:-118.16px}.pace .pace-progress[data-progress-text=\"45%\"]:after{right:-116.3px}.pace .pace-progress[data-progress-text=\"46%\"]:after{right:-114.44px}.pace .pace-progress[data-progress-text=\"47%\"]:after{right:-112.58px}.pace .pace-progress[data-progress-text=\"48%\"]:after{right:-110.72px}.pace .pace-progress[data-progress-text=\"49%\"]:after{right:-108.86px}.pace .pace-progress[data-progress-text=\"50%\"]:after{right:-107px}.pace .pace-progress[data-progress-text=\"51%\"]:after{right:-105.14px}.pace .pace-progress[data-progress-text=\"52%\"]:after{right:-103.28px}.pace .pace-progress[data-progress-text=\"53%\"]:after{right:-101.42px}.pace .pace-progress[data-progress-text=\"54%\"]:after{right:-99.56px}.pace .pace-progress[data-progress-text=\"55%\"]:after{right:-97.7px}.pace .pace-progress[data-progress-text=\"56%\"]:after{right:-95.84px}.pace .pace-progress[data-progress-text=\"57%\"]:after{right:-93.98px}.pace .pace-progress[data-progress-text=\"58%\"]:after{right:-92.12px}.pace .pace-progress[data-progress-text=\"59%\"]:after{right:-90.26px}.pace .pace-progress[data-progress-text=\"60%\"]:after{right:-88.4px}.pace .pace-progress[data-progress-text=\"61%\"]:after{right:-86.54px}.pace .pace-progress[data-progress-text=\"62%\"]:after{right:-84.68px}.pace .pace-progress[data-progress-text=\"63%\"]:after{right:-82.82px}.pace .pace-progress[data-progress-text=\"64%\"]:after{right:-80.96px}.pace .pace-progress[data-progress-text=\"65%\"]:after{right:-79.1px}.pace .pace-progress[data-progress-text=\"66%\"]:after{right:-77.24px}.pace .pace-progress[data-progress-text=\"67%\"]:after{right:-75.38px}.pace .pace-progress[data-progress-text=\"68%\"]:after{right:-73.52px}.pace .pace-progress[data-progress-text=\"69%\"]:after{right:-71.66px}.pace .pace-progress[data-progress-text=\"70%\"]:after{right:-69.8px}.pace .pace-progress[data-progress-text=\"71%\"]:after{right:-67.94px}.pace .pace-progress[data-progress-text=\"72%\"]:after{right:-66.08px}.pace .pace-progress[data-progress-text=\"73%\"]:after{right:-64.22px}.pace .pace-progress[data-progress-text=\"74%\"]:after{right:-62.36px}.pace .pace-progress[data-progress-text=\"75%\"]:after{right:-60.5px}.pace .pace-progress[data-progress-text=\"76%\"]:after{right:-58.64px}.pace .pace-progress[data-progress-text=\"77%\"]:after{right:-56.78px}.pace .pace-progress[data-progress-text=\"78%\"]:after{right:-54.92px}.pace .pace-progress[data-progress-text=\"79%\"]:after{right:-53.06px}.pace .pace-progress[data-progress-text=\"80%\"]:after{right:-51.2px}.pace .pace-progress[data-progress-text=\"81%\"]:after{right:-49.34px}.pace .pace-progress[data-progress-text=\"82%\"]:after{right:-47.48px}.pace .pace-progress[data-progress-text=\"83%\"]:after{right:-45.62px}.pace .pace-progress[data-progress-text=\"84%\"]:after{right:-43.76px}.pace .pace-progress[data-progress-text=\"85%\"]:after{right:-41.9px}.pace .pace-progress[data-progress-text=\"86%\"]:after{right:-40.04px}.pace .pace-progress[data-progress-text=\"87%\"]:after{right:-38.18px}.pace .pace-progress[data-progress-text=\"88%\"]:after{right:-36.32px}.pace .pace-progress[data-progress-text=\"89%\"]:after{right:-34.46px}.pace .pace-progress[data-progress-text=\"90%\"]:after{right:-32.6px}.pace .pace-progress[data-progress-text=\"91%\"]:after{right:-30.74px}.pace .pace-progress[data-progress-text=\"92%\"]:after{right:-28.88px}.pace .pace-progress[data-progress-text=\"93%\"]:after{right:-27.02px}.pace .pace-progress[data-progress-text=\"94%\"]:after{right:-25.16px}.pace .pace-progress[data-progress-text=\"95%\"]:after{right:-23.3px}.pace .pace-progress[data-progress-text=\"96%\"]:after{right:-21.44px}.pace .pace-progress[data-progress-text=\"97%\"]:after{right:-19.58px}.pace .pace-progress[data-progress-text=\"98%\"]:after{right:-17.72px}.pace .pace-progress[data-progress-text=\"99%\"]:after{right:-15.86px}.pace .pace-progress[data-progress-text=\"100%\"]:after{right:-14px}.pace .pace-activity{position:absolute;width:100%;height:28px;z-index:2001;box-shadow:inset 0 0 0 2px #29d,inset 0 0 0 7px #FFF;border-radius:10px}.pace.pace-inactive{display:none}"},{"title":"","date":"2019-02-15T07:41:43.399Z","updated":"2019-02-15T07:41:43.399Z","comments":true,"path":"lib/three/package.json","permalink":"https://ainevsia.github.io/lib/three/package.json","excerpt":"","text":"{\"name\":\"theme-next-three\",\"version\":\"1.0.0\",\"main\":\"index.js\",\"repository\":\"git@github.com:theme-next/theme-next-three.git\",\"author\":\"Raincal \",\"license\":\"MIT\",\"scripts\":{\"build\":\"gulp\"},\"dependencies\":{\"del\":\"^3.0.0\",\"gulp\":\"^3.9.1\",\"gulp-concat\":\"^2.6.1\",\"gulp-uglify\":\"^3.0.0\"}}"},{"title":"","date":"2019-02-15T07:41:43.409Z","updated":"2019-02-15T07:41:43.409Z","comments":true,"path":"lib/three/three-waves.min.js","permalink":"https://ainevsia.github.io/lib/three/three-waves.min.js","excerpt":"","text":"$(function(){var o,a,s,l,c,p,E=100,d=50,f=50,i=0,n=0,t=window.innerWidth/2;window.innerHeight;function h(){t=window.innerWidth/2,window.innerHeight/2,a.aspect=window.innerWidth/window.innerHeight,a.updateProjectionMatrix(),l.setSize(window.innerWidth,window.innerHeight)}function u(e){n=e.clientX-t}!function(){(o=document.createElement(\"div\")).style.position=\"fixed\",o.style.top=\"0px\",o.style.left=\"0px\",o.style.zIndex=\"-1\",o.style.opacity=\"0.5\",document.body.appendChild(o),(a=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e4)).position.z=1e3,s=new THREE.Scene,c=new Array;for(var t=2*Math.PI,e=new THREE.SpriteCanvasMaterial({color:10263708,program:function(e){e.beginPath(),e.arc(0,0,.5,0,t,!0),e.fill()}}),r=0,i=0;i"},{"title":"","date":"2019-02-15T07:40:54.499Z","updated":"2019-02-15T07:40:54.499Z","comments":true,"path":"lib/fastclick/bower.json","permalink":"https://ainevsia.github.io/lib/fastclick/bower.json","excerpt":"","text":"{\"name\":\"fastclick\",\"main\":\"lib/fastclick.js\",\"ignore\":[\"**/.*\",\"component.json\",\"package.json\",\"Makefile\",\"tests\",\"examples\"]}"},{"title":"","date":"2019-02-15T07:46:16.762Z","updated":"2019-02-15T07:46:16.762Z","comments":true,"path":"lib/pace/pace.min.js","permalink":"https://ainevsia.github.io/lib/pace/pace.min.js","excerpt":"","text":"/*! pace 1.0.2 */ (function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=[].slice,Y={}.hasOwnProperty,Z=function(a,b){function c(){this.constructor=a}for(var d in b)Y.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},$=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};for(u={catchupTime:100,initialRate:.03,minTime:250,ghostTime:100,maxProgressPerFrame:20,easeFactor:1.25,startOnPageLoad:!0,restartOnPushState:!0,restartOnRequestAfter:500,target:\"body\",elements:{checkInterval:100,selectors:[\"body\"]},eventLag:{minSamples:10,sampleCount:3,lagThreshold:3},ajax:{trackMethods:[\"GET\"],trackWebSockets:!0,ignoreURLs:[]}},C=function(){var a;return null!=(a=\"undefined\"!=typeof performance&&null!==performance&&\"function\"==typeof performance.now?performance.now():void 0)?a:+new Date},E=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,t=window.cancelAnimationFrame||window.mozCancelAnimationFrame,null==E&&(E=function(a){return setTimeout(a,50)},t=function(a){return clearTimeout(a)}),G=function(a){var b,c;return b=C(),(c=function(){var d;return d=C()-b,d>=33?(b=C(),a(d,function(){return E(c)})):setTimeout(c,33-d)})()},F=function(){var a,b,c;return c=arguments[0],b=arguments[1],a=3f;f++)if(c=d[f])for(a in c)Y.call(c,a)&&(e=c[a],null!=b[a]&&\"object\"==typeof b[a]&&null!=e&&\"object\"==typeof e?v(b[a],e):b[a]=e);return b},q=function(a){var b,c,d,e,f;for(c=b=0,e=0,f=a.length;f>e;e++)d=a[e],c+=Math.abs(d),b++;return c/b},x=function(a,b){var c,d,e;if(null==a&&(a=\"options\"),null==b&&(b=!0),e=document.querySelector(\"[data-pace-\"+a+\"]\")){if(c=e.getAttribute(\"data-pace-\"+a),!b)return c;try{return JSON.parse(c)}catch(f){return d=f,\"undefined\"!=typeof console&&null!==console?console.error(\"Error parsing inline pace options\",d):void 0}}},g=function(){function a(){}return a.prototype.on=function(a,b,c,d){var e;return null==d&&(d=!1),null==this.bindings&&(this.bindings={}),null==(e=this.bindings)[a]&&(e[a]=[]),this.bindings[a].push({handler:b,ctx:c,once:d})},a.prototype.once=function(a,b,c){return this.on(a,b,c,!0)},a.prototype.off=function(a,b){var c,d,e;if(null!=(null!=(d=this.bindings)?d[a]:void 0)){if(null==b)return delete this.bindings[a];for(c=0,e=[];cQ;Q++)K=U[Q],D[K]===!0&&(D[K]=u[K]);i=function(a){function b(){return V=b.__super__.constructor.apply(this,arguments)}return Z(b,a),b}(Error),b=function(){function a(){this.progress=0}return a.prototype.getElement=function(){var a;if(null==this.el){if(a=document.querySelector(D.target),!a)throw new i;this.el=document.createElement(\"div\"),this.el.className=\"pace pace-active\",document.body.className=document.body.className.replace(/pace-done/g,\"\"),document.body.className+=\" pace-running\",this.el.innerHTML='\\n \\n\\n',null!=a.firstChild?a.insertBefore(this.el,a.firstChild):a.appendChild(this.el)}return this.el},a.prototype.finish=function(){var a;return a=this.getElement(),a.className=a.className.replace(\"pace-active\",\"\"),a.className+=\" pace-inactive\",document.body.className=document.body.className.replace(\"pace-running\",\"\"),document.body.className+=\" pace-done\"},a.prototype.update=function(a){return this.progress=a,this.render()},a.prototype.destroy=function(){try{this.getElement().parentNode.removeChild(this.getElement())}catch(a){i=a}return this.el=void 0},a.prototype.render=function(){var a,b,c,d,e,f,g;if(null==document.querySelector(D.target))return!1;for(a=this.getElement(),d=\"translate3d(\"+this.progress+\"%, 0, 0)\",g=[\"webkitTransform\",\"msTransform\",\"transform\"],e=0,f=g.length;f>e;e++)b=g[e],a.children[0].style[b]=d;return(!this.lastRenderedProgress||this.lastRenderedProgress|0!==this.progress|0)&&(a.children[0].setAttribute(\"data-progress-text\",\"\"+(0|this.progress)+\"%\"),this.progress>=100?c=\"99\":(c=this.progress=100},a}(),h=function(){function a(){this.bindings={}}return a.prototype.trigger=function(a,b){var c,d,e,f,g;if(null!=this.bindings[a]){for(f=this.bindings[a],g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c.call(this,b));return g}},a.prototype.on=function(a,b){var c;return null==(c=this.bindings)[a]&&(c[a]=[]),this.bindings[a].push(b)},a}(),P=window.XMLHttpRequest,O=window.XDomainRequest,N=window.WebSocket,w=function(a,b){var c,d,e;e=[];for(d in b.prototype)try{e.push(null==a[d]&&\"function\"!=typeof b[d]?\"function\"==typeof Object.defineProperty?Object.defineProperty(a,d,{get:function(){return b.prototype[d]},configurable:!0,enumerable:!0}):a[d]=b.prototype[d]:void 0)}catch(f){c=f}return e},A=[],j.ignore=function(){var a,b,c;return b=arguments[0],a=2=0)return!0}return!1},k=function(a){function b(){var a,c=this;b.__super__.constructor.apply(this,arguments),a=function(a){var b;return b=a.open,a.open=function(d,e){return J(d)&&c.trigger(\"request\",{type:d,url:e,request:a}),b.apply(a,arguments)}},window.XMLHttpRequest=function(b){var c;return c=new P(b),a(c),c};try{w(window.XMLHttpRequest,P)}catch(d){}if(null!=O){window.XDomainRequest=function(){var b;return b=new O,a(b),b};try{w(window.XDomainRequest,O)}catch(d){}}if(null!=N&&D.ajax.trackWebSockets){window.WebSocket=function(a,b){var d;return d=null!=b?new N(a,b):new N(a),J(\"socket\")&&c.trigger(\"request\",{type:\"socket\",url:a,protocols:b,request:d}),d};try{w(window.WebSocket,N)}catch(d){}}}return Z(b,a),b}(h),R=null,y=function(){return null==R&&(R=new k),R},I=function(a){var b,c,d,e;for(e=D.ajax.ignoreURLs,c=0,d=e.length;d>c;c++)if(b=e[c],\"string\"==typeof b){if(-1!==a.indexOf(b))return!0}else if(b.test(a))return!0;return!1},y().on(\"request\",function(b){var c,d,e,f,g;return f=b.type,e=b.request,g=b.url,I(g)?void 0:j.running||D.restartOnRequestAfter===!1&&\"force\"!==J(f)?void 0:(d=arguments,c=D.restartOnRequestAfter||0,\"boolean\"==typeof c&&(c=0),setTimeout(function(){var b,c,g,h,i,k;if(b=\"socket\"===f?e.readyStatec;c++){if(K=i[c],K instanceof a){K.watch.apply(K,d);break}k.push(void 0)}return k}},c))}),a=function(){function a(){var a=this;this.elements=[],y().on(\"request\",function(){return a.watch.apply(a,arguments)})}return a.prototype.watch=function(a){var b,c,d,e;return d=a.type,b=a.request,e=a.url,I(e)?void 0:(c=\"socket\"===d?new n(b):new o(b),this.elements.push(c))},a}(),o=function(){function a(a){var b,c,d,e,f,g,h=this;if(this.progress=0,null!=window.ProgressEvent)for(c=null,a.addEventListener(\"progress\",function(a){return h.progress=a.lengthComputable?100*a.loaded/a.total:h.progress+(100-h.progress)/2},!1),g=[\"load\",\"abort\",\"timeout\",\"error\"],d=0,e=g.length;e>d;d++)b=g[d],a.addEventListener(b,function(){return h.progress=100},!1);else f=a.onreadystatechange,a.onreadystatechange=function(){var b;return 0===(b=a.readyState)||4===b?h.progress=100:3===a.readyState&&(h.progress=50),\"function\"==typeof f?f.apply(null,arguments):void 0}}return a}(),n=function(){function a(a){var b,c,d,e,f=this;for(this.progress=0,e=[\"error\",\"open\"],c=0,d=e.length;d>c;c++)b=e[c],a.addEventListener(b,function(){return f.progress=100},!1)}return a}(),d=function(){function a(a){var b,c,d,f;for(null==a&&(a={}),this.elements=[],null==a.selectors&&(a.selectors=[]),f=a.selectors,c=0,d=f.length;d>c;c++)b=f[c],this.elements.push(new e(b))}return a}(),e=function(){function a(a){this.selector=a,this.progress=0,this.check()}return a.prototype.check=function(){var a=this;return document.querySelector(this.selector)?this.done():setTimeout(function(){return a.check()},D.elements.checkInterval)},a.prototype.done=function(){return this.progress=100},a}(),c=function(){function a(){var a,b,c=this;this.progress=null!=(b=this.states[document.readyState])?b:100,a=document.onreadystatechange,document.onreadystatechange=function(){return null!=c.states[document.readyState]&&(c.progress=c.states[document.readyState]),\"function\"==typeof a?a.apply(null,arguments):void 0}}return a.prototype.states={loading:0,interactive:50,complete:100},a}(),f=function(){function a(){var a,b,c,d,e,f=this;this.progress=0,a=0,e=[],d=0,c=C(),b=setInterval(function(){var g;return g=C()-c-50,c=C(),e.push(g),e.length>D.eventLag.sampleCount&&e.shift(),a=q(e),++d>=D.eventLag.minSamples&&a=100&&(this.done=!0),b===this.last?this.sinceLastUpdate+=a:(this.sinceLastUpdate&&(this.rate=(b-this.last)/this.sinceLastUpdate),this.catchup=(b-this.progress)/D.catchupTime,this.sinceLastUpdate=0,this.last=b),b>this.progress&&(this.progress+=this.catchup*a),c=1-Math.pow(this.progress/100,D.easeFactor),this.progress+=c*this.rate*a,this.progress=Math.min(this.lastProgress+D.maxProgressPerFrame,this.progress),this.progress=Math.max(0,this.progress),this.progress=Math.min(100,this.progress),this.lastProgress=this.progress,this.progress},a}(),L=null,H=null,r=null,M=null,p=null,s=null,j.running=!1,z=function(){return D.restartOnPushState?j.restart():void 0},null!=window.history.pushState&&(T=window.history.pushState,window.history.pushState=function(){return z(),T.apply(window.history,arguments)}),null!=window.history.replaceState&&(W=window.history.replaceState,window.history.replaceState=function(){return z(),W.apply(window.history,arguments)}),l={ajax:a,elements:d,document:c,eventLag:f},(B=function(){var a,c,d,e,f,g,h,i;for(j.sources=L=[],g=[\"ajax\",\"elements\",\"document\",\"eventLag\"],c=0,e=g.length;e>c;c++)a=g[c],D[a]!==!1&&L.push(new l[a](D[a]));for(i=null!=(h=D.extraSources)?h:[],d=0,f=i.length;f>d;d++)K=i[d],L.push(new K(D));return j.bar=r=new b,H=[],M=new m})(),j.stop=function(){return j.trigger(\"stop\"),j.running=!1,r.destroy(),s=!0,null!=p&&(\"function\"==typeof t&&t(p),p=null),B()},j.restart=function(){return j.trigger(\"restart\"),j.stop(),j.start()},j.go=function(){var a;return j.running=!0,r.render(),a=C(),s=!1,p=G(function(b,c){var d,e,f,g,h,i,k,l,n,o,p,q,t,u,v,w;for(l=100-r.progress,e=p=0,f=!0,i=q=0,u=L.length;u>q;i=++q)for(K=L[i],o=null!=H[i]?H[i]:H[i]=[],h=null!=(w=K.elements)?w:[K],k=t=0,v=h.length;v>t;k=++t)g=h[k],n=null!=o[k]?o[k]:o[k]=new m(g),f&=n.done,n.done||(e++,p+=n.tick(b));return d=p/e,r.update(M.tick(b,d)),r.done()||f||s?(r.update(100),j.trigger(\"done\"),setTimeout(function(){return r.finish(),j.running=!1,j.trigger(\"hide\")},Math.max(D.ghostTime,Math.max(D.minTime-(C()-a),0)))):c()})},j.start=function(a){v(D,a),j.running=!0;try{r.render()}catch(b){i=b}return document.querySelector(\".pace\")?(j.trigger(\"start\"),j.go()):setTimeout(j.start,50)},\"function\"==typeof define&&define.amd?define([\"pace\"],function(){return j}):\"object\"==typeof exports?module.exports=j:D.startOnPageLoad&&j.start()}).call(this);"},{"title":"","date":"2019-02-15T07:40:54.499Z","updated":"2019-02-15T07:40:54.499Z","comments":true,"path":"lib/fastclick/README.html","permalink":"https://ainevsia.github.io/lib/fastclick/README.html","excerpt":"","text":"FastClick for NexT Installation Step 1 &rarr; Go to NexT dir Change dir to NexT directory. There must be layout, source, languages and other directories: 123$ cd themes/next$ lsbower.json _config.yml docs gulpfile.coffee languages layout LICENSE.md package.json README.md scripts source test Step 2 &rarr; Get module Install module to source/lib directory: 1$ git clone https://github.com/theme-next/theme-next-fastclick source/lib/fastclick Step 3 &rarr; Set it up Enable module in NexT _config.yml file: 1fastclick: true Update 12$ cd themes/next/source/lib/fastclick$ git pull"},{"title":"","date":"2019-02-15T07:57:56.287Z","updated":"2019-02-15T07:57:56.287Z","comments":true,"path":"lib/fancybox/source/jquery.fancybox.css","permalink":"https://ainevsia.github.io/lib/fancybox/source/jquery.fancybox.css","excerpt":"","text":"@charset \"UTF-8\"; body.fancybox-active { overflow: hidden; } body.fancybox-iosfix { position: fixed; left: 0; right: 0; } .fancybox-is-hidden { position: absolute; top: -9999px; left: -9999px; visibility: hidden; } .fancybox-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 99992; -webkit-tap-highlight-color: transparent; -webkit-backface-visibility: hidden; backface-visibility: hidden; -webkit-transform: translateZ(0); transform: translateZ(0); font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\"; } .fancybox-outer, .fancybox-inner, .fancybox-bg, .fancybox-stage { position: absolute; top: 0; right: 0; bottom: 0; left: 0; } .fancybox-outer { overflow-y: auto; -webkit-overflow-scrolling: touch; } .fancybox-bg { background: #1e1e1e; opacity: 0; transition-duration: inherit; transition-property: opacity; transition-timing-function: cubic-bezier(0.47, 0, 0.74, 0.71); } .fancybox-is-open .fancybox-bg { opacity: 0.87; transition-timing-function: cubic-bezier(0.22, 0.61, 0.36, 1); } .fancybox-infobar, .fancybox-toolbar, .fancybox-caption-wrap { position: absolute; direction: ltr; z-index: 99997; opacity: 0; visibility: hidden; transition: opacity .25s, visibility 0s linear .25s; box-sizing: border-box; } .fancybox-show-infobar .fancybox-infobar, .fancybox-show-toolbar .fancybox-toolbar, .fancybox-show-caption .fancybox-caption-wrap { opacity: 1; visibility: visible; transition: opacity .25s, visibility 0s; } .fancybox-infobar { top: 0; left: 0; font-size: 13px; padding: 0 10px; height: 44px; min-width: 44px; line-height: 44px; color: #ccc; text-align: center; pointer-events: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-touch-callout: none; -webkit-tap-highlight-color: transparent; -webkit-font-smoothing: subpixel-antialiased; mix-blend-mode: exclusion; } .fancybox-toolbar { top: 0; right: 0; margin: 0; padding: 0; } .fancybox-stage { overflow: hidden; direction: ltr; z-index: 99994; -webkit-transform: translate3d(0, 0, 0); } .fancybox-is-closing .fancybox-stage { overflow: visible; } .fancybox-slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; margin: 0; padding: 0; overflow: auto; outline: none; white-space: normal; box-sizing: border-box; text-align: center; z-index: 99994; -webkit-overflow-scrolling: touch; display: none; -webkit-backface-visibility: hidden; backface-visibility: hidden; transition-property: opacity, -webkit-transform; transition-property: transform, opacity; transition-property: transform, opacity, -webkit-transform; } .fancybox-slide::before { content: ''; display: inline-block; vertical-align: middle; height: 100%; width: 0; } .fancybox-is-sliding .fancybox-slide, .fancybox-slide--previous, .fancybox-slide--current, .fancybox-slide--next { display: block; } .fancybox-slide--image { overflow: visible; } .fancybox-slide--image::before { display: none; } .fancybox-slide--video .fancybox-content, .fancybox-slide--video iframe { background: #000; } .fancybox-slide--map .fancybox-content, .fancybox-slide--map iframe { background: #E5E3DF; } .fancybox-slide--next { z-index: 99995; } .fancybox-slide > * { display: inline-block; position: relative; padding: 24px; margin: 44px 0 44px; border-width: 0; vertical-align: middle; text-align: left; background-color: #fff; overflow: auto; box-sizing: border-box; } .fancybox-slide > title, .fancybox-slide > style, .fancybox-slide > meta, .fancybox-slide > link, .fancybox-slide > script, .fancybox-slide > base { display: none; } .fancybox-slide .fancybox-image-wrap { position: absolute; top: 0; left: 0; margin: 0; padding: 0; border: 0; z-index: 99995; background: transparent; cursor: default; overflow: visible; -webkit-transform-origin: top left; -ms-transform-origin: top left; transform-origin: top left; background-size: 100% 100%; background-repeat: no-repeat; -webkit-backface-visibility: hidden; backface-visibility: hidden; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; transition-property: opacity, -webkit-transform; transition-property: transform, opacity; transition-property: transform, opacity, -webkit-transform; } .fancybox-can-zoomOut .fancybox-image-wrap { cursor: -webkit-zoom-out; cursor: zoom-out; } .fancybox-can-zoomIn .fancybox-image-wrap { cursor: -webkit-zoom-in; cursor: zoom-in; } .fancybox-can-drag .fancybox-image-wrap { cursor: -webkit-grab; cursor: grab; } .fancybox-is-dragging .fancybox-image-wrap { cursor: -webkit-grabbing; cursor: grabbing; } .fancybox-image, .fancybox-spaceball { position: absolute; top: 0; left: 0; width: 100%; height: 100%; margin: 0; padding: 0; border: 0; max-width: none; max-height: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; } .fancybox-spaceball { z-index: 1; } .fancybox-slide--iframe .fancybox-content { padding: 0; width: 80%; height: 80%; max-width: calc(100% - 100px); max-height: calc(100% - 88px); overflow: visible; background: #fff; } .fancybox-iframe { display: block; margin: 0; padding: 0; border: 0; width: 100%; height: 100%; background: #fff; } .fancybox-error { margin: 0; padding: 40px; width: 100%; max-width: 380px; background: #fff; cursor: default; } .fancybox-error p { margin: 0; padding: 0; color: #444; font-size: 16px; line-height: 20px; } /* Buttons */ .fancybox-button { box-sizing: border-box; display: inline-block; vertical-align: top; width: 44px; height: 44px; margin: 0; padding: 10px; border: 0; border-radius: 0; background: rgba(30, 30, 30, 0.6); transition: color .3s ease; cursor: pointer; outline: none; } .fancybox-button, .fancybox-button:visited, .fancybox-button:link { color: #ccc; } .fancybox-button:focus, .fancybox-button:hover { color: #fff; } .fancybox-button[disabled] { color: #ccc; cursor: default; opacity: 0.6; } .fancybox-button svg { display: block; position: relative; overflow: visible; shape-rendering: geometricPrecision; } .fancybox-button svg path { fill: currentColor; stroke: currentColor; stroke-linejoin: round; stroke-width: 3; } .fancybox-button--share svg path { stroke-width: 1; } .fancybox-button--play svg path:nth-child(2) { display: none; } .fancybox-button--pause svg path:nth-child(1) { display: none; } .fancybox-button--zoom svg path { fill: transparent; } /* Navigation arrows */ .fancybox-navigation { display: none; } .fancybox-show-nav .fancybox-navigation { display: block; } .fancybox-navigation button { position: absolute; top: 50%; margin: -50px 0 0 0; z-index: 99997; background: transparent; width: 60px; height: 100px; padding: 17px; } .fancybox-navigation button:before { content: \"\"; position: absolute; top: 30px; right: 10px; width: 40px; height: 40px; background: rgba(30, 30, 30, 0.6); } .fancybox-navigation .fancybox-button--arrow_left { left: 0; } .fancybox-navigation .fancybox-button--arrow_right { right: 0; } /* Close button on the top right corner of html content */ .fancybox-close-small { position: absolute; top: 0; right: 0; width: 44px; height: 44px; padding: 0; margin: 0; border: 0; border-radius: 0; background: transparent; z-index: 10; cursor: pointer; } .fancybox-close-small:after { content: '×'; position: absolute; top: 5px; right: 5px; width: 30px; height: 30px; font: 20px/30px Arial,\"Helvetica Neue\",Helvetica,sans-serif; color: #888; font-weight: 300; text-align: center; border-radius: 50%; border-width: 0; background-color: transparent; transition: background-color .25s; box-sizing: border-box; z-index: 2; } .fancybox-close-small:focus { outline: none; } .fancybox-close-small:focus:after { outline: 1px dotted #888; } .fancybox-close-small:hover:after { color: #555; background: #eee; } .fancybox-slide--image .fancybox-close-small, .fancybox-slide--iframe .fancybox-close-small { top: 0; right: -44px; } .fancybox-slide--image .fancybox-close-small:after, .fancybox-slide--iframe .fancybox-close-small:after { font-size: 35px; color: #aaa; } .fancybox-slide--image .fancybox-close-small:hover:after, .fancybox-slide--iframe .fancybox-close-small:hover:after { color: #fff; background: transparent; } .fancybox-is-scaling .fancybox-close-small, .fancybox-is-zoomable.fancybox-can-drag .fancybox-close-small { display: none; } /* Caption */ .fancybox-caption-wrap { bottom: 0; left: 0; right: 0; padding: 60px 2vw 0 2vw; background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.1) 20%, rgba(0, 0, 0, 0.2) 40%, rgba(0, 0, 0, 0.6) 80%, rgba(0, 0, 0, 0.8) 100%); pointer-events: none; } .fancybox-caption { padding: 30px 0; border-top: 1px solid rgba(255, 255, 255, 0.4); font-size: 14px; color: #fff; line-height: 20px; -webkit-text-size-adjust: none; } .fancybox-caption a, .fancybox-caption button, .fancybox-caption select { pointer-events: all; position: relative; /* Fix IE11 */ } .fancybox-caption a { color: #fff; text-decoration: underline; } /* Loading indicator */ .fancybox-slide > .fancybox-loading { border: 6px solid rgba(100, 100, 100, 0.4); border-top: 6px solid rgba(255, 255, 255, 0.6); border-radius: 100%; height: 50px; width: 50px; -webkit-animation: fancybox-rotate .8s infinite linear; animation: fancybox-rotate .8s infinite linear; background: transparent; position: absolute; top: 50%; left: 50%; margin-top: -30px; margin-left: -30px; z-index: 99999; } @-webkit-keyframes fancybox-rotate { from { -webkit-transform: rotate(0deg); transform: rotate(0deg); } to { -webkit-transform: rotate(359deg); transform: rotate(359deg); } } @keyframes fancybox-rotate { from { -webkit-transform: rotate(0deg); transform: rotate(0deg); } to { -webkit-transform: rotate(359deg); transform: rotate(359deg); } } /* Transition effects */ .fancybox-animated { transition-timing-function: cubic-bezier(0, 0, 0.25, 1); } /* transitionEffect: slide */ .fancybox-fx-slide.fancybox-slide--previous { -webkit-transform: translate3d(-100%, 0, 0); transform: translate3d(-100%, 0, 0); opacity: 0; } .fancybox-fx-slide.fancybox-slide--next { -webkit-transform: translate3d(100%, 0, 0); transform: translate3d(100%, 0, 0); opacity: 0; } .fancybox-fx-slide.fancybox-slide--current { -webkit-transform: translate3d(0, 0, 0); transform: translate3d(0, 0, 0); opacity: 1; } /* transitionEffect: fade */ .fancybox-fx-fade.fancybox-slide--previous, .fancybox-fx-fade.fancybox-slide--next { opacity: 0; transition-timing-function: cubic-bezier(0.19, 1, 0.22, 1); } .fancybox-fx-fade.fancybox-slide--current { opacity: 1; } /* transitionEffect: zoom-in-out */ .fancybox-fx-zoom-in-out.fancybox-slide--previous { -webkit-transform: scale3d(1.5, 1.5, 1.5); transform: scale3d(1.5, 1.5, 1.5); opacity: 0; } .fancybox-fx-zoom-in-out.fancybox-slide--next { -webkit-transform: scale3d(0.5, 0.5, 0.5); transform: scale3d(0.5, 0.5, 0.5); opacity: 0; } .fancybox-fx-zoom-in-out.fancybox-slide--current { -webkit-transform: scale3d(1, 1, 1); transform: scale3d(1, 1, 1); opacity: 1; } /* transitionEffect: rotate */ .fancybox-fx-rotate.fancybox-slide--previous { -webkit-transform: rotate(-360deg); -ms-transform: rotate(-360deg); transform: rotate(-360deg); opacity: 0; } .fancybox-fx-rotate.fancybox-slide--next { -webkit-transform: rotate(360deg); -ms-transform: rotate(360deg); transform: rotate(360deg); opacity: 0; } .fancybox-fx-rotate.fancybox-slide--current { -webkit-transform: rotate(0deg); -ms-transform: rotate(0deg); transform: rotate(0deg); opacity: 1; } /* transitionEffect: circular */ .fancybox-fx-circular.fancybox-slide--previous { -webkit-transform: scale3d(0, 0, 0) translate3d(-100%, 0, 0); transform: scale3d(0, 0, 0) translate3d(-100%, 0, 0); opacity: 0; } .fancybox-fx-circular.fancybox-slide--next { -webkit-transform: scale3d(0, 0, 0) translate3d(100%, 0, 0); transform: scale3d(0, 0, 0) translate3d(100%, 0, 0); opacity: 0; } .fancybox-fx-circular.fancybox-slide--current { -webkit-transform: scale3d(1, 1, 1) translate3d(0, 0, 0); transform: scale3d(1, 1, 1) translate3d(0, 0, 0); opacity: 1; } /* transitionEffect: tube */ .fancybox-fx-tube.fancybox-slide--previous { -webkit-transform: translate3d(-100%, 0, 0) scale(0.1) skew(-10deg); transform: translate3d(-100%, 0, 0) scale(0.1) skew(-10deg); } .fancybox-fx-tube.fancybox-slide--next { -webkit-transform: translate3d(100%, 0, 0) scale(0.1) skew(10deg); transform: translate3d(100%, 0, 0) scale(0.1) skew(10deg); } .fancybox-fx-tube.fancybox-slide--current { -webkit-transform: translate3d(0, 0, 0) scale(1); transform: translate3d(0, 0, 0) scale(1); } /* Share */ .fancybox-share { padding: 30px; border-radius: 3px; background: #f4f4f4; max-width: 90%; } .fancybox-share h1 { color: #222; margin: 0 0 20px 0; font-size: 33px; font-weight: 700; text-align: center; } .fancybox-share p { margin: 0; padding: 0; text-align: center; } .fancybox-share p:first-of-type { margin-right: -10px; } .fancybox-share_button { display: inline-block; text-decoration: none; margin: 0 10px 10px 0; padding: 10px 20px; border: 0; border-radius: 3px; box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.16); background: #fff; white-space: nowrap; font-size: 16px; line-height: 23px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; min-width: 140px; color: #707070; transition: all .2s; } .fancybox-share_button:focus, .fancybox-share_button:hover { text-decoration: none; color: #333; box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.3); } .fancybox-share_button svg { margin-right: 5px; width: 20px; height: 20px; vertical-align: text-bottom; } .fancybox-share input { box-sizing: border-box; width: 100%; margin: 5px 0 0 0; padding: 10px 15px; border: 1px solid #d7d7d7; border-radius: 3px; background: #ebebeb; color: #5d5b5b; font-size: 14px; outline: none; } /* Thumbs */ .fancybox-thumbs { display: none; position: absolute; top: 0; bottom: 0; right: 0; width: 212px; margin: 0; padding: 2px 2px 4px 2px; background: #fff; -webkit-tap-highlight-color: transparent; -webkit-overflow-scrolling: touch; -ms-overflow-style: -ms-autohiding-scrollbar; box-sizing: border-box; z-index: 99995; } .fancybox-thumbs-x { overflow-y: hidden; overflow-x: auto; } .fancybox-show-thumbs .fancybox-thumbs { display: block; } .fancybox-show-thumbs .fancybox-inner { right: 212px; } .fancybox-thumbs > ul { list-style: none; position: absolute; position: relative; width: 100%; height: 100%; margin: 0; padding: 0; overflow-x: hidden; overflow-y: auto; font-size: 0; white-space: nowrap; } .fancybox-thumbs-x > ul { overflow: hidden; } .fancybox-thumbs-y > ul::-webkit-scrollbar { width: 7px; } .fancybox-thumbs-y > ul::-webkit-scrollbar-track { background: #fff; border-radius: 10px; box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3); } .fancybox-thumbs-y > ul::-webkit-scrollbar-thumb { background: #2a2a2a; border-radius: 10px; } .fancybox-thumbs > ul > li { float: left; overflow: hidden; padding: 0; margin: 2px; width: 100px; height: 75px; max-width: calc(50% - 4px); max-height: calc(100% - 8px); position: relative; cursor: pointer; outline: none; -webkit-tap-highlight-color: transparent; -webkit-backface-visibility: hidden; backface-visibility: hidden; box-sizing: border-box; } li.fancybox-thumbs-loading { background: rgba(0, 0, 0, 0.1); } .fancybox-thumbs > ul > li > img { position: absolute; top: 0; left: 0; max-width: none; max-height: none; -webkit-touch-callout: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; } .fancybox-thumbs > ul > li:before { content: ''; position: absolute; top: 0; right: 0; bottom: 0; left: 0; border: 4px solid #4ea7f9; z-index: 99991; opacity: 0; transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94); } .fancybox-thumbs > ul > li.fancybox-thumbs-active:before { opacity: 1; } /* Styling for Small-Screen Devices */ @media all and (max-width: 800px) { .fancybox-thumbs { width: 110px; } .fancybox-show-thumbs .fancybox-inner { right: 110px; } .fancybox-thumbs > ul > li { max-width: calc(100% - 10px); } }"},{"title":"","date":"2019-02-15T07:57:56.287Z","updated":"2019-02-15T07:57:56.287Z","comments":true,"path":"lib/fancybox/source/jquery.fancybox.min.css","permalink":"https://ainevsia.github.io/lib/fancybox/source/jquery.fancybox.min.css","excerpt":"","text":"@charset \"UTF-8\";body.fancybox-active{overflow:hidden}body.fancybox-iosfix{position:fixed;left:0;right:0}.fancybox-is-hidden{position:absolute;top:-9999px;left:-9999px;visibility:hidden}.fancybox-container{position:fixed;top:0;left:0;width:100%;height:100%;z-index:99992;-webkit-tap-highlight-color:transparent;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform:translateZ(0);transform:translateZ(0);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif}.fancybox-bg,.fancybox-inner,.fancybox-outer,.fancybox-stage{position:absolute;top:0;right:0;bottom:0;left:0}.fancybox-outer{overflow-y:auto;-webkit-overflow-scrolling:touch}.fancybox-bg{background:#1e1e1e;opacity:0;transition-duration:inherit;transition-property:opacity;transition-timing-function:cubic-bezier(.47,0,.74,.71)}.fancybox-is-open .fancybox-bg{opacity:.87;transition-timing-function:cubic-bezier(.22,.61,.36,1)}.fancybox-caption-wrap,.fancybox-infobar,.fancybox-toolbar{position:absolute;direction:ltr;z-index:99997;opacity:0;visibility:hidden;transition:opacity .25s,visibility 0s linear .25s;box-sizing:border-box}.fancybox-show-caption .fancybox-caption-wrap,.fancybox-show-infobar .fancybox-infobar,.fancybox-show-toolbar .fancybox-toolbar{opacity:1;visibility:visible;transition:opacity .25s,visibility 0s}.fancybox-infobar{top:0;left:0;font-size:13px;padding:0 10px;height:44px;min-width:44px;line-height:44px;color:#ccc;text-align:center;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;-webkit-font-smoothing:subpixel-antialiased;mix-blend-mode:exclusion}.fancybox-toolbar{top:0;right:0;margin:0;padding:0}.fancybox-stage{overflow:hidden;direction:ltr;z-index:99994;-webkit-transform:translateZ(0)}.fancybox-is-closing .fancybox-stage{overflow:visible}.fancybox-slide{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;padding:0;overflow:auto;outline:none;white-space:normal;box-sizing:border-box;text-align:center;z-index:99994;-webkit-overflow-scrolling:touch;display:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;transition-property:opacity,-webkit-transform;transition-property:transform,opacity;transition-property:transform,opacity,-webkit-transform}.fancybox-slide:before{content:\"\";display:inline-block;vertical-align:middle;height:100%;width:0}.fancybox-is-sliding .fancybox-slide,.fancybox-slide--current,.fancybox-slide--next,.fancybox-slide--previous{display:block}.fancybox-slide--image{overflow:visible}.fancybox-slide--image:before{display:none}.fancybox-slide--video .fancybox-content,.fancybox-slide--video iframe{background:#000}.fancybox-slide--map .fancybox-content,.fancybox-slide--map iframe{background:#e5e3df}.fancybox-slide--next{z-index:99995}.fancybox-slide>*{display:inline-block;position:relative;padding:24px;margin:44px 0;border-width:0;vertical-align:middle;text-align:left;background-color:#fff;overflow:auto;box-sizing:border-box}.fancybox-slide>base,.fancybox-slide>link,.fancybox-slide>meta,.fancybox-slide>script,.fancybox-slide>style,.fancybox-slide>title{display:none}.fancybox-slide .fancybox-image-wrap{position:absolute;top:0;left:0;margin:0;padding:0;border:0;z-index:99995;background:transparent;cursor:default;overflow:visible;-webkit-transform-origin:top left;transform-origin:top left;background-size:100% 100%;background-repeat:no-repeat;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition-property:opacity,-webkit-transform;transition-property:transform,opacity;transition-property:transform,opacity,-webkit-transform}.fancybox-can-zoomOut .fancybox-image-wrap{cursor:zoom-out}.fancybox-can-zoomIn .fancybox-image-wrap{cursor:zoom-in}.fancybox-can-drag .fancybox-image-wrap{cursor:-webkit-grab;cursor:grab}.fancybox-is-dragging .fancybox-image-wrap{cursor:-webkit-grabbing;cursor:grabbing}.fancybox-image,.fancybox-spaceball{position:absolute;top:0;left:0;width:100%;height:100%;margin:0;padding:0;border:0;max-width:none;max-height:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.fancybox-spaceball{z-index:1}.fancybox-slide--iframe .fancybox-content{padding:0;width:80%;height:80%;max-width:calc(100% - 100px);max-height:calc(100% - 88px);overflow:visible;background:#fff}.fancybox-iframe{display:block;padding:0;border:0;height:100%}.fancybox-error,.fancybox-iframe{margin:0;width:100%;background:#fff}.fancybox-error{padding:40px;max-width:380px;cursor:default}.fancybox-error p{margin:0;padding:0;color:#444;font-size:16px;line-height:20px}.fancybox-button{box-sizing:border-box;display:inline-block;vertical-align:top;width:44px;height:44px;margin:0;padding:10px;border:0;border-radius:0;background:rgba(30,30,30,.6);transition:color .3s ease;cursor:pointer;outline:none}.fancybox-button,.fancybox-button:link,.fancybox-button:visited{color:#ccc}.fancybox-button:focus,.fancybox-button:hover{color:#fff}.fancybox-button[disabled]{color:#ccc;cursor:default;opacity:.6}.fancybox-button svg{display:block;position:relative;overflow:visible;shape-rendering:geometricPrecision}.fancybox-button svg path{fill:currentColor;stroke:currentColor;stroke-linejoin:round;stroke-width:3}.fancybox-button--share svg path{stroke-width:1}.fancybox-button--pause svg path:nth-child(1),.fancybox-button--play svg path:nth-child(2){display:none}.fancybox-button--zoom svg path{fill:transparent}.fancybox-navigation{display:none}.fancybox-show-nav .fancybox-navigation{display:block}.fancybox-navigation button{position:absolute;top:50%;margin:-50px 0 0;z-index:99997;background:transparent;width:60px;height:100px;padding:17px}.fancybox-navigation button:before{content:\"\";position:absolute;top:30px;right:10px;width:40px;height:40px;background:rgba(30,30,30,.6)}.fancybox-navigation .fancybox-button--arrow_left{left:0}.fancybox-navigation .fancybox-button--arrow_right{right:0}.fancybox-close-small{position:absolute;top:0;right:0;width:44px;height:44px;padding:0;margin:0;border:0;border-radius:0;background:transparent;z-index:10;cursor:pointer}.fancybox-close-small:after{content:\"×\";position:absolute;top:5px;right:5px;width:30px;height:30px;font:20px/30px Arial,Helvetica Neue,Helvetica,sans-serif;color:#888;font-weight:300;text-align:center;border-radius:50%;border-width:0;background-color:transparent;transition:background-color .25s;box-sizing:border-box;z-index:2}.fancybox-close-small:focus{outline:none}.fancybox-close-small:focus:after{outline:1px dotted #888}.fancybox-close-small:hover:after{color:#555;background:#eee}.fancybox-slide--iframe .fancybox-close-small,.fancybox-slide--image .fancybox-close-small{top:0;right:-44px}.fancybox-slide--iframe .fancybox-close-small:after,.fancybox-slide--image .fancybox-close-small:after{font-size:35px;color:#aaa}.fancybox-slide--iframe .fancybox-close-small:hover:after,.fancybox-slide--image .fancybox-close-small:hover:after{color:#fff;background:transparent}.fancybox-is-scaling .fancybox-close-small,.fancybox-is-zoomable.fancybox-can-drag .fancybox-close-small{display:none}.fancybox-caption-wrap{bottom:0;left:0;right:0;padding:60px 2vw 0;background:linear-gradient(180deg,transparent 0,rgba(0,0,0,.1) 20%,rgba(0,0,0,.2) 40%,rgba(0,0,0,.6) 80%,rgba(0,0,0,.8));pointer-events:none}.fancybox-caption{padding:30px 0;border-top:1px solid hsla(0,0%,100%,.4);font-size:14px;color:#fff;line-height:20px;-webkit-text-size-adjust:none}.fancybox-caption a,.fancybox-caption button,.fancybox-caption select{pointer-events:all;position:relative}.fancybox-caption a{color:#fff;text-decoration:underline}.fancybox-slide>.fancybox-loading{border:6px solid hsla(0,0%,39%,.4);border-top:6px solid hsla(0,0%,100%,.6);border-radius:100%;height:50px;width:50px;-webkit-animation:a .8s infinite linear;animation:a .8s infinite linear;background:transparent;position:absolute;top:50%;left:50%;margin-top:-30px;margin-left:-30px;z-index:99999}@-webkit-keyframes a{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes a{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.fancybox-animated{transition-timing-function:cubic-bezier(0,0,.25,1)}.fancybox-fx-slide.fancybox-slide--previous{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0);opacity:0}.fancybox-fx-slide.fancybox-slide--next{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0);opacity:0}.fancybox-fx-slide.fancybox-slide--current{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}.fancybox-fx-fade.fancybox-slide--next,.fancybox-fx-fade.fancybox-slide--previous{opacity:0;transition-timing-function:cubic-bezier(.19,1,.22,1)}.fancybox-fx-fade.fancybox-slide--current{opacity:1}.fancybox-fx-zoom-in-out.fancybox-slide--previous{-webkit-transform:scale3d(1.5,1.5,1.5);transform:scale3d(1.5,1.5,1.5);opacity:0}.fancybox-fx-zoom-in-out.fancybox-slide--next{-webkit-transform:scale3d(.5,.5,.5);transform:scale3d(.5,.5,.5);opacity:0}.fancybox-fx-zoom-in-out.fancybox-slide--current{-webkit-transform:scaleX(1);transform:scaleX(1);opacity:1}.fancybox-fx-rotate.fancybox-slide--previous{-webkit-transform:rotate(-1turn);transform:rotate(-1turn);opacity:0}.fancybox-fx-rotate.fancybox-slide--next{-webkit-transform:rotate(1turn);transform:rotate(1turn);opacity:0}.fancybox-fx-rotate.fancybox-slide--current{-webkit-transform:rotate(0deg);transform:rotate(0deg);opacity:1}.fancybox-fx-circular.fancybox-slide--previous{-webkit-transform:scale3d(0,0,0) translate3d(-100%,0,0);transform:scale3d(0,0,0) translate3d(-100%,0,0);opacity:0}.fancybox-fx-circular.fancybox-slide--next{-webkit-transform:scale3d(0,0,0) translate3d(100%,0,0);transform:scale3d(0,0,0) translate3d(100%,0,0);opacity:0}.fancybox-fx-circular.fancybox-slide--current{-webkit-transform:scaleX(1) translateZ(0);transform:scaleX(1) translateZ(0);opacity:1}.fancybox-fx-tube.fancybox-slide--previous{-webkit-transform:translate3d(-100%,0,0) scale(.1) skew(-10deg);transform:translate3d(-100%,0,0) scale(.1) skew(-10deg)}.fancybox-fx-tube.fancybox-slide--next{-webkit-transform:translate3d(100%,0,0) scale(.1) skew(10deg);transform:translate3d(100%,0,0) scale(.1) skew(10deg)}.fancybox-fx-tube.fancybox-slide--current{-webkit-transform:translateZ(0) scale(1);transform:translateZ(0) scale(1)}.fancybox-share{padding:30px;border-radius:3px;background:#f4f4f4;max-width:90%}.fancybox-share h1{color:#222;margin:0 0 20px;font-size:33px;font-weight:700;text-align:center}.fancybox-share p{margin:0;padding:0;text-align:center}.fancybox-share p:first-of-type{margin-right:-10px}.fancybox-share_button{display:inline-block;text-decoration:none;margin:0 10px 10px 0;padding:10px 20px;border:0;border-radius:3px;box-shadow:0 2px 2px 0 rgba(0,0,0,.16);background:#fff;white-space:nowrap;font-size:16px;line-height:23px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-width:140px;color:#707070;transition:all .2s}.fancybox-share_button:focus,.fancybox-share_button:hover{text-decoration:none;color:#333;box-shadow:0 2px 2px 0 rgba(0,0,0,.3)}.fancybox-share_button svg{margin-right:5px;width:20px;height:20px;vertical-align:text-bottom}.fancybox-share input{box-sizing:border-box;width:100%;margin:5px 0 0;padding:10px 15px;border:1px solid #d7d7d7;border-radius:3px;background:#ebebeb;color:#5d5b5b;font-size:14px;outline:none}.fancybox-thumbs{display:none;position:absolute;top:0;bottom:0;right:0;width:212px;margin:0;padding:2px 2px 4px;background:#fff;-webkit-tap-highlight-color:transparent;-webkit-overflow-scrolling:touch;-ms-overflow-style:-ms-autohiding-scrollbar;box-sizing:border-box;z-index:99995}.fancybox-thumbs-x{overflow-y:hidden;overflow-x:auto}.fancybox-show-thumbs .fancybox-thumbs{display:block}.fancybox-show-thumbs .fancybox-inner{right:212px}.fancybox-thumbs>ul{list-style:none;position:absolute;position:relative;width:100%;height:100%;margin:0;padding:0;overflow-x:hidden;overflow-y:auto;font-size:0;white-space:nowrap}.fancybox-thumbs-x>ul{overflow:hidden}.fancybox-thumbs-y>ul::-webkit-scrollbar{width:7px}.fancybox-thumbs-y>ul::-webkit-scrollbar-track{background:#fff;border-radius:10px;box-shadow:inset 0 0 6px rgba(0,0,0,.3)}.fancybox-thumbs-y>ul::-webkit-scrollbar-thumb{background:#2a2a2a;border-radius:10px}.fancybox-thumbs>ul>li{float:left;overflow:hidden;padding:0;margin:2px;width:100px;height:75px;max-width:calc(50% - 4px);max-height:calc(100% - 8px);position:relative;cursor:pointer;outline:none;-webkit-tap-highlight-color:transparent;-webkit-backface-visibility:hidden;backface-visibility:hidden;box-sizing:border-box}li.fancybox-thumbs-loading{background:rgba(0,0,0,.1)}.fancybox-thumbs>ul>li>img{position:absolute;top:0;left:0;max-width:none;max-height:none;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.fancybox-thumbs>ul>li:before{content:\"\";position:absolute;top:0;right:0;bottom:0;left:0;border:4px solid #4ea7f9;z-index:99991;opacity:0;transition:all .2s cubic-bezier(.25,.46,.45,.94)}.fancybox-thumbs>ul>li.fancybox-thumbs-active:before{opacity:1}@media (max-width:800px){.fancybox-thumbs{width:110px}.fancybox-show-thumbs .fancybox-inner{right:110px}.fancybox-thumbs>ul>li{max-width:calc(100% - 10px)}}"},{"title":"","date":"2019-02-15T07:41:43.399Z","updated":"2019-02-15T07:41:43.399Z","comments":true,"path":"lib/three/lib/Projector.js","permalink":"https://ainevsia.github.io/lib/three/lib/Projector.js","excerpt":"","text":"/** * @author mrdoob / http://mrdoob.com/ * @author supereggbert / http://www.paulbrunt.co.uk/ * @author julianwa / https://github.com/julianwa */ THREE.RenderableObject = function () { this.id = 0; this.object = null; this.z = 0; this.renderOrder = 0; }; // THREE.RenderableFace = function () { this.id = 0; this.v1 = new THREE.RenderableVertex(); this.v2 = new THREE.RenderableVertex(); this.v3 = new THREE.RenderableVertex(); this.normalModel = new THREE.Vector3(); this.vertexNormalsModel = [ new THREE.Vector3(), new THREE.Vector3(), new THREE.Vector3() ]; this.vertexNormalsLength = 0; this.color = new THREE.Color(); this.material = null; this.uvs = [ new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() ]; this.z = 0; this.renderOrder = 0; }; // THREE.RenderableVertex = function () { this.position = new THREE.Vector3(); this.positionWorld = new THREE.Vector3(); this.positionScreen = new THREE.Vector4(); this.visible = true; }; THREE.RenderableVertex.prototype.copy = function ( vertex ) { this.positionWorld.copy( vertex.positionWorld ); this.positionScreen.copy( vertex.positionScreen ); }; // THREE.RenderableLine = function () { this.id = 0; this.v1 = new THREE.RenderableVertex(); this.v2 = new THREE.RenderableVertex(); this.vertexColors = [ new THREE.Color(), new THREE.Color() ]; this.material = null; this.z = 0; this.renderOrder = 0; }; // THREE.RenderableSprite = function () { this.id = 0; this.object = null; this.x = 0; this.y = 0; this.z = 0; this.rotation = 0; this.scale = new THREE.Vector2(); this.material = null; this.renderOrder = 0; }; // THREE.Projector = function () { var _object, _objectCount, _objectPool = [], _objectPoolLength = 0, _vertex, _vertexCount, _vertexPool = [], _vertexPoolLength = 0, _face, _faceCount, _facePool = [], _facePoolLength = 0, _line, _lineCount, _linePool = [], _linePoolLength = 0, _sprite, _spriteCount, _spritePool = [], _spritePoolLength = 0, _renderData = { objects: [], lights: [], elements: [] }, _vector3 = new THREE.Vector3(), _vector4 = new THREE.Vector4(), _clipBox = new THREE.Box3( new THREE.Vector3( - 1, - 1, - 1 ), new THREE.Vector3( 1, 1, 1 ) ), _boundingBox = new THREE.Box3(), _points3 = new Array( 3 ), _points4 = new Array( 4 ), _viewMatrix = new THREE.Matrix4(), _viewProjectionMatrix = new THREE.Matrix4(), _modelMatrix, _modelViewProjectionMatrix = new THREE.Matrix4(), _normalMatrix = new THREE.Matrix3(), _frustum = new THREE.Frustum(), _clippedVertex1PositionScreen = new THREE.Vector4(), _clippedVertex2PositionScreen = new THREE.Vector4(); // this.projectVector = function ( vector, camera ) { console.warn( 'THREE.Projector: .projectVector() is now vector.project().' ); vector.project( camera ); }; this.unprojectVector = function ( vector, camera ) { console.warn( 'THREE.Projector: .unprojectVector() is now vector.unproject().' ); vector.unproject( camera ); }; this.pickingRay = function ( vector, camera ) { console.error( 'THREE.Projector: .pickingRay() is now raycaster.setFromCamera().' ); }; // var RenderList = function () { var normals = []; var uvs = []; var object = null; var material = null; var normalMatrix = new THREE.Matrix3(); function setObject( value ) { object = value; material = object.material; normalMatrix.getNormalMatrix( object.matrixWorld ); normals.length = 0; uvs.length = 0; } function projectVertex( vertex ) { var position = vertex.position; var positionWorld = vertex.positionWorld; var positionScreen = vertex.positionScreen; positionWorld.copy( position ).applyMatrix4( _modelMatrix ); positionScreen.copy( positionWorld ).applyMatrix4( _viewProjectionMatrix ); var invW = 1 / positionScreen.w; positionScreen.x *= invW; positionScreen.y *= invW; positionScreen.z *= invW; vertex.visible = positionScreen.x >= - 1 && positionScreen.x = - 1 && positionScreen.y = - 1 && positionScreen.z 0 ) continue; v2 = _vertexPool[ _vertexCount - 2 ]; _clippedVertex1PositionScreen.copy( v1.positionScreen ); _clippedVertex2PositionScreen.copy( v2.positionScreen ); if ( clipLine( _clippedVertex1PositionScreen, _clippedVertex2PositionScreen ) === true ) { // Perform the perspective divide _clippedVertex1PositionScreen.multiplyScalar( 1 / _clippedVertex1PositionScreen.w ); _clippedVertex2PositionScreen.multiplyScalar( 1 / _clippedVertex2PositionScreen.w ); _line = getNextLineInPool(); _line.id = object.id; _line.v1.positionScreen.copy( _clippedVertex1PositionScreen ); _line.v2.positionScreen.copy( _clippedVertex2PositionScreen ); _line.z = Math.max( _clippedVertex1PositionScreen.z, _clippedVertex2PositionScreen.z ); _line.renderOrder = object.renderOrder; _line.material = object.material; if ( object.material.vertexColors === THREE.VertexColors ) { _line.vertexColors[ 0 ].copy( object.geometry.colors[ v ] ); _line.vertexColors[ 1 ].copy( object.geometry.colors[ v - 1 ] ); } _renderData.elements.push( _line ); } } } } else if ( object instanceof THREE.Sprite ) { _vector4.set( _modelMatrix.elements[ 12 ], _modelMatrix.elements[ 13 ], _modelMatrix.elements[ 14 ], 1 ); _vector4.applyMatrix4( _viewProjectionMatrix ); var invW = 1 / _vector4.w; _vector4.z *= invW; if ( _vector4.z >= - 1 && _vector4.z = 0 && bc2near >= 0 && bc1far >= 0 && bc2far >= 0 ) { // Both vertices lie entirely within all clip planes. return true; } else if ( ( bc1near < 0 && bc2near < 0 ) || ( bc1far < 0 && bc2far < 0 ) ) { // Both vertices lie entirely outside one of the clip planes. return false; } else { // The line segment spans at least one clip plane. if ( bc1near < 0 ) { // v1 lies outside the near plane, v2 inside alpha1 = Math.max( alpha1, bc1near / ( bc1near - bc2near ) ); } else if ( bc2near < 0 ) { // v2 lies outside the near plane, v1 inside alpha2 = Math.min( alpha2, bc1near / ( bc1near - bc2near ) ); } if ( bc1far < 0 ) { // v1 lies outside the far plane, v2 inside alpha1 = Math.max( alpha1, bc1far / ( bc1far - bc2far ) ); } else if ( bc2far < 0 ) { // v2 lies outside the far plane, v2 inside alpha2 = Math.min( alpha2, bc1far / ( bc1far - bc2far ) ); } if ( alpha2 < alpha1 ) { // The line segment spans two boundaries, but is outside both of them. // (This can't happen when we're only clipping against just near/far but good // to leave the check here for future usage if other clip planes are added.) return false; } else { // Update the s1 and s2 vertices to match the clipped line segment. s1.lerp( s2, alpha1 ); s2.lerp( s1, 1 - alpha2 ); return true; } } } };"},{"title":"","date":"2019-02-15T07:57:56.287Z","updated":"2019-02-15T07:57:56.287Z","comments":true,"path":"lib/fancybox/source/jquery.fancybox.min.js","permalink":"https://ainevsia.github.io/lib/fancybox/source/jquery.fancybox.min.js","excerpt":"","text":"// ================================================== // fancyBox v3.2.5 // // Licensed GPLv3 for open source use // or fancyBox Commercial License for commercial use // // http://fancyapps.com/fancybox/ // Copyright 2017 fancyApps // // ================================================== !function(t,e,n,o){\"use strict\";function a(t){var e=n(t.currentTarget),o=t.data?t.data.options:{},a=e.attr(\"data-fancybox\")||\"\",i=0,s=[];t.isDefaultPrevented()||(t.preventDefault(),a?(s=o.selector?n(o.selector):t.data?t.data.items:[],s=s.length?s.filter('[data-fancybox=\"'+a+'\"]'):n('[data-fancybox=\"'+a+'\"]'),i=s.index(e),i',preload:!0,css:{},attr:{scrolling:\"auto\"}},defaultType:\"image\",animationEffect:\"zoom\",animationDuration:500,zoomOpacity:\"auto\",transitionEffect:\"fade\",transitionDuration:366,slideClass:\"\",baseClass:\"\",baseTpl:'&nbsp;/&nbsp;',spinnerTpl:'',errorTpl:'',btnTpl:{download:'',zoom:'',close:'',smallBtn:'',arrowLeft:'',arrowRight:''},parentEl:\"body\",autoFocus:!1,backFocus:!0,trapFocus:!0,fullScreen:{autoStart:!1},touch:{vertical:!0,momentum:!0},hash:null,media:{},slideShow:{autoStart:!1,speed:4e3},thumbs:{autoStart:!1,hideOnClose:!0,parentEl:\".fancybox-container\",axis:\"y\"},onInit:n.noop,beforeLoad:n.noop,afterLoad:n.noop,beforeShow:n.noop,afterShow:n.noop,beforeClose:n.noop,afterClose:n.noop,onActivate:n.noop,onDeactivate:n.noop,clickContent:function(t,e){return\"image\"===t.type&&\"zoom\"},clickSlide:\"close\",clickOutside:\"close\",dblclickContent:!1,dblclickSlide:!1,dblclickOutside:!1,mobile:{margin:0,clickContent:function(t,e){return\"image\"===t.type&&\"toggleControls\"},clickSlide:function(t,e){return\"image\"===t.type?\"toggleControls\":\"close\"},dblclickContent:function(t,e){return\"image\"===t.type&&\"zoom\"},dblclickSlide:function(t,e){return\"image\"===t.type&&\"zoom\"}},lang:\"en\",i18n:{en:{CLOSE:\"Close\",NEXT:\"Next\",PREV:\"Previous\",ERROR:\"The requested content cannot be loaded. Please try again later.\",PLAY_START:\"Start slideshow\",PLAY_STOP:\"Pause slideshow\",FULL_SCREEN:\"Full screen\",THUMBS:\"Thumbnails\",DOWNLOAD:\"Download\",SHARE:\"Share\",ZOOM:\"Zoom\"},de:{CLOSE:\"Schliessen\",NEXT:\"Weiter\",PREV:\"Zurück\",ERROR:\"Die angeforderten Daten konnten nicht geladen werden. Bitte versuchen Sie es später nochmal.\",PLAY_START:\"Diaschau starten\",PLAY_STOP:\"Diaschau beenden\",FULL_SCREEN:\"Vollbild\",THUMBS:\"Vorschaubilder\",DOWNLOAD:\"Herunterladen\",SHARE:\"Teilen\",ZOOM:\"Maßstab\"}}},s=n(t),r=n(e),c=0,l=function(t){return t&&t.hasOwnProperty&&t instanceof n},u=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||function(e){return t.setTimeout(e,1e3/60)}}(),d=function(){var t,n=e.createElement(\"fakeelement\"),a={transition:\"transitionend\",OTransition:\"oTransitionEnd\",MozTransition:\"transitionend\",WebkitTransition:\"webkitTransitionEnd\"};for(t in a)if(n.style[t]!==o)return a[t];return\"transitionend\"}(),f=function(t){return t&&t.length&&t[0].offsetHeight},p=function(t,o,a){var i=this;i.opts=n.extend(!0,{index:a},n.fancybox.defaults,o||{}),n.fancybox.isMobile&&(i.opts=n.extend(!0,{},i.opts,i.opts.mobile)),o&&n.isArray(o.buttons)&&(i.opts.buttons=o.buttons),i.id=i.opts.id||++c,i.group=[],i.currIndex=parseInt(i.opts.index,10)||0,i.prevIndex=null,i.prevPos=null,i.currPos=0,i.firstRun=null,i.createGroup(t),i.group.length&&(i.$lastFocus=n(e.activeElement).blur(),i.slides={},i.init())};n.extend(p.prototype,{init:function(){var a,i,s,c=this,l=c.group[c.currIndex],u=l.opts,d=n.fancybox.scrollbarWidth;c.scrollTop=r.scrollTop(),c.scrollLeft=r.scrollLeft(),n.fancybox.getInstance()||(n(\"body\").addClass(\"fancybox-active\"),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!t.MSStream?\"image\"!==l.type&&n(\"body\").css(\"top\",n(\"body\").scrollTop()*-1).addClass(\"fancybox-iosfix\"):!n.fancybox.isMobile&&e.body.scrollHeight>t.innerHeight&&(d===o&&(a=n('').appendTo(\"body\"),d=n.fancybox.scrollbarWidth=a[0].offsetWidth-a[0].clientWidth,a.remove()),n(\"head\").append('.compensate-for-scrollbar { margin-right: '+d+\"px; }\"),n(\"body\").addClass(\"compensate-for-scrollbar\"))),s=\"\",n.each(u.buttons,function(t,e){s+=u.btnTpl[e]||\"\"}),i=n(c.translate(c,u.baseTpl.replace(\"\",s).replace(\"\",u.btnTpl.arrowLeft+u.btnTpl.arrowRight))).attr(\"id\",\"fancybox-container-\"+c.id).addClass(\"fancybox-is-hidden\").addClass(u.baseClass).data(\"FancyBox\",c).appendTo(u.parentEl),c.$refs={container:i},[\"bg\",\"inner\",\"infobar\",\"toolbar\",\"stage\",\"caption\",\"navigation\"].forEach(function(t){c.$refs[t]=i.find(\".fancybox-\"+t)}),c.trigger(\"onInit\"),c.activate(),c.jumpTo(c.currIndex)},translate:function(t,e){var n=t.opts.i18n[t.opts.lang];return e.replace(/\\{\\{(\\w+)\\}\\}/g,function(t,e){var a=n[e];return a===o?t:a})},createGroup:function(t){var e=this,a=n.makeArray(t);n.each(a,function(t,a){var i,s,r,c,l={},u={};n.isPlainObject(a)?(l=a,u=a.opts||a):\"object\"===n.type(a)&&n(a).length?(i=n(a),u=i.data(),u=n.extend({},u,u.options||{}),u.$orig=i,l.src=u.src||i.attr(\"href\"),l.type||l.src||(l.type=\"inline\",l.src=a)):l={type:\"html\",src:a+\"\"},l.opts=n.extend(!0,{},e.opts,u),n.isArray(u.buttons)&&(l.opts.buttons=u.buttons),s=l.type||l.opts.type,r=l.src||\"\",!s&&r&&(r.match(/(^data:image\\/[a-z0-9+\\/=]*,)|(\\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\\?|#).*)?$)/i)?s=\"image\":r.match(/\\.(pdf)((\\?|#).*)?$/i)?s=\"pdf\":\"#\"===r.charAt(0)&&(s=\"inline\")),s?l.type=s:e.trigger(\"objectNeedsType\",l),l.index=e.group.length,l.opts.$orig&&!l.opts.$orig.length&&delete l.opts.$orig,!l.opts.$thumb&&l.opts.$orig&&(l.opts.$thumb=l.opts.$orig.find(\"img:first\")),l.opts.$thumb&&!l.opts.$thumb.length&&delete l.opts.$thumb,\"function\"===n.type(l.opts.caption)&&(l.opts.caption=l.opts.caption.apply(a,[e,l])),\"function\"===n.type(e.opts.caption)&&(l.opts.caption=e.opts.caption.apply(a,[e,l])),l.opts.caption instanceof n||(l.opts.caption=l.opts.caption===o?\"\":l.opts.caption+\"\"),\"ajax\"===s&&(c=r.split(/\\s+/,2),c.length>1&&(l.src=c.shift(),l.opts.filter=c.shift())),\"auto\"==l.opts.smallBtn&&(n.inArray(s,[\"html\",\"inline\",\"ajax\"])>-1?(l.opts.toolbar=!1,l.opts.smallBtn=!0):l.opts.smallBtn=!1),\"pdf\"===s&&(l.type=\"iframe\",l.opts.iframe.preload=!1),l.opts.modal&&(l.opts=n.extend(!0,l.opts,{infobar:0,toolbar:0,smallBtn:0,keyboard:0,slideShow:0,fullScreen:0,thumbs:0,touch:0,clickContent:!1,clickSlide:!1,clickOutside:!1,dblclickContent:!1,dblclickSlide:!1,dblclickOutside:!1})),e.group.push(l)})},addEvents:function(){var o=this;o.removeEvents(),o.$refs.container.on(\"click.fb-close\",\"[data-fancybox-close]\",function(t){t.stopPropagation(),t.preventDefault(),o.close(t)}).on(\"click.fb-prev touchend.fb-prev\",\"[data-fancybox-prev]\",function(t){t.stopPropagation(),t.preventDefault(),o.previous()}).on(\"click.fb-next touchend.fb-next\",\"[data-fancybox-next]\",function(t){t.stopPropagation(),t.preventDefault(),o.next()}).on(\"click.fb\",\"[data-fancybox-zoom]\",function(t){o[o.isScaledDown()?\"scaleToActual\":\"scaleToFit\"]()}),s.on(\"orientationchange.fb resize.fb\",function(t){t&&t.originalEvent&&\"resize\"===t.originalEvent.type?u(function(){o.update()}):(o.$refs.stage.hide(),setTimeout(function(){o.$refs.stage.show(),o.update()},600))}),r.on(\"focusin.fb\",function(t){var a=n.fancybox?n.fancybox.getInstance():null;a.isClosing||!a.current||!a.current.opts.trapFocus||n(t.target).hasClass(\"fancybox-container\")||n(t.target).is(e)||a&&\"fixed\"!==n(t.target).css(\"position\")&&!a.$refs.container.has(t.target).length&&(t.stopPropagation(),a.focus(),s.scrollTop(o.scrollTop).scrollLeft(o.scrollLeft))}),r.on(\"keydown.fb\",function(t){var e=o.current,a=t.keyCode||t.which;if(e&&e.opts.keyboard&&!n(t.target).is(\"input\")&&!n(t.target).is(\"textarea\"))return 8===a||27===a?(t.preventDefault(),void o.close(t)):37===a||38===a?(t.preventDefault(),void o.previous()):39===a||40===a?(t.preventDefault(),void o.next()):void o.trigger(\"afterKeydown\",t,a)}),o.group[o.currIndex].opts.idleTime&&(o.idleSecondsCounter=0,r.on(\"mousemove.fb-idle mouseleave.fb-idle mousedown.fb-idle touchstart.fb-idle touchmove.fb-idle scroll.fb-idle keydown.fb-idle\",function(t){o.idleSecondsCounter=0,o.isIdle&&o.showControls(),o.isIdle=!1}),o.idleInterval=t.setInterval(function(){o.idleSecondsCounter++,o.idleSecondsCounter>=o.group[o.currIndex].opts.idleTime&&(o.isIdle=!0,o.idleSecondsCounter=0,o.hideControls())},1e3))},removeEvents:function(){var e=this;s.off(\"orientationchange.fb resize.fb\"),r.off(\"focusin.fb keydown.fb .fb-idle\"),this.$refs.container.off(\".fb-close .fb-prev .fb-next\"),e.idleInterval&&(t.clearInterval(e.idleInterval),e.idleInterval=null)},previous:function(t){return this.jumpTo(this.currPos-1,t)},next:function(t){return this.jumpTo(this.currPos+1,t)},jumpTo:function(t,e,a){var i,s,r,c,l,u,d,p=this,h=p.group.length;if(!(p.isSliding||p.isClosing||p.isAnimating&&p.firstRun)){if(t=parseInt(t,10),s=p.current?p.current.opts.loop:p.opts.loop,!s&&(t=h))return!1;if(i=p.firstRun=null===p.firstRun,!(h1&&((s||r.index>0)&&p.createSlide(t-1),(s||r.indexr.pos?\"next\":\"previous\"),c.$slide.removeClass(\"fancybox-slide--complete fancybox-slide--current fancybox-slide--next fancybox-slide--previous\"),c.isComplete=!1,e&&(r.isMoved||r.opts.transitionEffect)&&(r.isMoved?c.$slide.addClass(d):(d=\"fancybox-animated \"+d+\" fancybox-fx-\"+r.opts.transitionEffect,n.fancybox.animate(c.$slide,d,e,function(){c.$slide.removeClass(d).removeAttr(\"style\")}))))}}},createSlide:function(t){var e,o,a=this;return o=t%a.group.length,o=o1&&/^\\+?\\d+$/.test(n[n.length-1])?parseInt(n.pop(-1),10)||1:1,a=n.join(\"-\");return o1?\"-\"+(a.index+1):\"\"),\"replaceState\"in e.history?(c&&clearTimeout(c),c=setTimeout(function(){e.history[s?\"pushState\":\"replaceState\"]({},t.title,e.location.pathname+e.location.search+\"#\"+r),c=null,s=!1},300)):e.location.hash=r))},\"beforeClose.fb\":function(o,a,s){var l,u;c&&clearTimeout(c),s.opts.hash!==!1&&(l=i(a),u=a&&a.opts.origHash?a.opts.origHash:\"\",l&&\"\"!==l&&(\"replaceState\"in history?e.history.replaceState({},t.title,e.location.pathname+e.location.search+u):(e.location.hash=u,n(e).scrollTop(a.scrollTop).scrollLeft(a.scrollLeft))),r=null)}}),n(e).on(\"hashchange.fb\",function(){var t=o();n.fancybox.getInstance()?!r||r===t.gallery+\"-\"+t.index||1===t.index&&r==t.gallery||(r=null,n.fancybox.close()):\"\"!==t.gallery&&a(t)}),setTimeout(function(){a(o())},50))})}(document,window,window.jQuery||jQuery);"},{"title":"","date":"2019-02-15T07:41:43.409Z","updated":"2019-02-15T07:41:43.409Z","comments":true,"path":"lib/three/src/canvas_sphere.js","permalink":"https://ainevsia.github.io/lib/three/src/canvas_sphere.js","excerpt":"","text":"/** * Created by Tang on 2017/4/15. */ $(function () { var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight, mouseX = 0, mouseY = 0, windowHalfX = window.innerWidth / 2, windowHalfY = window.innerHeight / 2, SEPARATION = 200, AMOUNTX = 10, AMOUNTY = 10, camera, scene, renderer; init(); animate(); function init() { var container, separation = 100, amountX = 50, amountY = 50, particles, particle; container = document.createElement('div'); // 设置css container.style.position = \"fixed\"; container.style.top = \"0px\"; container.style.left = \"0px\"; container.style.zIndex = \"-1\"; container.style.opacity = \"0.5\"; document.body.appendChild(container); camera = new THREE.PerspectiveCamera(75, SCREEN_WIDTH / SCREEN_HEIGHT, 1, 10000); camera.position.z = 1000; scene = new THREE.Scene(); renderer = new THREE.CanvasRenderer({ alpha: true }); renderer.setPixelRatio(window.devicePixelRatio); renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT); container.appendChild(renderer.domElement); // particles var PI2 = Math.PI * 2; var material = new THREE.SpriteCanvasMaterial({ color: 10263708, program: function (context) { context.beginPath(); context.arc(0, 0, 0.5, 0, PI2, true); context.fill(); } }); for (var i = 0; i < 1000; i++) { particle = new THREE.Sprite(material); particle.position.x = Math.random() * 2 - 1; particle.position.y = Math.random() * 2 - 1; particle.position.z = Math.random() * 2 - 1; particle.position.normalize(); particle.position.multiplyScalar(Math.random() * 10 + 450); particle.scale.multiplyScalar(2); scene.add(particle); } // lines for (var i = 0; i < 300; i++) { var geometry = new THREE.Geometry(); var vertex = new THREE.Vector3(Math.random() * 2 - 1, Math.random() * 2 - 1, Math.random() * 2 - 1); vertex.normalize(); vertex.multiplyScalar(450); geometry.vertices.push(vertex); var vertex2 = vertex.clone(); vertex2.multiplyScalar(Math.random() * 0.3 + 1); geometry.vertices.push(vertex2); var line = new THREE.Line(geometry, new THREE.LineBasicMaterial({ color: 10263708, opacity: Math.random() })); scene.add(line); } document.addEventListener('mousemove', onDocumentMouseMove, false); document.addEventListener('touchstart', onDocumentTouchStart, false); document.addEventListener('touchmove', onDocumentTouchMove, false); // window.addEventListener('resize', onWindowResize, false); } function onWindowResize() { windowHalfX = window.innerWidth / 2; windowHalfY = window.innerHeight / 2; camera.aspect = window.innerWidth / window.innerHeight; camera.updateProjectionMatrix(); renderer.setSize(window.innerWidth, window.innerHeight); } // function onDocumentMouseMove(event) { mouseX = event.clientX - windowHalfX; mouseY = event.clientY - windowHalfY; } function onDocumentTouchStart(event) { if (event.touches.length > 1) { //event.preventDefault(); mouseX = event.touches[0].pageX - windowHalfX; //mouseY = event.touches[ 0 ].pageY - windowHalfY; } } function onDocumentTouchMove(event) { if (event.touches.length == 1) { //event.preventDefault(); mouseX = event.touches[0].pageX - windowHalfX; //mouseY = event.touches[ 0 ].pageY - windowHalfY; } } // function animate() { requestAnimationFrame(animate); render(); } function render() { camera.position.x += (mouseX - camera.position.x) * .05; camera.position.y += (-mouseY + 200 - camera.position.y) * .05; camera.lookAt(scene.position); renderer.render(scene, camera); } })"},{"title":"","date":"2019-02-15T07:41:43.399Z","updated":"2019-02-15T07:41:43.399Z","comments":true,"path":"lib/three/lib/CanvasRenderer.js","permalink":"https://ainevsia.github.io/lib/three/lib/CanvasRenderer.js","excerpt":"","text":"/** * @author mrdoob / http://mrdoob.com/ */ THREE.SpriteCanvasMaterial = function ( parameters ) { THREE.Material.call( this ); this.type = 'SpriteCanvasMaterial'; this.color = new THREE.Color( 0xffffff ); this.program = function ( context, color ) {}; this.setValues( parameters ); }; THREE.SpriteCanvasMaterial.prototype = Object.create( THREE.Material.prototype ); THREE.SpriteCanvasMaterial.prototype.constructor = THREE.SpriteCanvasMaterial; THREE.SpriteCanvasMaterial.prototype.clone = function () { var material = new THREE.SpriteCanvasMaterial(); material.copy( this ); material.color.copy( this.color ); material.program = this.program; return material; }; // THREE.CanvasRenderer = function ( parameters ) { console.log( 'THREE.CanvasRenderer', THREE.REVISION ); parameters = parameters || {}; var _this = this, _renderData, _elements, _lights, _projector = new THREE.Projector(), _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement( 'canvas' ), _canvasWidth = _canvas.width, _canvasHeight = _canvas.height, _canvasWidthHalf = Math.floor( _canvasWidth / 2 ), _canvasHeightHalf = Math.floor( _canvasHeight / 2 ), _viewportX = 0, _viewportY = 0, _viewportWidth = _canvasWidth, _viewportHeight = _canvasHeight, _pixelRatio = 1, _context = _canvas.getContext( '2d', { alpha: parameters.alpha === true } ), _clearColor = new THREE.Color( 0x000000 ), _clearAlpha = parameters.alpha === true ? 0 : 1, _contextGlobalAlpha = 1, _contextGlobalCompositeOperation = 0, _contextStrokeStyle = null, _contextFillStyle = null, _contextLineWidth = null, _contextLineCap = null, _contextLineJoin = null, _contextLineDash = [], _camera, _v1, _v2, _v3, _v4, _v5 = new THREE.RenderableVertex(), _v6 = new THREE.RenderableVertex(), _v1x, _v1y, _v2x, _v2y, _v3x, _v3y, _v4x, _v4y, _v5x, _v5y, _v6x, _v6y, _color = new THREE.Color(), _color1 = new THREE.Color(), _color2 = new THREE.Color(), _color3 = new THREE.Color(), _color4 = new THREE.Color(), _diffuseColor = new THREE.Color(), _emissiveColor = new THREE.Color(), _lightColor = new THREE.Color(), _patterns = {}, _image, _uvs, _uv1x, _uv1y, _uv2x, _uv2y, _uv3x, _uv3y, _clipBox = new THREE.Box2(), _clearBox = new THREE.Box2(), _elemBox = new THREE.Box2(), _ambientLight = new THREE.Color(), _directionalLights = new THREE.Color(), _pointLights = new THREE.Color(), _vector3 = new THREE.Vector3(), // Needed for PointLight _centroid = new THREE.Vector3(), _normal = new THREE.Vector3(), _normalViewMatrix = new THREE.Matrix3(); /* TODO _canvas.mozImageSmoothingEnabled = false; _canvas.webkitImageSmoothingEnabled = false; _canvas.msImageSmoothingEnabled = false; _canvas.imageSmoothingEnabled = false; */ // dash+gap fallbacks for Firefox and everything else if ( _context.setLineDash === undefined ) { _context.setLineDash = function () {}; } this.domElement = _canvas; this.autoClear = true; this.sortObjects = true; this.sortElements = true; this.info = { render: { vertices: 0, faces: 0 } }; // WebGLRenderer compatibility this.supportsVertexTextures = function () {}; this.setFaceCulling = function () {}; // API this.getContext = function () { return _context; }; this.getContextAttributes = function () { return _context.getContextAttributes(); }; this.getPixelRatio = function () { return _pixelRatio; }; this.setPixelRatio = function ( value ) { if ( value !== undefined ) _pixelRatio = value; }; this.setSize = function ( width, height, updateStyle ) { _canvasWidth = width * _pixelRatio; _canvasHeight = height * _pixelRatio; _canvas.width = _canvasWidth; _canvas.height = _canvasHeight; _canvasWidthHalf = Math.floor( _canvasWidth / 2 ); _canvasHeightHalf = Math.floor( _canvasHeight / 2 ); if ( updateStyle !== false ) { _canvas.style.width = width + 'px'; _canvas.style.height = height + 'px'; } _clipBox.min.set( - _canvasWidthHalf, - _canvasHeightHalf ); _clipBox.max.set( _canvasWidthHalf, _canvasHeightHalf ); _clearBox.min.set( - _canvasWidthHalf, - _canvasHeightHalf ); _clearBox.max.set( _canvasWidthHalf, _canvasHeightHalf ); _contextGlobalAlpha = 1; _contextGlobalCompositeOperation = 0; _contextStrokeStyle = null; _contextFillStyle = null; _contextLineWidth = null; _contextLineCap = null; _contextLineJoin = null; this.setViewport( 0, 0, width, height ); }; this.setViewport = function ( x, y, width, height ) { _viewportX = x * _pixelRatio; _viewportY = y * _pixelRatio; _viewportWidth = width * _pixelRatio; _viewportHeight = height * _pixelRatio; }; this.setScissor = function () {}; this.setScissorTest = function () {}; this.setClearColor = function ( color, alpha ) { _clearColor.set( color ); _clearAlpha = alpha !== undefined ? alpha : 1; _clearBox.min.set( - _canvasWidthHalf, - _canvasHeightHalf ); _clearBox.max.set( _canvasWidthHalf, _canvasHeightHalf ); }; this.setClearColorHex = function ( hex, alpha ) { console.warn( 'THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead.' ); this.setClearColor( hex, alpha ); }; this.getClearColor = function () { return _clearColor; }; this.getClearAlpha = function () { return _clearAlpha; }; this.getMaxAnisotropy = function () { return 0; }; this.clear = function () { if ( _clearBox.isEmpty() === false ) { _clearBox.intersect( _clipBox ); _clearBox.expandByScalar( 2 ); _clearBox.min.x = _clearBox.min.x + _canvasWidthHalf; _clearBox.min.y = - _clearBox.min.y + _canvasHeightHalf; // higher y value ! _clearBox.max.x = _clearBox.max.x + _canvasWidthHalf; _clearBox.max.y = - _clearBox.max.y + _canvasHeightHalf; // lower y value ! if ( _clearAlpha < 1 ) { _context.clearRect( _clearBox.min.x | 0, _clearBox.max.y | 0, ( _clearBox.max.x - _clearBox.min.x ) | 0, ( _clearBox.min.y - _clearBox.max.y ) | 0 ); } if ( _clearAlpha > 0 ) { setBlending( THREE.NormalBlending ); setOpacity( 1 ); setFillStyle( 'rgba(' + Math.floor( _clearColor.r * 255 ) + ',' + Math.floor( _clearColor.g * 255 ) + ',' + Math.floor( _clearColor.b * 255 ) + ',' + _clearAlpha + ')' ); _context.fillRect( _clearBox.min.x | 0, _clearBox.max.y | 0, ( _clearBox.max.x - _clearBox.min.x ) | 0, ( _clearBox.min.y - _clearBox.max.y ) | 0 ); } _clearBox.makeEmpty(); } }; // compatibility this.clearColor = function () {}; this.clearDepth = function () {}; this.clearStencil = function () {}; this.render = function ( scene, camera ) { if ( camera instanceof THREE.Camera === false ) { console.error( 'THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.' ); return; } var background = scene.background; if ( background && background.isColor ) { setFillStyle( 'rgb(' + Math.floor( background.r * 255 ) + ',' + Math.floor( background.g * 255 ) + ',' + Math.floor( background.b * 255 ) + ')' ); _context.fillRect( 0, 0, _canvasWidth, _canvasHeight ); } else if ( this.autoClear === true ) { this.clear(); } _this.info.render.vertices = 0; _this.info.render.faces = 0; _context.setTransform( _viewportWidth / _canvasWidth, 0, 0, - _viewportHeight / _canvasHeight, _viewportX, _canvasHeight - _viewportY ); _context.translate( _canvasWidthHalf, _canvasHeightHalf ); _renderData = _projector.projectScene( scene, camera, this.sortObjects, this.sortElements ); _elements = _renderData.elements; _lights = _renderData.lights; _camera = camera; _normalViewMatrix.getNormalMatrix( camera.matrixWorldInverse ); /* DEBUG setFillStyle( 'rgba( 0, 255, 255, 0.5 )' ); _context.fillRect( _clipBox.min.x, _clipBox.min.y, _clipBox.max.x - _clipBox.min.x, _clipBox.max.y - _clipBox.min.y ); */ calculateLights(); for ( var e = 0, el = _elements.length; e < el; e ++ ) { var element = _elements[ e ]; var material = element.material; if ( material === undefined || material.opacity === 0 ) continue; _elemBox.makeEmpty(); if ( element instanceof THREE.RenderableSprite ) { _v1 = element; _v1.x *= _canvasWidthHalf; _v1.y *= _canvasHeightHalf; renderSprite( _v1, element, material ); } else if ( element instanceof THREE.RenderableLine ) { _v1 = element.v1; _v2 = element.v2; _v1.positionScreen.x *= _canvasWidthHalf; _v1.positionScreen.y *= _canvasHeightHalf; _v2.positionScreen.x *= _canvasWidthHalf; _v2.positionScreen.y *= _canvasHeightHalf; _elemBox.setFromPoints( [ _v1.positionScreen, _v2.positionScreen ] ); if ( _clipBox.intersectsBox( _elemBox ) === true ) { renderLine( _v1, _v2, element, material ); } } else if ( element instanceof THREE.RenderableFace ) { _v1 = element.v1; _v2 = element.v2; _v3 = element.v3; if ( _v1.positionScreen.z < - 1 || _v1.positionScreen.z > 1 ) continue; if ( _v2.positionScreen.z < - 1 || _v2.positionScreen.z > 1 ) continue; if ( _v3.positionScreen.z < - 1 || _v3.positionScreen.z > 1 ) continue; _v1.positionScreen.x *= _canvasWidthHalf; _v1.positionScreen.y *= _canvasHeightHalf; _v2.positionScreen.x *= _canvasWidthHalf; _v2.positionScreen.y *= _canvasHeightHalf; _v3.positionScreen.x *= _canvasWidthHalf; _v3.positionScreen.y *= _canvasHeightHalf; if ( material.overdraw > 0 ) { expand( _v1.positionScreen, _v2.positionScreen, material.overdraw ); expand( _v2.positionScreen, _v3.positionScreen, material.overdraw ); expand( _v3.positionScreen, _v1.positionScreen, material.overdraw ); } _elemBox.setFromPoints( [ _v1.positionScreen, _v2.positionScreen, _v3.positionScreen ] ); if ( _clipBox.intersectsBox( _elemBox ) === true ) { renderFace3( _v1, _v2, _v3, 0, 1, 2, element, material ); } } /* DEBUG setLineWidth( 1 ); setStrokeStyle( 'rgba( 0, 255, 0, 0.5 )' ); _context.strokeRect( _elemBox.min.x, _elemBox.min.y, _elemBox.max.x - _elemBox.min.x, _elemBox.max.y - _elemBox.min.y ); */ _clearBox.union( _elemBox ); } /* DEBUG setLineWidth( 1 ); setStrokeStyle( 'rgba( 255, 0, 0, 0.5 )' ); _context.strokeRect( _clearBox.min.x, _clearBox.min.y, _clearBox.max.x - _clearBox.min.x, _clearBox.max.y - _clearBox.min.y ); */ _context.setTransform( 1, 0, 0, 1, 0, 0 ); }; // function calculateLights() { _ambientLight.setRGB( 0, 0, 0 ); _directionalLights.setRGB( 0, 0, 0 ); _pointLights.setRGB( 0, 0, 0 ); for ( var l = 0, ll = _lights.length; l < ll; l ++ ) { var light = _lights[ l ]; var lightColor = light.color; if ( light instanceof THREE.AmbientLight ) { _ambientLight.add( lightColor ); } else if ( light instanceof THREE.DirectionalLight ) { // for sprites _directionalLights.add( lightColor ); } else if ( light instanceof THREE.PointLight ) { // for sprites _pointLights.add( lightColor ); } } } function calculateLight( position, normal, color ) { for ( var l = 0, ll = _lights.length; l < ll; l ++ ) { var light = _lights[ l ]; _lightColor.copy( light.color ); if ( light instanceof THREE.DirectionalLight ) { var lightPosition = _vector3.setFromMatrixPosition( light.matrixWorld ).normalize(); var amount = normal.dot( lightPosition ); if ( amount"},{"title":"","date":"2019-02-15T07:41:43.399Z","updated":"2019-02-15T07:41:43.399Z","comments":true,"path":"lib/three/src/canvas_lines.js","permalink":"https://ainevsia.github.io/lib/three/src/canvas_lines.js","excerpt":"","text":"/** * Created by Tang on 2017/4/15. */ $(function () { var mouseX = 0, mouseY = 0, windowHalfX = window.innerWidth / 2, windowHalfY = window.innerHeight / 2, SEPARATION = 200, AMOUNTX = 10, AMOUNTY = 10, camera, scene, renderer; init(); animate(); function init() { var container, separation = 100, amountX = 50, amountY = 50, particles, particle; container = document.createElement('div'); // 设置css container.style.position = \"fixed\"; container.style.top = \"0px\"; container.style.left = \"0px\"; container.style.zIndex = \"-1\"; container.style.opacity = \"0.5\"; document.body.appendChild(container); camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 10000); camera.position.z = 100; scene = new THREE.Scene(); renderer = new THREE.CanvasRenderer({ alpha: true }); renderer.setPixelRatio(window.devicePixelRatio); renderer.setSize(window.innerWidth, window.innerHeight); container.appendChild(renderer.domElement); // particles var PI2 = Math.PI * 2; var material = new THREE.SpriteCanvasMaterial({ color: 10263708, program: function (context) { context.beginPath(); context.arc(0, 0, 0.5, 0, PI2, true); context.fill(); } }); var geometry = new THREE.Geometry(); for (var i = 0; i < 100; i++) { particle = new THREE.Sprite(material); particle.position.x = Math.random() * 2 - 1; particle.position.y = Math.random() * 2 - 1; particle.position.z = Math.random() * 2 - 1; particle.position.normalize(); particle.position.multiplyScalar(Math.random() * 10 + 450); particle.scale.x = particle.scale.y = 10; scene.add(particle); geometry.vertices.push(particle.position); } // lines var line = new THREE.Line(geometry, new THREE.LineBasicMaterial({ color: 10263708, opacity: 0.5 })); scene.add(line); document.addEventListener('mousemove', onDocumentMouseMove, false); document.addEventListener('touchstart', onDocumentTouchStart, false); document.addEventListener('touchmove', onDocumentTouchMove, false); // window.addEventListener('resize', onWindowResize, false); } function onWindowResize() { windowHalfX = window.innerWidth / 2; windowHalfY = window.innerHeight / 2; camera.aspect = window.innerWidth / window.innerHeight; camera.updateProjectionMatrix(); renderer.setSize(window.innerWidth, window.innerHeight); } // function onDocumentMouseMove(event) { mouseX = event.clientX - windowHalfX; mouseY = event.clientY - windowHalfY; } function onDocumentTouchStart(event) { if (event.touches.length > 1) { //event.preventDefault(); mouseX = event.touches[0].pageX - windowHalfX; //mouseY = event.touches[ 0 ].pageY - windowHalfY; } } function onDocumentTouchMove(event) { if (event.touches.length == 1) { //event.preventDefault(); mouseX = event.touches[0].pageX - windowHalfX; //mouseY = event.touches[ 0 ].pageY - windowHalfY; } } // function animate() { requestAnimationFrame(animate); render(); } function render() { camera.position.x += (mouseX - camera.position.x) * .05; camera.position.y += (-mouseY + 200 - camera.position.y) * .05; camera.lookAt(scene.position); renderer.render(scene, camera); } })"},{"title":"","date":"2019-02-15T07:41:43.409Z","updated":"2019-02-15T07:41:43.409Z","comments":true,"path":"lib/three/src/three-waves.js","permalink":"https://ainevsia.github.io/lib/three/src/three-waves.js","excerpt":"","text":"$(function () { var SEPARATION = 100, AMOUNTX = 50, AMOUNTY = 50; var container; var camera, scene, renderer; var particles, particle, count = 0; var mouseX = 0, mouseY = 0; var windowHalfX = window.innerWidth / 2; var windowHalfY = window.innerHeight / 2; init(); animate(); function init() { container = document.createElement(\"div\"); container.style.position = \"fixed\"; container.style.top = \"0px\"; container.style.left = \"0px\"; container.style.zIndex = \"-1\"; container.style.opacity = \"0.5\"; document.body.appendChild(container); camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 10000); camera.position.z = 1000; scene = new THREE.Scene(); particles = new Array(); var PI2 = Math.PI * 2; var material = new THREE.SpriteCanvasMaterial({ color: 10263708, program: function (context) { context.beginPath(); context.arc(0, 0, 0.5, 0, PI2, true); context.fill() } }); var i = 0; for (var ix = 0; ix < AMOUNTX; ix++) { for (var iy = 0; iy < AMOUNTY; iy++) { particle = particles[i++] = new THREE.Sprite(material); particle.position.x = ix * SEPARATION - ((AMOUNTX * SEPARATION) / 2); particle.position.z = iy * SEPARATION - ((AMOUNTY * SEPARATION) / 2); scene.add(particle) } } renderer = new THREE.CanvasRenderer({ alpha: true }); renderer.setPixelRatio(window.devicePixelRatio); renderer.setSize(window.innerWidth, window.innerHeight); container.appendChild(renderer.domElement); document.addEventListener(\"mousemove\", onDocumentMouseMove, false); window.addEventListener(\"resize\", onWindowResize, false) } function onWindowResize() { windowHalfX = window.innerWidth / 2; windowHalfY = window.innerHeight / 2; camera.aspect = window.innerWidth / window.innerHeight; camera.updateProjectionMatrix(); renderer.setSize(window.innerWidth, window.innerHeight) } function onDocumentMouseMove(event) { mouseX = event.clientX - windowHalfX } function animate() { requestAnimationFrame(animate); render() } function render() { camera.position.x += (mouseX - camera.position.x) * 0.05; camera.position.y = 362.05; camera.lookAt({ x: scene.position.x, y: window.innerHeight / 3, z: scene.position.z }); var i = 0; for (var ix = 0; ix < AMOUNTX; ix++) { for (var iy = 0; iy < AMOUNTY; iy++) { particle = particles[i++]; particle.position.y = (Math.sin((ix + count) * 0.3) * 50) + (Math.sin((iy + count) * 0.5) * 50); particle.scale.x = particle.scale.y = (Math.sin((ix + count) * 0.3) + 1) * 4 + (Math.sin((iy + count) * 0.5) + 1) * 4 } } renderer.render(scene, camera); count += 0.1 } });"},{"title":"","date":"2019-02-15T07:40:54.499Z","updated":"2019-02-15T07:40:54.499Z","comments":true,"path":"lib/fastclick/lib/fastclick.min.js","permalink":"https://ainevsia.github.io/lib/fastclick/lib/fastclick.min.js","excerpt":"","text":"!function(){\"use strict\";function t(e,o){function i(t,e){return function(){return t.apply(e,arguments)}}var r;if(o=o||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=o.touchBoundary||10,this.layer=e,this.tapDelay=o.tapDelay||200,this.tapTimeout=o.tapTimeout||700,!t.notNeeded(e)){for(var a=[\"onMouse\",\"onClick\",\"onTouchStart\",\"onTouchMove\",\"onTouchEnd\",\"onTouchCancel\"],c=this,s=0,u=a.length;u>s;s++)c[a[s]]=i(c[a[s]],c);n&&(e.addEventListener(\"mouseover\",this.onMouse,!0),e.addEventListener(\"mousedown\",this.onMouse,!0),e.addEventListener(\"mouseup\",this.onMouse,!0)),e.addEventListener(\"click\",this.onClick,!0),e.addEventListener(\"touchstart\",this.onTouchStart,!1),e.addEventListener(\"touchmove\",this.onTouchMove,!1),e.addEventListener(\"touchend\",this.onTouchEnd,!1),e.addEventListener(\"touchcancel\",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,o){var i=Node.prototype.removeEventListener;\"click\"===t?i.call(e,t,n.hijacked||n,o):i.call(e,t,n,o)},e.addEventListener=function(t,n,o){var i=Node.prototype.addEventListener;\"click\"===t?i.call(e,t,n.hijacked||(n.hijacked=function(t){t.propagationStopped||n(t)}),o):i.call(e,t,n,o)}),\"function\"==typeof e.onclick&&(r=e.onclick,e.addEventListener(\"click\",function(t){r(t)},!1),e.onclick=null)}}var e=navigator.userAgent.indexOf(\"Windows Phone\")>=0,n=navigator.userAgent.indexOf(\"Android\")>0&&!e,o=/iP(ad|hone|od)/.test(navigator.userAgent)&&!e,i=o&&/OS 4_\\d(_\\d)?/.test(navigator.userAgent),r=o&&/OS [6-7]_\\d/.test(navigator.userAgent),a=navigator.userAgent.indexOf(\"BB10\")>0;t.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case\"button\":case\"select\":case\"textarea\":if(t.disabled)return!0;break;case\"input\":if(o&&\"file\"===t.type||t.disabled)return!0;break;case\"label\":case\"iframe\":case\"video\":return!0}return/\\bneedsclick\\b/.test(t.className)},t.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case\"textarea\":return!0;case\"select\":return!n;case\"input\":switch(t.type){case\"button\":case\"checkbox\":case\"file\":case\"image\":case\"radio\":case\"submit\":return!1}return!t.disabled&&!t.readOnly;default:return/\\bneedsfocus\\b/.test(t.className)}},t.prototype.sendClick=function(t,e){var n,o;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),o=e.changedTouches[0],n=document.createEvent(\"MouseEvents\"),n.initMouseEvent(this.determineEventType(t),!0,!0,window,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,t.dispatchEvent(n)},t.prototype.determineEventType=function(t){return n&&\"select\"===t.tagName.toLowerCase()?\"mousedown\":\"click\"},t.prototype.focus=function(t){var e;o&&t.setSelectionRange&&0!==t.type.indexOf(\"date\")&&\"time\"!==t.type&&\"month\"!==t.type?(e=t.value.length,t.setSelectionRange(e,e)):t.focus()},t.prototype.updateScrollParent=function(t){var e,n;if(e=t.fastClickScrollParent,!e||!e.contains(t)){n=t;do{if(n.scrollHeight>n.offsetHeight){e=n,t.fastClickScrollParent=n;break}n=n.parentElement}while(n)}e&&(e.fastClickLastScrollTop=e.scrollTop)},t.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t},t.prototype.onTouchStart=function(t){var e,n,r;if(t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),n=t.targetTouches[0],o){if(r=window.getSelection(),r.rangeCount&&!r.isCollapsed)return!0;if(!i){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=n.pageX,this.touchStartY=n.pageY,t.timeStamp-this.lastClickTimen||Math.abs(e.pageY-this.touchStartY)>n?!0:!1},t.prototype.onTouchMove=function(t){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},t.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector(\"button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea\")},t.prototype.onTouchEnd=function(t){var e,a,c,s,u,l=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTimethis.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=t.timeStamp,a=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,r&&(u=t.changedTouches[0],l=document.elementFromPoint(u.pageX-window.pageXOffset,u.pageY-window.pageYOffset)||l,l.fastClickScrollParent=this.targetElement.fastClickScrollParent),c=l.tagName.toLowerCase(),\"label\"===c){if(e=this.findControl(l)){if(this.focus(l),n)return!1;l=e}}else if(this.needsFocus(l))return t.timeStamp-a>100||o&&window.top!==window&&\"input\"===c?(this.targetElement=null,!1):(this.focus(l),this.sendClick(l,t),o&&\"select\"===c||(this.targetElement=null,t.preventDefault()),!1);return o&&!i&&(s=l.fastClickScrollParent,s&&s.fastClickLastScrollTop!==s.scrollTop)?!0:(this.needsClick(l)||(t.preventDefault(),this.sendClick(l,t)),!1)},t.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},t.prototype.onMouse=function(t){return this.targetElement?t.forwardedTouchEvent?!0:t.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1):!0:!0},t.prototype.onClick=function(t){var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):\"submit\"===t.target.type&&0===t.detail?!0:(e=this.onMouse(t),e||(this.targetElement=null),e)},t.prototype.destroy=function(){var t=this.layer;n&&(t.removeEventListener(\"mouseover\",this.onMouse,!0),t.removeEventListener(\"mousedown\",this.onMouse,!0),t.removeEventListener(\"mouseup\",this.onMouse,!0)),t.removeEventListener(\"click\",this.onClick,!0),t.removeEventListener(\"touchstart\",this.onTouchStart,!1),t.removeEventListener(\"touchmove\",this.onTouchMove,!1),t.removeEventListener(\"touchend\",this.onTouchEnd,!1),t.removeEventListener(\"touchcancel\",this.onTouchCancel,!1)},t.notNeeded=function(t){var e,o,i,r;if(\"undefined\"==typeof window.ontouchstart)return!0;if(o=+(/Chrome\\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!n)return!0;if(e=document.querySelector(\"meta[name=viewport]\")){if(-1!==e.content.indexOf(\"user-scalable=no\"))return!0;if(o>31&&document.documentElement.scrollWidth=10&&i[2]>=3&&(e=document.querySelector(\"meta[name=viewport]\")))){if(-1!==e.content.indexOf(\"user-scalable=no\"))return!0;if(document.documentElement.scrollWidth=27&&(e=document.querySelector(\"meta[name=viewport]\"),e&&(-1!==e.content.indexOf(\"user-scalable=no\")||document.documentElement.scrollWidth"},{"title":"","date":"2019-02-15T07:40:54.499Z","updated":"2019-02-15T07:40:54.499Z","comments":true,"path":"lib/fastclick/lib/fastclick.js","permalink":"https://ainevsia.github.io/lib/fastclick/lib/fastclick.js","excerpt":"","text":";(function () { 'use strict'; /** * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs. * * @codingstandard ftlabs-jsv2 * @copyright The Financial Times Limited [All Rights Reserved] * @license MIT License (see LICENSE.txt) */ /*jslint browser:true, node:true*/ /*global define, Event, Node*/ /** * Instantiate fast-clicking listeners on the specified layer. * * @constructor * @param {Element} layer The layer to listen on * @param {Object} [options={}] The options to override the defaults */ function FastClick(layer, options) { var oldOnClick; options = options || {}; /** * Whether a click is currently being tracked. * * @type boolean */ this.trackingClick = false; /** * Timestamp for when click tracking started. * * @type number */ this.trackingClickStart = 0; /** * The element being tracked for a click. * * @type EventTarget */ this.targetElement = null; /** * X-coordinate of touch start event. * * @type number */ this.touchStartX = 0; /** * Y-coordinate of touch start event. * * @type number */ this.touchStartY = 0; /** * ID of the last touch, retrieved from Touch.identifier. * * @type number */ this.lastTouchIdentifier = 0; /** * Touchmove boundary, beyond which a click will be cancelled. * * @type number */ this.touchBoundary = options.touchBoundary || 10; /** * The FastClick layer. * * @type Element */ this.layer = layer; /** * The minimum time between tap(touchstart and touchend) events * * @type number */ this.tapDelay = options.tapDelay || 200; /** * The maximum time for a tap * * @type number */ this.tapTimeout = options.tapTimeout || 700; if (FastClick.notNeeded(layer)) { return; } // Some old versions of Android don't have Function.prototype.bind function bind(method, context) { return function() { return method.apply(context, arguments); }; } var methods = ['onMouse', 'onClick', 'onTouchStart', 'onTouchMove', 'onTouchEnd', 'onTouchCancel']; var context = this; for (var i = 0, l = methods.length; i < l; i++) { context[methods[i]] = bind(context[methods[i]], context); } // Set up event handlers as required if (deviceIsAndroid) { layer.addEventListener('mouseover', this.onMouse, true); layer.addEventListener('mousedown', this.onMouse, true); layer.addEventListener('mouseup', this.onMouse, true); } layer.addEventListener('click', this.onClick, true); layer.addEventListener('touchstart', this.onTouchStart, false); layer.addEventListener('touchmove', this.onTouchMove, false); layer.addEventListener('touchend', this.onTouchEnd, false); layer.addEventListener('touchcancel', this.onTouchCancel, false); // Hack is required for browsers that don't support Event#stopImmediatePropagation (e.g. Android 2) // which is how FastClick normally stops click events bubbling to callbacks registered on the FastClick // layer when they are cancelled. if (!Event.prototype.stopImmediatePropagation) { layer.removeEventListener = function(type, callback, capture) { var rmv = Node.prototype.removeEventListener; if (type === 'click') { rmv.call(layer, type, callback.hijacked || callback, capture); } else { rmv.call(layer, type, callback, capture); } }; layer.addEventListener = function(type, callback, capture) { var adv = Node.prototype.addEventListener; if (type === 'click') { adv.call(layer, type, callback.hijacked || (callback.hijacked = function(event) { if (!event.propagationStopped) { callback(event); } }), capture); } else { adv.call(layer, type, callback, capture); } }; } // If a handler is already declared in the element's onclick attribute, it will be fired before // FastClick's onClick handler. Fix this by pulling out the user-defined handler function and // adding it as listener. if (typeof layer.onclick === 'function') { // Android browser on at least 3.2 requires a new reference to the function in layer.onclick // - the old one won't work if passed to addEventListener directly. oldOnClick = layer.onclick; layer.addEventListener('click', function(event) { oldOnClick(event); }, false); layer.onclick = null; } } /** * Windows Phone 8.1 fakes user agent string to look like Android and iPhone. * * @type boolean */ var deviceIsWindowsPhone = navigator.userAgent.indexOf(\"Windows Phone\") >= 0; /** * Android requires exceptions. * * @type boolean */ var deviceIsAndroid = navigator.userAgent.indexOf('Android') > 0 && !deviceIsWindowsPhone; /** * iOS requires exceptions. * * @type boolean */ var deviceIsIOS = /iP(ad|hone|od)/.test(navigator.userAgent) && !deviceIsWindowsPhone; /** * iOS 4 requires an exception for select elements. * * @type boolean */ var deviceIsIOS4 = deviceIsIOS && (/OS 4_\\d(_\\d)?/).test(navigator.userAgent); /** * iOS 6.0-7.* requires the target element to be manually derived * * @type boolean */ var deviceIsIOSWithBadTarget = deviceIsIOS && (/OS [6-7]_\\d/).test(navigator.userAgent); /** * BlackBerry requires exceptions. * * @type boolean */ var deviceIsBlackBerry10 = navigator.userAgent.indexOf('BB10') > 0; /** * Determine whether a given element requires a native click. * * @param {EventTarget|Element} target Target DOM element * @returns {boolean} Returns true if the element needs a native click */ FastClick.prototype.needsClick = function(target) { switch (target.nodeName.toLowerCase()) { // Don't send a synthetic click to disabled inputs (issue #62) case 'button': case 'select': case 'textarea': if (target.disabled) { return true; } break; case 'input': // File inputs need real clicks on iOS 6 due to a browser bug (issue #68) if ((deviceIsIOS && target.type === 'file') || target.disabled) { return true; } break; case 'label': case 'iframe': // iOS8 homescreen apps can prevent events bubbling into frames case 'video': return true; } return (/\\bneedsclick\\b/).test(target.className); }; /** * Determine whether a given element requires a call to focus to simulate click into element. * * @param {EventTarget|Element} target Target DOM element * @returns {boolean} Returns true if the element requires a call to focus to simulate native click. */ FastClick.prototype.needsFocus = function(target) { switch (target.nodeName.toLowerCase()) { case 'textarea': return true; case 'select': return !deviceIsAndroid; case 'input': switch (target.type) { case 'button': case 'checkbox': case 'file': case 'image': case 'radio': case 'submit': return false; } // No point in attempting to focus disabled inputs return !target.disabled && !target.readOnly; default: return (/\\bneedsfocus\\b/).test(target.className); } }; /** * Send a click event to the specified element. * * @param {EventTarget|Element} targetElement * @param {Event} event */ FastClick.prototype.sendClick = function(targetElement, event) { var clickEvent, touch; // On some Android devices activeElement needs to be blurred otherwise the synthetic click will have no effect (#24) if (document.activeElement && document.activeElement !== targetElement) { document.activeElement.blur(); } touch = event.changedTouches[0]; // Synthesise a click event, with an extra attribute so it can be tracked clickEvent = document.createEvent('MouseEvents'); clickEvent.initMouseEvent(this.determineEventType(targetElement), true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null); clickEvent.forwardedTouchEvent = true; targetElement.dispatchEvent(clickEvent); }; FastClick.prototype.determineEventType = function(targetElement) { //Issue #159: Android Chrome Select Box does not open with a synthetic click event if (deviceIsAndroid && targetElement.tagName.toLowerCase() === 'select') { return 'mousedown'; } return 'click'; }; /** * @param {EventTarget|Element} targetElement */ FastClick.prototype.focus = function(targetElement) { var length; // Issue #160: on iOS 7, some input elements (e.g. date datetime month) throw a vague TypeError on setSelectionRange. These elements don't have an integer value for the selectionStart and selectionEnd properties, but unfortunately that can't be used for detection because accessing the properties also throws a TypeError. Just check the type instead. Filed as Apple bug #15122724. if (deviceIsIOS && targetElement.setSelectionRange && targetElement.type.indexOf('date') !== 0 && targetElement.type !== 'time' && targetElement.type !== 'month') { length = targetElement.value.length; targetElement.setSelectionRange(length, length); } else { targetElement.focus(); } }; /** * Check whether the given target element is a child of a scrollable layer and if so, set a flag on it. * * @param {EventTarget|Element} targetElement */ FastClick.prototype.updateScrollParent = function(targetElement) { var scrollParent, parentElement; scrollParent = targetElement.fastClickScrollParent; // Attempt to discover whether the target element is contained within a scrollable layer. Re-check if the // target element was moved to another parent. if (!scrollParent || !scrollParent.contains(targetElement)) { parentElement = targetElement; do { if (parentElement.scrollHeight > parentElement.offsetHeight) { scrollParent = parentElement; targetElement.fastClickScrollParent = parentElement; break; } parentElement = parentElement.parentElement; } while (parentElement); } // Always update the scroll top tracker if possible. if (scrollParent) { scrollParent.fastClickLastScrollTop = scrollParent.scrollTop; } }; /** * @param {EventTarget} targetElement * @returns {Element|EventTarget} */ FastClick.prototype.getTargetElementFromEventTarget = function(eventTarget) { // On some older browsers (notably Safari on iOS 4.1 - see issue #56) the event target may be a text node. if (eventTarget.nodeType === Node.TEXT_NODE) { return eventTarget.parentNode; } return eventTarget; }; /** * On touch start, record the position and scroll offset. * * @param {Event} event * @returns {boolean} */ FastClick.prototype.onTouchStart = function(event) { var targetElement, touch, selection; // Ignore multiple touches, otherwise pinch-to-zoom is prevented if both fingers are on the FastClick element (issue #111). if (event.targetTouches.length > 1) { return true; } targetElement = this.getTargetElementFromEventTarget(event.target); touch = event.targetTouches[0]; if (deviceIsIOS) { // Only trusted events will deselect text on iOS (issue #49) selection = window.getSelection(); if (selection.rangeCount && !selection.isCollapsed) { return true; } if (!deviceIsIOS4) { // Weird things happen on iOS when an alert or confirm dialog is opened from a click event callback (issue #23): // when the user next taps anywhere else on the page, new touchstart and touchend events are dispatched // with the same identifier as the touch event that previously triggered the click that triggered the alert. // Sadly, there is an issue on iOS 4 that causes some normal touch events to have the same identifier as an // immediately preceeding touch event (issue #52), so this fix is unavailable on that platform. // Issue 120: touch.identifier is 0 when Chrome dev tools 'Emulate touch events' is set with an iOS device UA string, // which causes all touch events to be ignored. As this block only applies to iOS, and iOS identifiers are always long, // random integers, it's safe to to continue if the identifier is 0 here. if (touch.identifier && touch.identifier === this.lastTouchIdentifier) { event.preventDefault(); return false; } this.lastTouchIdentifier = touch.identifier; // If the target element is a child of a scrollable layer (using -webkit-overflow-scrolling: touch) and: // 1) the user does a fling scroll on the scrollable layer // 2) the user stops the fling scroll with another tap // then the event.target of the last 'touchend' event will be the element that was under the user's finger // when the fling scroll was started, causing FastClick to send a click event to that layer - unless a check // is made to ensure that a parent layer was not scrolled before sending a synthetic click (issue #42). this.updateScrollParent(targetElement); } } this.trackingClick = true; this.trackingClickStart = event.timeStamp; this.targetElement = targetElement; this.touchStartX = touch.pageX; this.touchStartY = touch.pageY; // Prevent phantom clicks on fast double-tap (issue #36) if ((event.timeStamp - this.lastClickTime) < this.tapDelay) { event.preventDefault(); } return true; }; /** * Based on a touchmove event object, check whether the touch has moved past a boundary since it started. * * @param {Event} event * @returns {boolean} */ FastClick.prototype.touchHasMoved = function(event) { var touch = event.changedTouches[0], boundary = this.touchBoundary; if (Math.abs(touch.pageX - this.touchStartX) > boundary || Math.abs(touch.pageY - this.touchStartY) > boundary) { return true; } return false; }; /** * Update the last position. * * @param {Event} event * @returns {boolean} */ FastClick.prototype.onTouchMove = function(event) { if (!this.trackingClick) { return true; } // If the touch has moved, cancel the click tracking if (this.targetElement !== this.getTargetElementFromEventTarget(event.target) || this.touchHasMoved(event)) { this.trackingClick = false; this.targetElement = null; } return true; }; /** * Attempt to find the labelled control for the given label element. * * @param {EventTarget|HTMLLabelElement} labelElement * @returns {Element|null} */ FastClick.prototype.findControl = function(labelElement) { // Fast path for newer browsers supporting the HTML5 control attribute if (labelElement.control !== undefined) { return labelElement.control; } // All browsers under test that support touch events also support the HTML5 htmlFor attribute if (labelElement.htmlFor) { return document.getElementById(labelElement.htmlFor); } // If no for attribute exists, attempt to retrieve the first labellable descendant element // the list of which is defined here: http://www.w3.org/TR/html5/forms.html#category-label return labelElement.querySelector('button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea'); }; /** * On touch end, determine whether to send a click event at once. * * @param {Event} event * @returns {boolean} */ FastClick.prototype.onTouchEnd = function(event) { var forElement, trackingClickStart, targetTagName, scrollParent, touch, targetElement = this.targetElement; if (!this.trackingClick) { return true; } // Prevent phantom clicks on fast double-tap (issue #36) if ((event.timeStamp - this.lastClickTime) < this.tapDelay) { this.cancelNextClick = true; return true; } if ((event.timeStamp - this.trackingClickStart) > this.tapTimeout) { return true; } // Reset to prevent wrong click cancel on input (issue #156). this.cancelNextClick = false; this.lastClickTime = event.timeStamp; trackingClickStart = this.trackingClickStart; this.trackingClick = false; this.trackingClickStart = 0; // On some iOS devices, the targetElement supplied with the event is invalid if the layer // is performing a transition or scroll, and has to be re-detected manually. Note that // for this to function correctly, it must be called *after* the event target is checked! // See issue #57; also filed as rdar://13048589 . if (deviceIsIOSWithBadTarget) { touch = event.changedTouches[0]; // In certain cases arguments of elementFromPoint can be negative, so prevent setting targetElement to null targetElement = document.elementFromPoint(touch.pageX - window.pageXOffset, touch.pageY - window.pageYOffset) || targetElement; targetElement.fastClickScrollParent = this.targetElement.fastClickScrollParent; } targetTagName = targetElement.tagName.toLowerCase(); if (targetTagName === 'label') { forElement = this.findControl(targetElement); if (forElement) { this.focus(targetElement); if (deviceIsAndroid) { return false; } targetElement = forElement; } } else if (this.needsFocus(targetElement)) { // Case 1: If the touch started a while ago (best guess is 100ms based on tests for issue #36) then focus will be triggered anyway. Return early and unset the target element reference so that the subsequent click will be allowed through. // Case 2: Without this exception for input elements tapped when the document is contained in an iframe, then any inputted text won't be visible even though the value attribute is updated as the user types (issue #37). if ((event.timeStamp - trackingClickStart) > 100 || (deviceIsIOS && window.top !== window && targetTagName === 'input')) { this.targetElement = null; return false; } this.focus(targetElement); this.sendClick(targetElement, event); // Select elements need the event to go through on iOS 4, otherwise the selector menu won't open. // Also this breaks opening selects when VoiceOver is active on iOS6, iOS7 (and possibly others) if (!deviceIsIOS || targetTagName !== 'select') { this.targetElement = null; event.preventDefault(); } return false; } if (deviceIsIOS && !deviceIsIOS4) { // Don't send a synthetic click event if the target element is contained within a parent layer that was scrolled // and this tap is being used to stop the scrolling (usually initiated by a fling - issue #42). scrollParent = targetElement.fastClickScrollParent; if (scrollParent && scrollParent.fastClickLastScrollTop !== scrollParent.scrollTop) { return true; } } // Prevent the actual click from going though - unless the target node is marked as requiring // real clicks or if it is in the whitelist in which case only non-programmatic clicks are permitted. if (!this.needsClick(targetElement)) { event.preventDefault(); this.sendClick(targetElement, event); } return false; }; /** * On touch cancel, stop tracking the click. * * @returns {void} */ FastClick.prototype.onTouchCancel = function() { this.trackingClick = false; this.targetElement = null; }; /** * Determine mouse events which should be permitted. * * @param {Event} event * @returns {boolean} */ FastClick.prototype.onMouse = function(event) { // If a target element was never set (because a touch event was never fired) allow the event if (!this.targetElement) { return true; } if (event.forwardedTouchEvent) { return true; } // Programmatically generated events targeting a specific element should be permitted if (!event.cancelable) { return true; } // Derive and check the target element to see whether the mouse event needs to be permitted; // unless explicitly enabled, prevent non-touch click events from triggering actions, // to prevent ghost/doubleclicks. if (!this.needsClick(this.targetElement) || this.cancelNextClick) { // Prevent any user-added listeners declared on FastClick element from being fired. if (event.stopImmediatePropagation) { event.stopImmediatePropagation(); } else { // Part of the hack for browsers that don't support Event#stopImmediatePropagation (e.g. Android 2) event.propagationStopped = true; } // Cancel the event event.stopPropagation(); event.preventDefault(); return false; } // If the mouse event is permitted, return true for the action to go through. return true; }; /** * On actual clicks, determine whether this is a touch-generated click, a click action occurring * naturally after a delay after a touch (which needs to be cancelled to avoid duplication), or * an actual click which should be permitted. * * @param {Event} event * @returns {boolean} */ FastClick.prototype.onClick = function(event) { var permitted; // It's possible for another FastClick-like library delivered with third-party code to fire a click event before FastClick does (issue #44). In that case, set the click-tracking flag back to false and return early. This will cause onTouchEnd to return early. if (this.trackingClick) { this.targetElement = null; this.trackingClick = false; return true; } // Very odd behaviour on iOS (issue #18): if a submit element is present inside a form and the user hits enter in the iOS simulator or clicks the Go button on the pop-up OS keyboard the a kind of 'fake' click event will be triggered with the submit-type input element as the target. if (event.target.type === 'submit' && event.detail === 0) { return true; } permitted = this.onMouse(event); // Only unset targetElement if the click is not permitted. This will ensure that the check for !targetElement in onMouse fails and the browser's click doesn't go through. if (!permitted) { this.targetElement = null; } // If clicks are permitted, return true for the action to go through. return permitted; }; /** * Remove all FastClick's event listeners. * * @returns {void} */ FastClick.prototype.destroy = function() { var layer = this.layer; if (deviceIsAndroid) { layer.removeEventListener('mouseover', this.onMouse, true); layer.removeEventListener('mousedown', this.onMouse, true); layer.removeEventListener('mouseup', this.onMouse, true); } layer.removeEventListener('click', this.onClick, true); layer.removeEventListener('touchstart', this.onTouchStart, false); layer.removeEventListener('touchmove', this.onTouchMove, false); layer.removeEventListener('touchend', this.onTouchEnd, false); layer.removeEventListener('touchcancel', this.onTouchCancel, false); }; /** * Check whether FastClick is needed. * * @param {Element} layer The layer to listen on */ FastClick.notNeeded = function(layer) { var metaViewport; var chromeVersion; var blackberryVersion; var firefoxVersion; // Devices that don't support touch don't need FastClick if (typeof window.ontouchstart === 'undefined') { return true; } // Chrome version - zero for other browsers chromeVersion = +(/Chrome\\/([0-9]+)/.exec(navigator.userAgent) || [,0])[1]; if (chromeVersion) { if (deviceIsAndroid) { metaViewport = document.querySelector('meta[name=viewport]'); if (metaViewport) { // Chrome on Android with user-scalable=\"no\" doesn't need FastClick (issue #89) if (metaViewport.content.indexOf('user-scalable=no') !== -1) { return true; } // Chrome 32 and above with width=device-width or less don't need FastClick if (chromeVersion > 31 && document.documentElement.scrollWidth"},{"title":"","date":"2019-02-15T07:57:56.287Z","updated":"2019-02-15T07:57:56.287Z","comments":true,"path":"lib/fancybox/source/jquery.fancybox.pack.js","permalink":"https://ainevsia.github.io/lib/fancybox/source/jquery.fancybox.pack.js","excerpt":"","text":"// ================================================== // fancyBox v3.2.5 // // Licensed GPLv3 for open source use // or fancyBox Commercial License for commercial use // // http://fancyapps.com/fancybox/ // Copyright 2017 fancyApps // // ================================================== ;(function (window, document, $, undefined) { 'use strict'; // If there's no jQuery, fancyBox can't work // ========================================= if ( !$ ) { return; } // Check if fancyBox is already initialized // ======================================== if ( $.fn.fancybox ) { if ( 'console' in window ) { console.log( 'fancyBox already initialized' ); } return; } // Private default settings // ======================== var defaults = { // Enable infinite gallery navigation loop : false, // Space around image, ignored if zoomed-in or viewport width is smaller than 800px margin : [44, 0], // Horizontal space between slides gutter : 50, // Enable keyboard navigation keyboard : true, // Should display navigation arrows at the screen edges arrows : true, // Should display infobar (counter and arrows at the top) infobar : true, // Should display toolbar (buttons at the top) toolbar : true, // What buttons should appear in the top right corner. // Buttons will be created using templates from `btnTpl` option // and they will be placed into toolbar (class=\"fancybox-toolbar\"` element) buttons : [ 'slideShow', 'fullScreen', 'thumbs', 'share', //'download', //'zoom', 'close' ], // Detect \"idle\" time in seconds idleTime : 3, // Should display buttons at top right corner of the content // If 'auto' - they will be created for content having type 'html', 'inline' or 'ajax' // Use template from `btnTpl.smallBtn` for customization smallBtn : 'auto', // Disable right-click and use simple image protection for images protect : false, // Shortcut to make content \"modal\" - disable keyboard navigtion, hide buttons, etc modal : false, image : { // Wait for images to load before displaying // Requires predefined image dimensions // If 'auto' - will zoom in thumbnail if 'width' and 'height' attributes are found preload : \"auto\" }, ajax : { // Object containing settings for ajax request settings : { // This helps to indicate that request comes from the modal // Feel free to change naming data : { fancybox : true } } }, iframe : { // Iframe template tpl : '', // Preload iframe before displaying it // This allows to calculate iframe content width and height // (note: Due to \"Same Origin Policy\", you can't get cross domain data). preload : true, // Custom CSS styling for iframe wrapping element // You can use this to set custom iframe dimensions css : {}, // Iframe tag attributes attr : { scrolling : 'auto' } }, // Default content type if cannot be detected automatically defaultType : 'image', // Open/close animation type // Possible values: // false - disable // \"zoom\" - zoom images from/to thumbnail // \"fade\" // \"zoom-in-out\" // animationEffect : \"zoom\", // Duration in ms for open/close animation animationDuration : 500, // Should image change opacity while zooming // If opacity is \"auto\", then opacity will be changed if image and thumbnail have different aspect ratios zoomOpacity : \"auto\", // Transition effect between slides // // Possible values: // false - disable // \"fade' // \"slide' // \"circular' // \"tube' // \"zoom-in-out' // \"rotate' // transitionEffect : \"fade\", // Duration in ms for transition animation transitionDuration : 366, // Custom CSS class for slide element slideClass : '', // Custom CSS class for layout baseClass : '', // Base template for layout baseTpl : '' + '' + '' + '' + '&nbsp;/&nbsp;' + '' + '' + '' + '' + '' + '' + '', // Loading indicator template spinnerTpl : '', // Error message template errorTpl : '', btnTpl : { download : '' + '' + '' + '' + '', zoom : '' + '' + '' + '' + '', close : '' + '' + '' + '' + '', // This small close button will be appended to your html/inline/ajax content by default, // if \"smallBtn\" option is not set to false smallBtn : '', // Arrows arrowLeft : '' + '' + '' + '' + '', arrowRight : '' + '' + '' + '' + '' }, // Container is injected into this element parentEl : 'body', // Focus handling // ============== // Try to focus on the first focusable element after opening autoFocus : false, // Put focus back to active element after closing backFocus : true, // Do not let user to focus on element outside modal content trapFocus : true, // Module specific options // ======================= fullScreen : { autoStart : false, }, // Set `touch: false` to disable dragging/swiping touch : { vertical : true, // Allow to drag content vertically momentum : true // Continue movement after releasing mouse/touch when panning }, // Hash value when initializing manually, // set `false` to disable hash change hash : null, // Customize or add new media types // Example: /* media : { youtube : { params : { autoplay : 0 } } } */ media : {}, slideShow : { autoStart : false, speed : 4000 }, thumbs : { autoStart : false, // Display thumbnails on opening hideOnClose : true, // Hide thumbnail grid when closing animation starts parentEl : '.fancybox-container', // Container is injected into this element axis : 'y' // Vertical (y) or horizontal (x) scrolling }, // Callbacks //========== // See Documentation/API/Events for more information // Example: /* afterShow: function( instance, current ) { console.info( 'Clicked element:' ); console.info( current.opts.$orig ); } */ onInit : $.noop, // When instance has been initialized beforeLoad : $.noop, // Before the content of a slide is being loaded afterLoad : $.noop, // When the content of a slide is done loading beforeShow : $.noop, // Before open animation starts afterShow : $.noop, // When content is done loading and animating beforeClose : $.noop, // Before the instance attempts to close. Return false to cancel the close. afterClose : $.noop, // After instance has been closed onActivate : $.noop, // When instance is brought to front onDeactivate : $.noop, // When other instance has been activated // Interaction // =========== // Use options below to customize taken action when user clicks or double clicks on the fancyBox area, // each option can be string or method that returns value. // // Possible values: // \"close\" - close instance // \"next\" - move to next gallery item // \"nextOrClose\" - move to next gallery item or close if gallery has only one item // \"toggleControls\" - show/hide controls // \"zoom\" - zoom image (if loaded) // false - do nothing // Clicked on the content clickContent : function( current, event ) { return current.type === 'image' ? 'zoom' : false; }, // Clicked on the slide clickSlide : 'close', // Clicked on the background (backdrop) element clickOutside : 'close', // Same as previous two, but for double click dblclickContent : false, dblclickSlide : false, dblclickOutside : false, // Custom options when mobile device is detected // ============================================= mobile : { margin : 0, clickContent : function( current, event ) { return current.type === 'image' ? 'toggleControls' : false; }, clickSlide : function( current, event ) { return current.type === 'image' ? 'toggleControls' : 'close'; }, dblclickContent : function( current, event ) { return current.type === 'image' ? 'zoom' : false; }, dblclickSlide : function( current, event ) { return current.type === 'image' ? 'zoom' : false; } }, // Internationalization // ============ lang : 'en', i18n : { 'en' : { CLOSE : 'Close', NEXT : 'Next', PREV : 'Previous', ERROR : 'The requested content cannot be loaded. Please try again later.', PLAY_START : 'Start slideshow', PLAY_STOP : 'Pause slideshow', FULL_SCREEN : 'Full screen', THUMBS : 'Thumbnails', DOWNLOAD : 'Download', SHARE : 'Share', ZOOM : 'Zoom' }, 'de' : { CLOSE : 'Schliessen', NEXT : 'Weiter', PREV : 'Zurück', ERROR : 'Die angeforderten Daten konnten nicht geladen werden. Bitte versuchen Sie es später nochmal.', PLAY_START : 'Diaschau starten', PLAY_STOP : 'Diaschau beenden', FULL_SCREEN : 'Vollbild', THUMBS : 'Vorschaubilder', DOWNLOAD : 'Herunterladen', SHARE : 'Teilen', ZOOM : 'Maßstab' } } }; // Few useful variables and methods // ================================ var $W = $(window); var $D = $(document); var called = 0; // Check if an object is a jQuery object and not a native JavaScript object // ======================================================================== var isQuery = function ( obj ) { return obj && obj.hasOwnProperty && obj instanceof $; }; // Handle multiple browsers for \"requestAnimationFrame\" and \"cancelAnimationFrame\" // =============================================================================== var requestAFrame = (function () { return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || // if all else fails, use setTimeout function (callback) { return window.setTimeout(callback, 1000 / 60); }; })(); // Detect the supported transition-end event property name // ======================================================= var transitionEnd = (function () { var t, el = document.createElement(\"fakeelement\"); var transitions = { \"transition\" : \"transitionend\", \"OTransition\" : \"oTransitionEnd\", \"MozTransition\" : \"transitionend\", \"WebkitTransition\": \"webkitTransitionEnd\" }; for (t in transitions) { if (el.style[t] !== undefined){ return transitions[t]; } } return 'transitionend'; })(); // Force redraw on an element. // This helps in cases where the browser doesn't redraw an updated element properly. // ================================================================================= var forceRedraw = function( $el ) { return ( $el && $el.length && $el[0].offsetHeight ); }; // Class definition // ================ var FancyBox = function( content, opts, index ) { var self = this; self.opts = $.extend( true, { index : index }, $.fancybox.defaults, opts || {} ); if ( $.fancybox.isMobile ) { self.opts = $.extend( true, {}, self.opts, self.opts.mobile ); } // Exclude buttons option from deep merging if ( opts && $.isArray( opts.buttons ) ) { self.opts.buttons = opts.buttons; } self.id = self.opts.id || ++called; self.group = []; self.currIndex = parseInt( self.opts.index, 10 ) || 0; self.prevIndex = null; self.prevPos = null; self.currPos = 0; self.firstRun = null; // Create group elements from original item collection self.createGroup( content ); if ( !self.group.length ) { return; } // Save last active element and current scroll position self.$lastFocus = $(document.activeElement).blur(); // Collection of gallery objects self.slides = {}; self.init(); }; $.extend(FancyBox.prototype, { // Create DOM structure // ==================== init : function() { var self = this, firstItem = self.group[ self.currIndex ], firstItemOpts = firstItem.opts, scrollbarWidth = $.fancybox.scrollbarWidth, $scrollDiv, $container, buttonStr; self.scrollTop = $D.scrollTop(); self.scrollLeft = $D.scrollLeft(); // Hide scrollbars // =============== if ( !$.fancybox.getInstance() ) { $( 'body' ).addClass( 'fancybox-active' ); // iOS hack if ( /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream ) { // iOS has problems for input elements inside fixed containers, // the workaround is to apply `position: fixed` to `` element, // unfortunately, this makes it lose the scrollbars and forces address bar to appear. if ( firstItem.type !== 'image' ) { $( 'body' ).css( 'top', $( 'body' ).scrollTop() * -1 ).addClass( 'fancybox-iosfix' ); } } else if ( !$.fancybox.isMobile && document.body.scrollHeight > window.innerHeight ) { if ( scrollbarWidth === undefined ) { $scrollDiv = $('').appendTo( 'body' ); scrollbarWidth = $.fancybox.scrollbarWidth = $scrollDiv[0].offsetWidth - $scrollDiv[0].clientWidth; $scrollDiv.remove(); } $( 'head' ).append( '.compensate-for-scrollbar { margin-right: ' + scrollbarWidth + 'px; }' ); $( 'body' ).addClass( 'compensate-for-scrollbar' ); } } // Build html markup and set references // ==================================== // Build html code for buttons and insert into main template buttonStr = ''; $.each( firstItemOpts.buttons, function( index, value ) { buttonStr += ( firstItemOpts.btnTpl[ value ] || '' ); }); // Create markup from base template, it will be initially hidden to // avoid unnecessary work like painting while initializing is not complete $container = $( self.translate( self, firstItemOpts.baseTpl .replace( '\\{\\{buttons\\}\\}', buttonStr ) .replace( '\\{\\{arrows\\}\\}', firstItemOpts.btnTpl.arrowLeft + firstItemOpts.btnTpl.arrowRight ) ) ) .attr( 'id', 'fancybox-container-' + self.id ) .addClass( 'fancybox-is-hidden' ) .addClass( firstItemOpts.baseClass ) .data( 'FancyBox', self ) .appendTo( firstItemOpts.parentEl ); // Create object holding references to jQuery wrapped nodes self.$refs = { container : $container }; [ 'bg', 'inner', 'infobar', 'toolbar', 'stage', 'caption', 'navigation' ].forEach(function(item) { self.$refs[ item ] = $container.find( '.fancybox-' + item ); }); self.trigger( 'onInit' ); // Enable events, deactive previous instances self.activate(); // Build slides, load and reveal content self.jumpTo( self.currIndex ); }, // Simple i18n support - replaces object keys found in template // with corresponding values // ============================================================ translate : function( obj, str ) { var arr = obj.opts.i18n[ obj.opts.lang ]; return str.replace(/\\{\\{(\\w+)\\}\\}/g, function(match, n) { var value = arr[n]; if ( value === undefined ) { return match; } return value; }); }, // Create array of gally item objects // Check if each object has valid type and content // =============================================== createGroup : function ( content ) { var self = this; var items = $.makeArray( content ); $.each(items, function( i, item ) { var obj = {}, opts = {}, $item, type, src, srcParts; // Step 1 - Make sure we have an object // ==================================== if ( $.isPlainObject( item ) ) { // We probably have manual usage here, something like // $.fancybox.open( [ { src : \"image.jpg\", type : \"image\" } ] ) obj = item; opts = item.opts || item; } else if ( $.type( item ) === 'object' && $( item ).length ) { // Here we probably have jQuery collection returned by some selector $item = $( item ); opts = $item.data(); opts = $.extend( {}, opts, opts.options || {} ); // Here we store clicked element opts.$orig = $item; obj.src = opts.src || $item.attr( 'href' ); // Assume that simple syntax is used, for example: // `$.fancybox.open( $(\"#test\"), {} );` if ( !obj.type && !obj.src ) { obj.type = 'inline'; obj.src = item; } } else { // Assume we have a simple html code, for example: // $.fancybox.open( 'Hi!' ); obj = { type : 'html', src : item + '' }; } // Each gallery object has full collection of options obj.opts = $.extend( true, {}, self.opts, opts ); // Do not merge buttons array if ( $.isArray( opts.buttons ) ) { obj.opts.buttons = opts.buttons; } // Step 2 - Make sure we have content type, if not - try to guess // ============================================================== type = obj.type || obj.opts.type; src = obj.src || ''; if ( !type && src ) { if ( src.match(/(^data:image\\/[a-z0-9+\\/=]*,)|(\\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\\?|#).*)?$)/i) ) { type = 'image'; } else if ( src.match(/\\.(pdf)((\\?|#).*)?$/i) ) { type = 'pdf'; } else if ( src.charAt(0) === '#' ) { type = 'inline'; } } if ( type ) { obj.type = type; } else { self.trigger( 'objectNeedsType', obj ); } // Step 3 - Some adjustments // ========================= obj.index = self.group.length; // Check if $orig and $thumb objects exist if ( obj.opts.$orig && !obj.opts.$orig.length ) { delete obj.opts.$orig; } if ( !obj.opts.$thumb && obj.opts.$orig ) { obj.opts.$thumb = obj.opts.$orig.find( 'img:first' ); } if ( obj.opts.$thumb && !obj.opts.$thumb.length ) { delete obj.opts.$thumb; } // \"caption\" is a \"special\" option, it can be used to customize caption per gallery item .. if ( $.type( obj.opts.caption ) === 'function' ) { obj.opts.caption = obj.opts.caption.apply( item, [ self, obj ] ); } if ( $.type( self.opts.caption ) === 'function' ) { obj.opts.caption = self.opts.caption.apply( item, [ self, obj ] ); } // Make sure we have caption as a string or jQuery object if ( !( obj.opts.caption instanceof $ ) ) { obj.opts.caption = obj.opts.caption === undefined ? '' : obj.opts.caption + ''; } // Check if url contains \"filter\" used to filter the content // Example: \"ajax.html #something\" if ( type === 'ajax' ) { srcParts = src.split(/\\s+/, 2); if ( srcParts.length > 1 ) { obj.src = srcParts.shift(); obj.opts.filter = srcParts.shift(); } } if ( obj.opts.smallBtn == 'auto' ) { if ( $.inArray( type, ['html', 'inline', 'ajax'] ) > -1 ) { obj.opts.toolbar = false; obj.opts.smallBtn = true; } else { obj.opts.smallBtn = false; } } // If the type is \"pdf\", then simply load file into iframe if ( type === 'pdf' ) { obj.type = 'iframe'; obj.opts.iframe.preload = false; } // Hide all buttons and disable interactivity for modal items if ( obj.opts.modal ) { obj.opts = $.extend(true, obj.opts, { // Remove buttons infobar : 0, toolbar : 0, smallBtn : 0, // Disable keyboard navigation keyboard : 0, // Disable some modules slideShow : 0, fullScreen : 0, thumbs : 0, touch : 0, // Disable click event handlers clickContent : false, clickSlide : false, clickOutside : false, dblclickContent : false, dblclickSlide : false, dblclickOutside : false }); } // Step 4 - Add processed object to group // ====================================== self.group.push( obj ); }); }, // Attach an event handler functions for: // - navigation buttons // - browser scrolling, resizing; // - focusing // - keyboard // - detect idle // ====================================== addEvents : function() { var self = this; self.removeEvents(); // Make navigation elements clickable self.$refs.container.on('click.fb-close', '[data-fancybox-close]', function(e) { e.stopPropagation(); e.preventDefault(); self.close( e ); }).on( 'click.fb-prev touchend.fb-prev', '[data-fancybox-prev]', function(e) { e.stopPropagation(); e.preventDefault(); self.previous(); }).on( 'click.fb-next touchend.fb-next', '[data-fancybox-next]', function(e) { e.stopPropagation(); e.preventDefault(); self.next(); }).on( 'click.fb', '[data-fancybox-zoom]', function(e) { // Click handler for zoom button self[ self.isScaledDown() ? 'scaleToActual' : 'scaleToFit' ](); }); // Handle page scrolling and browser resizing $W.on('orientationchange.fb resize.fb', function(e) { if ( e && e.originalEvent && e.originalEvent.type === \"resize\" ) { requestAFrame(function() { self.update(); }); } else { self.$refs.stage.hide(); setTimeout(function() { self.$refs.stage.show(); self.update(); }, 600); } }); // Trap keyboard focus inside of the modal, so the user does not accidentally tab outside of the modal // (a.k.a. \"escaping the modal\") $D.on('focusin.fb', function(e) { var instance = $.fancybox ? $.fancybox.getInstance() : null; if ( instance.isClosing || !instance.current || !instance.current.opts.trapFocus || $( e.target ).hasClass( 'fancybox-container' ) || $( e.target ).is( document ) ) { return; } if ( instance && $( e.target ).css( 'position' ) !== 'fixed' && !instance.$refs.container.has( e.target ).length ) { e.stopPropagation(); instance.focus(); // Sometimes page gets scrolled, set it back $W.scrollTop( self.scrollTop ).scrollLeft( self.scrollLeft ); } }); // Enable keyboard navigation $D.on('keydown.fb', function (e) { var current = self.current, keycode = e.keyCode || e.which; if ( !current || !current.opts.keyboard ) { return; } if ( $(e.target).is('input') || $(e.target).is('textarea') ) { return; } // Backspace and Esc keys if ( keycode === 8 || keycode === 27 ) { e.preventDefault(); self.close( e ); return; } // Left arrow and Up arrow if ( keycode === 37 || keycode === 38 ) { e.preventDefault(); self.previous(); return; } // Righ arrow and Down arrow if ( keycode === 39 || keycode === 40 ) { e.preventDefault(); self.next(); return; } self.trigger('afterKeydown', e, keycode); }); // Hide controls after some inactivity period if ( self.group[ self.currIndex ].opts.idleTime ) { self.idleSecondsCounter = 0; $D.on('mousemove.fb-idle mouseleave.fb-idle mousedown.fb-idle touchstart.fb-idle touchmove.fb-idle scroll.fb-idle keydown.fb-idle', function(e) { self.idleSecondsCounter = 0; if ( self.isIdle ) { self.showControls(); } self.isIdle = false; }); self.idleInterval = window.setInterval(function() { self.idleSecondsCounter++; if ( self.idleSecondsCounter >= self.group[ self.currIndex ].opts.idleTime ) { self.isIdle = true; self.idleSecondsCounter = 0; self.hideControls(); } }, 1000); } }, // Remove events added by the core // =============================== removeEvents : function() { var self = this; $W.off( 'orientationchange.fb resize.fb' ); $D.off( 'focusin.fb keydown.fb .fb-idle' ); this.$refs.container.off( '.fb-close .fb-prev .fb-next' ); if ( self.idleInterval ) { window.clearInterval( self.idleInterval ); self.idleInterval = null; } }, // Change to previous gallery item // =============================== previous : function( duration ) { return this.jumpTo( this.currPos - 1, duration ); }, // Change to next gallery item // =========================== next : function( duration ) { return this.jumpTo( this.currPos + 1, duration ); }, // Switch to selected gallery item // =============================== jumpTo : function ( pos, duration, slide ) { var self = this, firstRun, loop, current, previous, canvasWidth, currentPos, transitionProps; var groupLen = self.group.length; if ( self.isSliding || self.isClosing || ( self.isAnimating && self.firstRun ) ) { return; } pos = parseInt( pos, 10 ); loop = self.current ? self.current.opts.loop : self.opts.loop; if ( !loop && ( pos < 0 || pos >= groupLen ) ) { return false; } firstRun = self.firstRun = ( self.firstRun === null ); if ( groupLen < 2 && !firstRun && !!self.isSliding ) { return; } previous = self.current; self.prevIndex = self.currIndex; self.prevPos = self.currPos; // Create slides current = self.createSlide( pos ); if ( groupLen > 1 ) { if ( loop || current.index > 0 ) { self.createSlide( pos - 1 ); } if ( loop || current.index < groupLen - 1 ) { self.createSlide( pos + 1 ); } } self.current = current; self.currIndex = current.index; self.currPos = current.pos; self.trigger( 'beforeShow', firstRun ); self.updateControls(); currentPos = $.fancybox.getTranslate( current.$slide ); current.isMoved = ( currentPos.left !== 0 || currentPos.top !== 0 ) && !current.$slide.hasClass( 'fancybox-animated' ); current.forcedDuration = undefined; if ( $.isNumeric( duration ) ) { current.forcedDuration = duration; } else { duration = current.opts[ firstRun ? 'animationDuration' : 'transitionDuration' ]; } duration = parseInt( duration, 10 ); // Fresh start - reveal container, current slide and start loading content if ( firstRun ) { if ( current.opts.animationEffect && duration ) { self.$refs.container.css( 'transition-duration', duration + 'ms' ); } self.$refs.container.removeClass( 'fancybox-is-hidden' ); forceRedraw( self.$refs.container ); self.$refs.container.addClass( 'fancybox-is-open' ); // Make first slide visible (to display loading icon, if needed) current.$slide.addClass( 'fancybox-slide--current' ); self.loadSlide( current ); self.preload(); return; } // Clean up $.each(self.slides, function( index, slide ) { $.fancybox.stop( slide.$slide ); }); // Make current that slide is visible even if content is still loading current.$slide.removeClass( 'fancybox-slide--next fancybox-slide--previous' ).addClass( 'fancybox-slide--current' ); // If slides have been dragged, animate them to correct position if ( current.isMoved ) { canvasWidth = Math.round( current.$slide.width() ); $.each(self.slides, function( index, slide ) { var pos = slide.pos - current.pos; $.fancybox.animate( slide.$slide, { top : 0, left : ( pos * canvasWidth ) + ( pos * slide.opts.gutter ) }, duration, function() { slide.$slide.removeAttr('style').removeClass( 'fancybox-slide--next fancybox-slide--previous' ); if ( slide.pos === self.currPos ) { current.isMoved = false; self.complete(); } }); }); } else { self.$refs.stage.children().removeAttr( 'style' ); } // Start transition that reveals current content // or wait when it will be loaded if ( current.isLoaded ) { self.revealContent( current ); } else { self.loadSlide( current ); } self.preload(); if ( previous.pos === current.pos ) { return; } // Handle previous slide // ===================== transitionProps = 'fancybox-slide--' + ( previous.pos > current.pos ? 'next' : 'previous' ); previous.$slide.removeClass( 'fancybox-slide--complete fancybox-slide--current fancybox-slide--next fancybox-slide--previous' ); previous.isComplete = false; if ( !duration || ( !current.isMoved && !current.opts.transitionEffect ) ) { return; } if ( current.isMoved ) { previous.$slide.addClass( transitionProps ); } else { transitionProps = 'fancybox-animated ' + transitionProps + ' fancybox-fx-' + current.opts.transitionEffect; $.fancybox.animate( previous.$slide, transitionProps, duration, function() { previous.$slide.removeClass( transitionProps ).removeAttr( 'style' ); }); } }, // Create new \"slide\" element // These are gallery items that are actually added to DOM // ======================================================= createSlide : function( pos ) { var self = this; var $slide; var index; index = pos % self.group.length; index = index < 0 ? self.group.length + index : index; if ( !self.slides[ pos ] && self.group[ index ] ) { $slide = $('').appendTo( self.$refs.stage ); self.slides[ pos ] = $.extend( true, {}, self.group[ index ], { pos : pos, $slide : $slide, isLoaded : false, }); self.updateSlide( self.slides[ pos ] ); } return self.slides[ pos ]; }, // Scale image to the actual size of the image // =========================================== scaleToActual : function( x, y, duration ) { var self = this; var current = self.current; var $what = current.$content; var imgPos, posX, posY, scaleX, scaleY; var canvasWidth = parseInt( current.$slide.width(), 10 ); var canvasHeight = parseInt( current.$slide.height(), 10 ); var newImgWidth = current.width; var newImgHeight = current.height; if ( !( current.type == 'image' && !current.hasError) || !$what || self.isAnimating ) { return; } $.fancybox.stop( $what ); self.isAnimating = true; x = x === undefined ? canvasWidth * 0.5 : x; y = y === undefined ? canvasHeight * 0.5 : y; imgPos = $.fancybox.getTranslate( $what ); scaleX = newImgWidth / imgPos.width; scaleY = newImgHeight / imgPos.height; // Get center position for original image posX = ( canvasWidth * 0.5 - newImgWidth * 0.5 ); posY = ( canvasHeight * 0.5 - newImgHeight * 0.5 ); // Make sure image does not move away from edges if ( newImgWidth > canvasWidth ) { posX = imgPos.left * scaleX - ( ( x * scaleX ) - x ); if ( posX > 0 ) { posX = 0; } if ( posX < canvasWidth - newImgWidth ) { posX = canvasWidth - newImgWidth; } } if ( newImgHeight > canvasHeight) { posY = imgPos.top * scaleY - ( ( y * scaleY ) - y ); if ( posY > 0 ) { posY = 0; } if ( posY < canvasHeight - newImgHeight ) { posY = canvasHeight - newImgHeight; } } self.updateCursor( newImgWidth, newImgHeight ); $.fancybox.animate( $what, { top : posY, left : posX, scaleX : scaleX, scaleY : scaleY }, duration || 330, function() { self.isAnimating = false; }); // Stop slideshow if ( self.SlideShow && self.SlideShow.isActive ) { self.SlideShow.stop(); } }, // Scale image to fit inside parent element // ======================================== scaleToFit : function( duration ) { var self = this; var current = self.current; var $what = current.$content; var end; if ( !( current.type == 'image' && !current.hasError) || !$what || self.isAnimating ) { return; } $.fancybox.stop( $what ); self.isAnimating = true; end = self.getFitPos( current ); self.updateCursor( end.width, end.height ); $.fancybox.animate( $what, { top : end.top, left : end.left, scaleX : end.width / $what.width(), scaleY : end.height / $what.height() }, duration || 330, function() { self.isAnimating = false; }); }, // Calculate image size to fit inside viewport // =========================================== getFitPos : function( slide ) { var self = this; var $what = slide.$content; var imgWidth = slide.width; var imgHeight = slide.height; var margin = slide.opts.margin; var canvasWidth, canvasHeight, minRatio, width, height; if ( !$what || !$what.length || ( !imgWidth && !imgHeight) ) { return false; } // Convert \"margin to CSS style: [ top, right, bottom, left ] if ( $.type( margin ) === \"number\" ) { margin = [ margin, margin ]; } if ( margin.length == 2 ) { margin = [ margin[0], margin[1], margin[0], margin[1] ]; } // We can not use $slide width here, because it can have different diemensions while in transiton canvasWidth = parseInt( self.$refs.stage.width(), 10 ) - ( margin[ 1 ] + margin[ 3 ] ); canvasHeight = parseInt( self.$refs.stage.height(), 10 ) - ( margin[ 0 ] + margin[ 2 ] ); minRatio = Math.min(1, canvasWidth / imgWidth, canvasHeight / imgHeight ); width = Math.floor( minRatio * imgWidth ); height = Math.floor( minRatio * imgHeight ); // Use floor rounding to make sure it really fits return { top : Math.floor( ( canvasHeight - height ) * 0.5 ) + margin[ 0 ], left : Math.floor( ( canvasWidth - width ) * 0.5 ) + margin[ 3 ], width : width, height : height }; }, // Update position and content of all slides // ========================================= update : function() { var self = this; $.each( self.slides, function( key, slide ) { self.updateSlide( slide ); }); }, // Update slide position and scale content to fit // ============================================== updateSlide : function( slide ) { var self = this; var $what = slide.$content; if ( $what && ( slide.width || slide.height ) ) { self.isAnimating = false; $.fancybox.stop( $what ); $.fancybox.setTranslate( $what, self.getFitPos( slide ) ); if ( slide.pos === self.currPos ) { self.updateCursor(); } } slide.$slide.trigger( 'refresh' ); self.trigger( 'onUpdate', slide ); }, // Update cursor style depending if content can be zoomed // ====================================================== updateCursor : function( nextWidth, nextHeight ) { var self = this; var isScaledDown; var $container = self.$refs.container.removeClass( 'fancybox-is-zoomable fancybox-can-zoomIn fancybox-can-drag fancybox-can-zoomOut' ); if ( !self.current || self.isClosing ) { return; } if ( self.isZoomable() ) { $container.addClass( 'fancybox-is-zoomable' ); if ( nextWidth !== undefined && nextHeight !== undefined ) { isScaledDown = nextWidth < self.current.width && nextHeight < self.current.height; } else { isScaledDown = self.isScaledDown(); } if ( isScaledDown ) { // If image is scaled down, then, obviously, it can be zoomed to full size $container.addClass( 'fancybox-can-zoomIn' ); } else { if ( self.current.opts.touch ) { // If image size ir largen than available available and touch module is not disable, // then user can do panning $container.addClass( 'fancybox-can-drag' ); } else { $container.addClass( 'fancybox-can-zoomOut' ); } } } else if ( self.current.opts.touch ) { $container.addClass( 'fancybox-can-drag' ); } }, // Check if current slide is zoomable // ================================== isZoomable : function() { var self = this; var current = self.current; var fitPos; if ( !current || self.isClosing ) { return; } // Assume that slide is zoomable if // - image is loaded successfuly // - click action is \"zoom\" // - actual size of the image is smaller than available area if ( current.type === 'image' && current.isLoaded && !current.hasError && ( current.opts.clickContent === 'zoom' || ( $.isFunction( current.opts.clickContent ) && current.opts.clickContent( current ) === \"zoom\" ) ) ) { fitPos = self.getFitPos( current ); if ( current.width > fitPos.width || current.height > fitPos.height ) { return true; } } return false; }, // Check if current image dimensions are smaller than actual // ========================================================= isScaledDown : function() { var self = this; var current = self.current; var $what = current.$content; var rez = false; if ( $what ) { rez = $.fancybox.getTranslate( $what ); rez = rez.width < current.width || rez.height < current.height; } return rez; }, // Check if image dimensions exceed parent element // =============================================== canPan : function() { var self = this; var current = self.current; var $what = current.$content; var rez = false; if ( $what ) { rez = self.getFitPos( current ); rez = Math.abs( $what.width() - rez.width ) > 1 || Math.abs( $what.height() - rez.height ) > 1; } return rez; }, // Load content into the slide // =========================== loadSlide : function( slide ) { var self = this, type, $slide; var ajaxLoad; if ( slide.isLoading ) { return; } if ( slide.isLoaded ) { return; } slide.isLoading = true; self.trigger( 'beforeLoad', slide ); type = slide.type; $slide = slide.$slide; $slide .off( 'refresh' ) .trigger( 'onReset' ) .addClass( 'fancybox-slide--' + ( type || 'unknown' ) ) .addClass( slide.opts.slideClass ); // Create content depending on the type switch ( type ) { case 'image': self.setImage( slide ); break; case 'iframe': self.setIframe( slide ); break; case 'html': self.setContent( slide, slide.src || slide.content ); break; case 'inline': if ( $( slide.src ).length ) { self.setContent( slide, $( slide.src ) ); } else { self.setError( slide ); } break; case 'ajax': self.showLoading( slide ); ajaxLoad = $.ajax( $.extend( {}, slide.opts.ajax.settings, { url : slide.src, success : function ( data, textStatus ) { if ( textStatus === 'success' ) { self.setContent( slide, data ); } }, error : function ( jqXHR, textStatus ) { if ( jqXHR && textStatus !== 'abort' ) { self.setError( slide ); } } })); $slide.one( 'onReset', function () { ajaxLoad.abort(); }); break; default: self.setError( slide ); break; } return true; }, // Use thumbnail image, if possible // ================================ setImage : function( slide ) { var self = this; var srcset = slide.opts.srcset || slide.opts.image.srcset; var found, temp, pxRatio, windowWidth; // If we have \"srcset\", then we need to find matching \"src\" value. // This is necessary, because when you set an src attribute, the browser will preload the image // before any javascript or even CSS is applied. if ( srcset ) { pxRatio = window.devicePixelRatio || 1; windowWidth = window.innerWidth * pxRatio; temp = srcset.split(',').map(function ( el ) { var ret = {}; el.trim().split(/\\s+/).forEach(function ( el, i ) { var value = parseInt( el.substring(0, el.length - 1), 10 ); if ( i === 0 ) { return ( ret.url = el ); } if ( value ) { ret.value = value; ret.postfix = el[ el.length - 1 ]; } }); return ret; }); // Sort by value temp.sort(function (a, b) { return a.value - b.value; }); // Ok, now we have an array of all srcset values for ( var j = 0; j < temp.length; j++ ) { var el = temp[ j ]; if ( ( el.postfix === 'w' && el.value >= windowWidth ) || ( el.postfix === 'x' && el.value >= pxRatio ) ) { found = el; break; } } // If not found, take the last one if ( !found && temp.length ) { found = temp[ temp.length - 1 ]; } if ( found ) { slide.src = found.url; // If we have default width/height values, we can calculate height for matching source if ( slide.width && slide.height && found.postfix == 'w' ) { slide.height = ( slide.width / slide.height ) * found.value; slide.width = found.value; } } } // This will be wrapper containing both ghost and actual image slide.$content = $('') .addClass( 'fancybox-is-hidden' ) .appendTo( slide.$slide ); // If we have a thumbnail, we can display it while actual image is loading // Users will not stare at black screen and actual image will appear gradually if ( slide.opts.preload !== false && slide.opts.width && slide.opts.height && ( slide.opts.thumb || slide.opts.$thumb ) ) { slide.width = slide.opts.width; slide.height = slide.opts.height; slide.$ghost = $('') .one('error', function() { $(this).remove(); slide.$ghost = null; self.setBigImage( slide ); }) .one('load', function() { self.afterLoad( slide ); self.setBigImage( slide ); }) .addClass( 'fancybox-image' ) .appendTo( slide.$content ) .attr( 'src', slide.opts.thumb || slide.opts.$thumb.attr( 'src' ) ); } else { self.setBigImage( slide ); } }, // Create full-size image // ====================== setBigImage : function ( slide ) { var self = this; var $img = $(''); slide.$image = $img .one('error', function() { self.setError( slide ); }) .one('load', function() { // Clear timeout that checks if loading icon needs to be displayed clearTimeout( slide.timouts ); slide.timouts = null; if ( self.isClosing ) { return; } slide.width = this.naturalWidth; slide.height = this.naturalHeight; if ( slide.opts.image.srcset ) { $img.attr( 'sizes', '100vw' ).attr( 'srcset', slide.opts.image.srcset ); } self.hideLoading( slide ); if ( slide.$ghost ) { slide.timouts = setTimeout(function() { slide.timouts = null; slide.$ghost.hide(); }, Math.min( 300, Math.max( 1000, slide.height / 1600 ) ) ); } else { self.afterLoad( slide ); } }) .addClass( 'fancybox-image' ) .attr('src', slide.src) .appendTo( slide.$content ); if ( ( $img[0].complete || $img[0].readyState == \"complete\" ) && $img[0].naturalWidth && $img[0].naturalHeight ) { $img.trigger( 'load' ); } else if( $img[0].error ) { $img.trigger( 'error' ); } else { slide.timouts = setTimeout(function() { if ( !$img[0].complete && !slide.hasError ) { self.showLoading( slide ); } }, 100); } }, // Create iframe wrapper, iframe and bindings // ========================================== setIframe : function( slide ) { var self = this, opts = slide.opts.iframe, $slide = slide.$slide, $iframe; slide.$content = $('') .css( opts.css ) .appendTo( $slide ); $iframe = $( opts.tpl.replace(/\\{rnd\\}/g, new Date().getTime()) ) .attr( opts.attr ) .appendTo( slide.$content ); if ( opts.preload ) { self.showLoading( slide ); // Unfortunately, it is not always possible to determine if iframe is successfully loaded // (due to browser security policy) $iframe.on('load.fb error.fb', function(e) { this.isReady = 1; slide.$slide.trigger( 'refresh' ); self.afterLoad( slide ); }); // Recalculate iframe content size // =============================== $slide.on('refresh.fb', function() { var $wrap = slide.$content, frameWidth = opts.css.width, frameHeight = opts.css.height, scrollWidth, $contents, $body; if ( $iframe[0].isReady !== 1 ) { return; } // Check if content is accessible, // it will fail if frame is not with the same origin try { $contents = $iframe.contents(); $body = $contents.find('body'); } catch (ignore) {} // Calculate dimensions for the wrapper if ( $body && $body.length ) { if ( frameWidth === undefined ) { scrollWidth = $iframe[0].contentWindow.document.documentElement.scrollWidth; frameWidth = Math.ceil( $body.outerWidth(true) + ( $wrap.width() - scrollWidth ) ); frameWidth += $wrap.outerWidth() - $wrap.innerWidth(); } if ( frameHeight === undefined ) { frameHeight = Math.ceil( $body.outerHeight(true) ); frameHeight += $wrap.outerHeight() - $wrap.innerHeight(); } // Resize wrapper to fit iframe content if ( frameWidth ) { $wrap.width( frameWidth ); } if ( frameHeight ) { $wrap.height( frameHeight ); } } $wrap.removeClass( 'fancybox-is-hidden' ); }); } else { this.afterLoad( slide ); } $iframe.attr( 'src', slide.src ); if ( slide.opts.smallBtn === true ) { slide.$content.prepend( self.translate( slide, slide.opts.btnTpl.smallBtn ) ); } // Remove iframe if closing or changing gallery item $slide.one( 'onReset', function () { // This helps IE not to throw errors when closing try { $( this ).find( 'iframe' ).hide().attr( 'src', '//about:blank' ); } catch ( ignore ) {} $( this ).empty(); slide.isLoaded = false; }); }, // Wrap and append content to the slide // ====================================== setContent : function ( slide, content ) { var self = this; if ( self.isClosing ) { return; } self.hideLoading( slide ); slide.$slide.empty(); if ( isQuery( content ) && content.parent().length ) { // If content is a jQuery object, then it will be moved to the slide. // The placeholder is created so we will know where to put it back. // If user is navigating gallery fast, then the content might be already inside fancyBox // ===================================================================================== // Make sure content is not already moved to fancyBox content.parent( '.fancybox-slide--inline' ).trigger( 'onReset' ); // Create temporary element marking original place of the content slide.$placeholder = $( '' ).hide().insertAfter( content ); // Make sure content is visible content.css('display', 'inline-block'); } else if ( !slide.hasError ) { // If content is just a plain text, try to convert it to html if ( $.type( content ) === 'string' ) { content = $('').append( $.trim( content ) ).contents(); // If we have text node, then add wrapping element to make vertical alignment work if ( content[0].nodeType === 3 ) { content = $('').html( content ); } } // If \"filter\" option is provided, then filter content if ( slide.opts.filter ) { content = $('').html( content ).find( slide.opts.filter ); } } slide.$slide.one('onReset', function () { // Put content back if ( slide.$placeholder ) { slide.$placeholder.after( content.hide() ).remove(); slide.$placeholder = null; } // Remove custom close button if ( slide.$smallBtn ) { slide.$smallBtn.remove(); slide.$smallBtn = null; } // Remove content and mark slide as not loaded if ( !slide.hasError ) { $(this).empty(); slide.isLoaded = false; } }); slide.$content = $( content ).appendTo( slide.$slide ); this.afterLoad( slide ); }, // Display error message // ===================== setError : function ( slide ) { slide.hasError = true; slide.$slide.removeClass( 'fancybox-slide--' + slide.type ); this.setContent( slide, this.translate( slide, slide.opts.errorTpl ) ); }, // Show loading icon inside the slide // ================================== showLoading : function( slide ) { var self = this; slide = slide || self.current; if ( slide && !slide.$spinner ) { slide.$spinner = $( self.opts.spinnerTpl ).appendTo( slide.$slide ); } }, // Remove loading icon from the slide // ================================== hideLoading : function( slide ) { var self = this; slide = slide || self.current; if ( slide && slide.$spinner ) { slide.$spinner.remove(); delete slide.$spinner; } }, // Adjustments after slide content has been loaded // =============================================== afterLoad : function( slide ) { var self = this; if ( self.isClosing ) { return; } slide.isLoading = false; slide.isLoaded = true; self.trigger( 'afterLoad', slide ); self.hideLoading( slide ); if ( slide.opts.smallBtn && !slide.$smallBtn ) { slide.$smallBtn = $( self.translate( slide, slide.opts.btnTpl.smallBtn ) ).appendTo( slide.$content.filter('div,form').first() ); } if ( slide.opts.protect && slide.$content && !slide.hasError ) { // Disable right click slide.$content.on( 'contextmenu.fb', function( e ) { if ( e.button == 2 ) { e.preventDefault(); } return true; }); // Add fake element on top of the image // This makes a bit harder for user to select image if ( slide.type === 'image' ) { $( '' ).appendTo( slide.$content ); } } self.revealContent( slide ); }, // Make content visible // This method is called right after content has been loaded or // user navigates gallery and transition should start // ============================================================ revealContent : function( slide ) { var self = this; var $slide = slide.$slide; var effect, effectClassName, duration, opacity, end, start = false; effect = slide.opts[ self.firstRun ? 'animationEffect' : 'transitionEffect' ]; duration = slide.opts[ self.firstRun ? 'animationDuration' : 'transitionDuration' ]; duration = parseInt( slide.forcedDuration === undefined ? duration : slide.forcedDuration, 10 ); if ( slide.isMoved || slide.pos !== self.currPos || !duration ) { effect = false; } // Check if can zoom if ( effect === 'zoom' && !( slide.pos === self.currPos && duration && slide.type === 'image' && !slide.hasError && ( start = self.getThumbPos( slide ) ) ) ) { effect = 'fade'; } // Zoom animation // ============== if ( effect === 'zoom' ) { end = self.getFitPos( slide ); end.scaleX = end.width / start.width; end.scaleY = end.height / start.height; delete end.width; delete end.height; // Check if we need to animate opacity opacity = slide.opts.zoomOpacity; if ( opacity == 'auto' ) { opacity = Math.abs( slide.width / slide.height - start.width / start.height ) > 0.1; } if ( opacity ) { start.opacity = 0.1; end.opacity = 1; } // Draw image at start position $.fancybox.setTranslate( slide.$content.removeClass( 'fancybox-is-hidden' ), start ); forceRedraw( slide.$content ); // Start animation $.fancybox.animate( slide.$content, end, duration, function() { self.complete(); }); return; } self.updateSlide( slide ); // Simply show content // =================== if ( !effect ) { forceRedraw( $slide ); slide.$content.removeClass( 'fancybox-is-hidden' ); if ( slide.pos === self.currPos ) { self.complete(); } return; } $.fancybox.stop( $slide ); effectClassName = 'fancybox-animated fancybox-slide--' + ( slide.pos >= self.prevPos ? 'next' : 'previous' ) + ' fancybox-fx-' + effect; $slide.removeAttr( 'style' ).removeClass( 'fancybox-slide--current fancybox-slide--next fancybox-slide--previous' ).addClass( effectClassName ); slide.$content.removeClass( 'fancybox-is-hidden' ); //Force reflow for CSS3 transitions forceRedraw( $slide ); $.fancybox.animate( $slide, 'fancybox-slide--current', duration, function(e) { $slide.removeClass( effectClassName ).removeAttr( 'style' ); if ( slide.pos === self.currPos ) { self.complete(); } }, true); }, // Check if we can and have to zoom from thumbnail //================================================ getThumbPos : function( slide ) { var self = this; var rez = false; // Check if element is inside the viewport by at least 1 pixel var isElementVisible = function( $el ) { var element = $el[0]; var elementRect = element.getBoundingClientRect(); var parentRects = []; var visibleInAllParents; while ( element.parentElement !== null ) { if ( $(element.parentElement).css('overflow') === 'hidden' || $(element.parentElement).css('overflow') === 'auto' ) { parentRects.push(element.parentElement.getBoundingClientRect()); } element = element.parentElement; } visibleInAllParents = parentRects.every(function(parentRect){ var visiblePixelX = Math.min(elementRect.right, parentRect.right) - Math.max(elementRect.left, parentRect.left); var visiblePixelY = Math.min(elementRect.bottom, parentRect.bottom) - Math.max(elementRect.top, parentRect.top); return visiblePixelX > 0 && visiblePixelY > 0; }); return visibleInAllParents && elementRect.bottom > 0 && elementRect.right > 0 && elementRect.left < $(window).width() && elementRect.top < $(window).height(); }; var $thumb = slide.opts.$thumb; var thumbPos = $thumb ? $thumb.offset() : 0; var slidePos; if ( thumbPos && $thumb[0].ownerDocument === document && isElementVisible( $thumb ) ) { slidePos = self.$refs.stage.offset(); rez = { top : thumbPos.top - slidePos.top + parseFloat( $thumb.css( \"border-top-width\" ) || 0 ), left : thumbPos.left - slidePos.left + parseFloat( $thumb.css( \"border-left-width\" ) || 0 ), width : $thumb.width(), height : $thumb.height(), scaleX : 1, scaleY : 1 }; } return rez; }, // Final adjustments after current gallery item is moved to position // and it`s content is loaded // ================================================================== complete : function() { var self = this; var current = self.current; var slides = {}; if ( current.isMoved || !current.isLoaded || current.isComplete ) { return; } current.isComplete = true; current.$slide.siblings().trigger( 'onReset' ); // Trigger any CSS3 transiton inside the slide forceRedraw( current.$slide ); current.$slide.addClass( 'fancybox-slide--complete' ); // Remove unnecessary slides $.each( self.slides, function( key, slide ) { if ( slide.pos >= self.currPos - 1 && slide.pos 1 ) ) .toggleClass( 'fancybox-show-nav', !!( opts.arrows && self.group.length > 1 ) ) .toggleClass( 'fancybox-is-modal', !!opts.modal ); if ( self.$caption ) { $container.addClass( 'fancybox-show-caption '); } else { $container.removeClass( 'fancybox-show-caption' ); } }, // Toggle toolbar and caption // ========================== toggleControls : function() { if ( this.isHiddenControls ) { this.showControls(); } else { this.hideControls(); } }, }); $.fancybox = { version : \"3.2.5\", defaults : defaults, // Get current instance and execute a command. // // Examples of usage: // // $instance = $.fancybox.getInstance(); // $.fancybox.getInstance().jumpTo( 1 ); // $.fancybox.getInstance( 'jumpTo', 1 ); // $.fancybox.getInstance( function() { // console.info( this.currIndex ); // }); // ====================================================== getInstance : function ( command ) { var instance = $('.fancybox-container:not(\".fancybox-is-closing\"):last').data( 'FancyBox' ); var args = Array.prototype.slice.call(arguments, 1); if ( instance instanceof FancyBox ) { if ( $.type( command ) === 'string' ) { instance[ command ].apply( instance, args ); } else if ( $.type( command ) === 'function' ) { command.apply( instance, args ); } return instance; } return false; }, // Create new instance // =================== open : function ( items, opts, index ) { return new FancyBox( items, opts, index ); }, // Close current or all instances // ============================== close : function ( all ) { var instance = this.getInstance(); if ( instance ) { instance.close(); // Try to find and close next instance if ( all === true ) { this.close(); } } }, // Close instances and unbind all events // ============================== destroy : function() { this.close( true ); $D.off( 'click.fb-start' ); }, // Try to detect mobile devices // ============================ isMobile : document.createTouch !== undefined && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent), // Detect if 'translate3d' support is available // ============================================ use3d : (function() { var div = document.createElement('div'); return window.getComputedStyle && window.getComputedStyle( div ).getPropertyValue('transform') && !(document.documentMode && document.documentMode < 11); }()), // Helper function to get current visual state of an element // returns array[ top, left, horizontal-scale, vertical-scale, opacity ] // ===================================================================== getTranslate : function( $el ) { var matrix; if ( !$el || !$el.length ) { return false; } matrix = $el.eq( 0 ).css('transform'); if ( matrix && matrix.indexOf( 'matrix' ) !== -1 ) { matrix = matrix.split('(')[1]; matrix = matrix.split(')')[0]; matrix = matrix.split(','); } else { matrix = []; } if ( matrix.length ) { // If IE if ( matrix.length > 10 ) { matrix = [ matrix[13], matrix[12], matrix[0], matrix[5] ]; } else { matrix = [ matrix[5], matrix[4], matrix[0], matrix[3]]; } matrix = matrix.map(parseFloat); } else { matrix = [ 0, 0, 1, 1 ]; var transRegex = /\\.*translate\\((.*)px,(.*)px\\)/i; var transRez = transRegex.exec( $el.eq( 0 ).attr('style') ); if ( transRez ) { matrix[ 0 ] = parseFloat( transRez[2] ); matrix[ 1 ] = parseFloat( transRez[1] ); } } return { top : matrix[ 0 ], left : matrix[ 1 ], scaleX : matrix[ 2 ], scaleY : matrix[ 3 ], opacity : parseFloat( $el.css('opacity') ), width : $el.width(), height : $el.height() }; }, // Shortcut for setting \"translate3d\" properties for element // Can set be used to set opacity, too // ======================================================== setTranslate : function( $el, props ) { var str = ''; var css = {}; if ( !$el || !props ) { return; } if ( props.left !== undefined || props.top !== undefined ) { str = ( props.left === undefined ? $el.position().left : props.left ) + 'px, ' + ( props.top === undefined ? $el.position().top : props.top ) + 'px'; if ( this.use3d ) { str = 'translate3d(' + str + ', 0px)'; } else { str = 'translate(' + str + ')'; } } if ( props.scaleX !== undefined && props.scaleY !== undefined ) { str = (str.length ? str + ' ' : '') + 'scale(' + props.scaleX + ', ' + props.scaleY + ')'; } if ( str.length ) { css.transform = str; } if ( props.opacity !== undefined ) { css.opacity = props.opacity; } if ( props.width !== undefined ) { css.width = props.width; } if ( props.height !== undefined ) { css.height = props.height; } return $el.css( css ); }, // Simple CSS transition handler // ============================= animate : function ( $el, to, duration, callback, leaveAnimationName ) { if ( $.isFunction( duration ) ) { callback = duration; duration = null; } if ( !$.isPlainObject( to ) ) { $el.removeAttr('style'); } $el.on( transitionEnd, function(e) { // Skip events from child elements and z-index change if ( e && e.originalEvent && ( !$el.is( e.originalEvent.target ) || e.originalEvent.propertyName == 'z-index' ) ) { return; } $.fancybox.stop( $el ); if ( $.isPlainObject( to ) ) { if ( to.scaleX !== undefined && to.scaleY !== undefined ) { $el.css( 'transition-duration', '' ); to.width = Math.round( $el.width() * to.scaleX ); to.height = Math.round( $el.height() * to.scaleY ); to.scaleX = 1; to.scaleY = 1; $.fancybox.setTranslate( $el, to ); } } else if ( leaveAnimationName !== true ) { $el.removeClass( to ); } if ( $.isFunction( callback ) ) { callback( e ); } }); if ( $.isNumeric( duration ) ) { $el.css( 'transition-duration', duration + 'ms' ); } if ( $.isPlainObject( to ) ) { $.fancybox.setTranslate( $el, to ); } else { $el.addClass( to ); } if ( to.scaleX && $el.hasClass( 'fancybox-image-wrap' ) ) { $el.parent().addClass( 'fancybox-is-scaling' ); } // Make sure that `transitionend` callback gets fired $el.data(\"timer\", setTimeout(function() { $el.trigger( 'transitionend' ); }, duration + 16)); }, stop : function( $el ) { clearTimeout( $el.data(\"timer\") ); $el.off( 'transitionend' ).css( 'transition-duration', '' ); if ( $el.hasClass( 'fancybox-image-wrap' ) ) { $el.parent().removeClass( 'fancybox-is-scaling' ); } } }; // Default click handler for \"fancyboxed\" links // ============================================ function _run( e ) { var $target = $( e.currentTarget ), opts = e.data ? e.data.options : {}, value = $target.attr( 'data-fancybox' ) || '', index = 0, items = []; // Avoid opening multiple times if ( e.isDefaultPrevented() ) { return; } e.preventDefault(); // Get all related items and find index for clicked one if ( value ) { items = opts.selector ? $( opts.selector ) : ( e.data ? e.data.items : [] ); items = items.length ? items.filter( '[data-fancybox=\"' + value + '\"]' ) : $( '[data-fancybox=\"' + value + '\"]' ); index = items.index( $target ); // Sometimes current item can not be found // (for example, when slider clones items) if ( index < 0 ) { index = 0; } } else { items = [ $target ]; } $.fancybox.open( items, opts, index ); } // Create a jQuery plugin // ====================== $.fn.fancybox = function (options) { var selector; options = options || {}; selector = options.selector || false; if ( selector ) { $( 'body' ).off( 'click.fb-start', selector ).on( 'click.fb-start', selector, { options : options }, _run ); } else { this.off( 'click.fb-start' ).on( 'click.fb-start', { items : this, options : options }, _run); } return this; }; // Self initializing plugin // ======================== $D.on( 'click.fb-start', '[data-fancybox]', _run ); }( window, document, window.jQuery || jQuery )); // ========================================================================== // // Media // Adds additional media type support // // ========================================================================== ;(function ($) { 'use strict'; // Formats matching url to final form var format = function (url, rez, params) { if ( !url ) { return; } params = params || ''; if ( $.type(params) === \"object\" ) { params = $.param(params, true); } $.each(rez, function (key, value) { url = url.replace('$' + key, value || ''); }); if (params.length) { url += (url.indexOf('?') > 0 ? '&' : '?') + params; } return url; }; // Object containing properties for each media type var defaults = { youtube : { matcher : /(youtube\\.com|youtu\\.be|youtube\\-nocookie\\.com)\\/(watch\\?(.*&)?v=|v\\/|u\\/|embed\\/?)?(videoseries\\?list=(.*)|[\\w-]{11}|\\?listType=(.*)&list=(.*))(.*)/i, params : { autoplay : 1, autohide : 1, fs : 1, rel : 0, hd : 1, wmode : 'transparent', enablejsapi : 1, html5 : 1 }, paramPlace : 8, type : 'iframe', url : '//www.youtube.com/embed/$4', thumb : '//img.youtube.com/vi/$4/hqdefault.jpg' }, vimeo : { matcher : /^.+vimeo.com\\/(.*\\/)?([\\d]+)(.*)?/, params : { autoplay : 1, hd : 1, show_title : 1, show_byline : 1, show_portrait : 0, fullscreen : 1, api : 1 }, paramPlace : 3, type : 'iframe', url : '//player.vimeo.com/video/$2' }, metacafe : { matcher : /metacafe.com\\/watch\\/(\\d+)\\/(.*)?/, type : 'iframe', url : '//www.metacafe.com/embed/$1/?ap=1' }, dailymotion : { matcher : /dailymotion.com\\/video\\/(.*)\\/?(.*)/, params : { additionalInfos : 0, autoStart : 1 }, type : 'iframe', url : '//www.dailymotion.com/embed/video/$1' }, vine : { matcher : /vine.co\\/v\\/([a-zA-Z0-9\\?\\=\\-]+)/, type : 'iframe', url : '//vine.co/v/$1/embed/simple' }, instagram : { matcher : /(instagr\\.am|instagram\\.com)\\/p\\/([a-zA-Z0-9_\\-]+)\\/?/i, type : 'image', url : '//$1/p/$2/media/?size=l' }, // Examples: // http://maps.google.com/?ll=48.857995,2.294297&spn=0.007666,0.021136&t=m&z=16 // https://www.google.com/maps/@37.7852006,-122.4146355,14.65z // https://www.google.com/maps/place/Googleplex/@37.4220041,-122.0833494,17z/data=!4m5!3m4!1s0x0:0x6c296c66619367e0!8m2!3d37.4219998!4d-122.0840572 gmap_place : { matcher : /(maps\\.)?google\\.([a-z]{2,3}(\\.[a-z]{2})?)\\/(((maps\\/(place\\/(.*)\\/)?\\@(.*),(\\d+.?\\d+?)z))|(\\?ll=))(.*)?/i, type : 'iframe', url : function (rez) { return '//maps.google.' + rez[2] + '/?ll=' + ( rez[9] ? rez[9] + '&z=' + Math.floor( rez[10] ) + ( rez[12] ? rez[12].replace(/^\\//, \"&\") : '' ) : rez[12] ) + '&output=' + ( rez[12] && rez[12].indexOf('layer=c') > 0 ? 'svembed' : 'embed' ); } }, // Examples: // https://www.google.com/maps/search/Empire+State+Building/ // https://www.google.com/maps/search/?api=1&query=centurylink+field // https://www.google.com/maps/search/?api=1&query=47.5951518,-122.3316393 gmap_search : { matcher : /(maps\\.)?google\\.([a-z]{2,3}(\\.[a-z]{2})?)\\/(maps\\/search\\/)(.*)/i, type : 'iframe', url : function (rez) { return '//maps.google.' + rez[2] + '/maps?q=' + rez[5].replace('query=', 'q=').replace('api=1', '') + '&output=embed'; } } }; $(document).on('objectNeedsType.fb', function (e, instance, item) { var url = item.src || '', type = false, media, thumb, rez, params, urlParams, paramObj, provider; media = $.extend( true, {}, defaults, item.opts.media ); // Look for any matching media type $.each(media, function ( providerName, providerOpts ) { rez = url.match( providerOpts.matcher ); if ( !rez ) { return; } type = providerOpts.type; paramObj = {}; if ( providerOpts.paramPlace && rez[ providerOpts.paramPlace ] ) { urlParams = rez[ providerOpts.paramPlace ]; if ( urlParams[ 0 ] == '?' ) { urlParams = urlParams.substring(1); } urlParams = urlParams.split('&'); for ( var m = 0; m < urlParams.length; ++m ) { var p = urlParams[ m ].split('=', 2); if ( p.length == 2 ) { paramObj[ p[0] ] = decodeURIComponent( p[1].replace(/\\+/g, \" \") ); } } } params = $.extend( true, {}, providerOpts.params, item.opts[ providerName ], paramObj ); url = $.type( providerOpts.url ) === \"function\" ? providerOpts.url.call( this, rez, params, item ) : format( providerOpts.url, rez, params ); thumb = $.type( providerOpts.thumb ) === \"function\" ? providerOpts.thumb.call( this, rez, params, item ) : format( providerOpts.thumb, rez ); if ( providerName === 'vimeo' ) { url = url.replace('&%23', '#'); } return false; }); // If it is found, then change content type and update the url if ( type ) { item.src = url; item.type = type; if ( !item.opts.thumb && !( item.opts.$thumb && item.opts.$thumb.length ) ) { item.opts.thumb = thumb; } if ( type === 'iframe' ) { $.extend(true, item.opts, { iframe : { preload : false, attr : { scrolling : \"no\" } } }); item.contentProvider = provider; item.opts.slideClass += ' fancybox-slide--' + ( provider == 'gmap_place' || provider == 'gmap_search' ? 'map' : 'video' ); } } else if ( url ) { item.type = item.opts.defaultType; } }); }( window.jQuery || jQuery )); // ========================================================================== // // Guestures // Adds touch guestures, handles click and tap events // // ========================================================================== ;(function (window, document, $) { 'use strict'; var requestAFrame = (function () { return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || // if all else fails, use setTimeout function (callback) { return window.setTimeout(callback, 1000 / 60); }; })(); var cancelAFrame = (function () { return window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.oCancelAnimationFrame || function (id) { window.clearTimeout(id); }; })(); var pointers = function( e ) { var result = []; e = e.originalEvent || e || window.e; e = e.touches && e.touches.length ? e.touches : ( e.changedTouches && e.changedTouches.length ? e.changedTouches : [ e ] ); for ( var key in e ) { if ( e[ key ].pageX ) { result.push( { x : e[ key ].pageX, y : e[ key ].pageY } ); } else if ( e[ key ].clientX ) { result.push( { x : e[ key ].clientX, y : e[ key ].clientY } ); } } return result; }; var distance = function( point2, point1, what ) { if ( !point1 || !point2 ) { return 0; } if ( what === 'x' ) { return point2.x - point1.x; } else if ( what === 'y' ) { return point2.y - point1.y; } return Math.sqrt( Math.pow( point2.x - point1.x, 2 ) + Math.pow( point2.y - point1.y, 2 ) ); }; var isClickable = function( $el ) { if ( $el.is('a,area,button,[role=\"button\"],input,label,select,summary,textarea') || $.isFunction( $el.get(0).onclick ) || $el.data('selectable') ) { return true; } // Check for attributes like data-fancybox-next or data-fancybox-close for ( var i = 0, atts = $el[0].attributes, n = atts.length; i < n; i++ ) { if ( atts[i].nodeName.substr(0, 14) === 'data-fancybox-' ) { return true; } } return false; }; var hasScrollbars = function( el ) { var overflowY = window.getComputedStyle( el )['overflow-y']; var overflowX = window.getComputedStyle( el )['overflow-x']; var vertical = (overflowY === 'scroll' || overflowY === 'auto') && el.scrollHeight > el.clientHeight; var horizontal = (overflowX === 'scroll' || overflowX === 'auto') && el.scrollWidth > el.clientWidth; return vertical || horizontal; }; var isScrollable = function ( $el ) { var rez = false; while ( true ) { rez = hasScrollbars( $el.get(0) ); if ( rez ) { break; } $el = $el.parent(); if ( !$el.length || $el.hasClass( 'fancybox-stage' ) || $el.is( 'body' ) ) { break; } } return rez; }; var Guestures = function ( instance ) { var self = this; self.instance = instance; self.$bg = instance.$refs.bg; self.$stage = instance.$refs.stage; self.$container = instance.$refs.container; self.destroy(); self.$container.on( 'touchstart.fb.touch mousedown.fb.touch', $.proxy(self, 'ontouchstart') ); }; Guestures.prototype.destroy = function() { this.$container.off( '.fb.touch' ); }; Guestures.prototype.ontouchstart = function( e ) { var self = this; var $target = $( e.target ); var instance = self.instance; var current = instance.current; var $content = current.$content; var isTouchDevice = ( e.type == 'touchstart' ); // Do not respond to both events if ( isTouchDevice ) { self.$container.off( 'mousedown.fb.touch' ); } // Ignore clicks while zooming or closing if ( !current || self.instance.isAnimating || self.instance.isClosing ) { e.stopPropagation(); e.preventDefault(); return; } // Ignore right click if ( e.originalEvent && e.originalEvent.button == 2 ) { return; } // Ignore taping on links, buttons, input elements if ( !$target.length || isClickable( $target ) || isClickable( $target.parent() ) ) { return; } // Ignore clicks on the scrollbar if ( e.originalEvent.clientX > $target[0].clientWidth + $target.offset().left ) { return; } self.startPoints = pointers( e ); // Prevent zooming if already swiping if ( !self.startPoints || ( self.startPoints.length > 1 && instance.isSliding ) ) { return; } self.$target = $target; self.$content = $content; self.canTap = true; self.opts = current.opts.touch; $(document).off( '.fb.touch' ); $(document).on( isTouchDevice ? 'touchend.fb.touch touchcancel.fb.touch' : 'mouseup.fb.touch mouseleave.fb.touch', $.proxy(self, \"ontouchend\")); $(document).on( isTouchDevice ? 'touchmove.fb.touch' : 'mousemove.fb.touch', $.proxy(self, \"ontouchmove\")); if ( !(self.opts || instance.canPan() ) || !( $target.is( self.$stage ) || self.$stage.find( $target ).length ) ) { // Prevent ghosting if ( $target.is('img') ) { e.preventDefault(); } return; } e.stopPropagation(); if ( !( $.fancybox.isMobile && ( isScrollable( self.$target ) || isScrollable( self.$target.parent() ) ) ) ) { e.preventDefault(); } self.canvasWidth = Math.round( current.$slide[0].clientWidth ); self.canvasHeight = Math.round( current.$slide[0].clientHeight ); self.startTime = new Date().getTime(); self.distanceX = self.distanceY = self.distance = 0; self.isPanning = false; self.isSwiping = false; self.isZooming = false; self.sliderStartPos = self.sliderLastPos || { top: 0, left: 0 }; self.contentStartPos = $.fancybox.getTranslate( self.$content ); self.contentLastPos = null; if ( self.startPoints.length === 1 && !self.isZooming ) { self.canTap = !instance.isSliding; if ( current.type === 'image' && ( self.contentStartPos.width > self.canvasWidth + 1 || self.contentStartPos.height > self.canvasHeight + 1 ) ) { $.fancybox.stop( self.$content ); self.$content.css( 'transition-duration', '0ms' ); self.isPanning = true; } else { self.isSwiping = true; } self.$container.addClass('fancybox-controls--isGrabbing'); } if ( self.startPoints.length === 2 && !instance.isAnimating && !current.hasError && current.type === 'image' && ( current.isLoaded || current.$ghost ) ) { self.isZooming = true; self.isSwiping = false; self.isPanning = false; $.fancybox.stop( self.$content ); self.$content.css( 'transition-duration', '0ms' ); self.centerPointStartX = ( ( self.startPoints[0].x + self.startPoints[1].x ) * 0.5 ) - $(window).scrollLeft(); self.centerPointStartY = ( ( self.startPoints[0].y + self.startPoints[1].y ) * 0.5 ) - $(window).scrollTop(); self.percentageOfImageAtPinchPointX = ( self.centerPointStartX - self.contentStartPos.left ) / self.contentStartPos.width; self.percentageOfImageAtPinchPointY = ( self.centerPointStartY - self.contentStartPos.top ) / self.contentStartPos.height; self.startDistanceBetweenFingers = distance( self.startPoints[0], self.startPoints[1] ); } }; Guestures.prototype.ontouchmove = function( e ) { var self = this; self.newPoints = pointers( e ); if ( $.fancybox.isMobile && ( isScrollable( self.$target ) || isScrollable( self.$target.parent() ) ) ) { e.stopPropagation(); self.canTap = false; return; } if ( !( self.opts || self.instance.canPan() ) || !self.newPoints || !self.newPoints.length ) { return; } self.distanceX = distance( self.newPoints[0], self.startPoints[0], 'x' ); self.distanceY = distance( self.newPoints[0], self.startPoints[0], 'y' ); self.distance = distance( self.newPoints[0], self.startPoints[0] ); // Skip false ontouchmove events (Chrome) if ( self.distance > 0 ) { if ( !( self.$target.is( self.$stage ) || self.$stage.find( self.$target ).length ) ) { return; } e.stopPropagation(); e.preventDefault(); if ( self.isSwiping ) { self.onSwipe(); } else if ( self.isPanning ) { self.onPan(); } else if ( self.isZooming ) { self.onZoom(); } } }; Guestures.prototype.onSwipe = function() { var self = this; var swiping = self.isSwiping; var left = self.sliderStartPos.left || 0; var angle; if ( swiping === true ) { if ( Math.abs( self.distance ) > 10 ) { self.canTap = false; if ( self.instance.group.length < 2 && self.opts.vertical ) { self.isSwiping = 'y'; } else if ( self.instance.isSliding || self.opts.vertical === false || ( self.opts.vertical === 'auto' && $( window ).width() > 800 ) ) { self.isSwiping = 'x'; } else { angle = Math.abs( Math.atan2( self.distanceY, self.distanceX ) * 180 / Math.PI ); self.isSwiping = ( angle > 45 && angle < 135 ) ? 'y' : 'x'; } self.instance.isSliding = self.isSwiping; // Reset points to avoid jumping, because we dropped first swipes to calculate the angle self.startPoints = self.newPoints; $.each(self.instance.slides, function( index, slide ) { $.fancybox.stop( slide.$slide ); slide.$slide.css( 'transition-duration', '0ms' ); slide.inTransition = false; if ( slide.pos === self.instance.current.pos ) { self.sliderStartPos.left = $.fancybox.getTranslate( slide.$slide ).left; } }); //self.instance.current.isMoved = true; // Stop slideshow if ( self.instance.SlideShow && self.instance.SlideShow.isActive ) { self.instance.SlideShow.stop(); } } } else { if ( swiping == 'x' ) { // Sticky edges if ( self.distanceX > 0 && ( self.instance.group.length < 2 || ( self.instance.current.index === 0 && !self.instance.current.opts.loop ) ) ) { left = left + Math.pow( self.distanceX, 0.8 ); } else if ( self.distanceX < 0 && ( self.instance.group.length < 2 || ( self.instance.current.index === self.instance.group.length - 1 && !self.instance.current.opts.loop ) ) ) { left = left - Math.pow( -self.distanceX, 0.8 ); } else { left = left + self.distanceX; } } self.sliderLastPos = { top : swiping == 'x' ? 0 : self.sliderStartPos.top + self.distanceY, left : left }; if ( self.requestId ) { cancelAFrame( self.requestId ); self.requestId = null; } self.requestId = requestAFrame(function() { if ( self.sliderLastPos ) { $.each(self.instance.slides, function( index, slide ) { var pos = slide.pos - self.instance.currPos; $.fancybox.setTranslate( slide.$slide, { top : self.sliderLastPos.top, left : self.sliderLastPos.left + ( pos * self.canvasWidth ) + ( pos * slide.opts.gutter ) }); }); self.$container.addClass( 'fancybox-is-sliding' ); } }); } }; Guestures.prototype.onPan = function() { var self = this; var newOffsetX, newOffsetY, newPos; self.canTap = false; if ( self.contentStartPos.width > self.canvasWidth ) { newOffsetX = self.contentStartPos.left + self.distanceX; } else { newOffsetX = self.contentStartPos.left; } newOffsetY = self.contentStartPos.top + self.distanceY; newPos = self.limitMovement( newOffsetX, newOffsetY, self.contentStartPos.width, self.contentStartPos.height ); newPos.scaleX = self.contentStartPos.scaleX; newPos.scaleY = self.contentStartPos.scaleY; self.contentLastPos = newPos; if ( self.requestId ) { cancelAFrame( self.requestId ); self.requestId = null; } self.requestId = requestAFrame(function() { $.fancybox.setTranslate( self.$content, self.contentLastPos ); }); }; // Make panning sticky to the edges Guestures.prototype.limitMovement = function( newOffsetX, newOffsetY, newWidth, newHeight ) { var self = this; var minTranslateX, minTranslateY, maxTranslateX, maxTranslateY; var canvasWidth = self.canvasWidth; var canvasHeight = self.canvasHeight; var currentOffsetX = self.contentStartPos.left; var currentOffsetY = self.contentStartPos.top; var distanceX = self.distanceX; var distanceY = self.distanceY; // Slow down proportionally to traveled distance minTranslateX = Math.max(0, canvasWidth * 0.5 - newWidth * 0.5 ); minTranslateY = Math.max(0, canvasHeight * 0.5 - newHeight * 0.5 ); maxTranslateX = Math.min( canvasWidth - newWidth, canvasWidth * 0.5 - newWidth * 0.5 ); maxTranslateY = Math.min( canvasHeight - newHeight, canvasHeight * 0.5 - newHeight * 0.5 ); if ( newWidth > canvasWidth ) { // -> if ( distanceX > 0 && newOffsetX > minTranslateX ) { newOffsetX = minTranslateX - 1 + Math.pow( -minTranslateX + currentOffsetX + distanceX, 0.8 ) || 0; } // 0 && newOffsetY > minTranslateY ) { newOffsetY = minTranslateY - 1 + Math.pow(-minTranslateY + currentOffsetY + distanceY, 0.8 ) || 0; } // /\\ if ( distanceY < 0 && newOffsetY < maxTranslateY ) { newOffsetY = maxTranslateY + 1 - Math.pow ( maxTranslateY - currentOffsetY - distanceY, 0.8 ) || 0; } } return { top : newOffsetY, left : newOffsetX }; }; Guestures.prototype.limitPosition = function( newOffsetX, newOffsetY, newWidth, newHeight ) { var self = this; var canvasWidth = self.canvasWidth; var canvasHeight = self.canvasHeight; if ( newWidth > canvasWidth ) { newOffsetX = newOffsetX > 0 ? 0 : newOffsetX; newOffsetX = newOffsetX < canvasWidth - newWidth ? canvasWidth - newWidth : newOffsetX; } else { // Center horizontally newOffsetX = Math.max( 0, canvasWidth / 2 - newWidth / 2 ); } if ( newHeight > canvasHeight ) { newOffsetY = newOffsetY > 0 ? 0 : newOffsetY; newOffsetY = newOffsetY < canvasHeight - newHeight ? canvasHeight - newHeight : newOffsetY; } else { // Center vertically newOffsetY = Math.max( 0, canvasHeight / 2 - newHeight / 2 ); } return { top : newOffsetY, left : newOffsetX }; }; Guestures.prototype.onZoom = function() { var self = this; // Calculate current distance between points to get pinch ratio and new width and height var currentWidth = self.contentStartPos.width; var currentHeight = self.contentStartPos.height; var currentOffsetX = self.contentStartPos.left; var currentOffsetY = self.contentStartPos.top; var endDistanceBetweenFingers = distance( self.newPoints[0], self.newPoints[1] ); var pinchRatio = endDistanceBetweenFingers / self.startDistanceBetweenFingers; var newWidth = Math.floor( currentWidth * pinchRatio ); var newHeight = Math.floor( currentHeight * pinchRatio ); // This is the translation due to pinch-zooming var translateFromZoomingX = (currentWidth - newWidth) * self.percentageOfImageAtPinchPointX; var translateFromZoomingY = (currentHeight - newHeight) * self.percentageOfImageAtPinchPointY; //Point between the two touches var centerPointEndX = ((self.newPoints[0].x + self.newPoints[1].x) / 2) - $(window).scrollLeft(); var centerPointEndY = ((self.newPoints[0].y + self.newPoints[1].y) / 2) - $(window).scrollTop(); // And this is the translation due to translation of the centerpoint // between the two fingers var translateFromTranslatingX = centerPointEndX - self.centerPointStartX; var translateFromTranslatingY = centerPointEndY - self.centerPointStartY; // The new offset is the old/current one plus the total translation var newOffsetX = currentOffsetX + ( translateFromZoomingX + translateFromTranslatingX ); var newOffsetY = currentOffsetY + ( translateFromZoomingY + translateFromTranslatingY ); var newPos = { top : newOffsetY, left : newOffsetX, scaleX : self.contentStartPos.scaleX * pinchRatio, scaleY : self.contentStartPos.scaleY * pinchRatio }; self.canTap = false; self.newWidth = newWidth; self.newHeight = newHeight; self.contentLastPos = newPos; if ( self.requestId ) { cancelAFrame( self.requestId ); self.requestId = null; } self.requestId = requestAFrame(function() { $.fancybox.setTranslate( self.$content, self.contentLastPos ); }); }; Guestures.prototype.ontouchend = function( e ) { var self = this; var dMs = Math.max( (new Date().getTime() ) - self.startTime, 1); var swiping = self.isSwiping; var panning = self.isPanning; var zooming = self.isZooming; self.endPoints = pointers( e ); self.$container.removeClass( 'fancybox-controls--isGrabbing' ); $(document).off( '.fb.touch' ); if ( self.requestId ) { cancelAFrame( self.requestId ); self.requestId = null; } self.isSwiping = false; self.isPanning = false; self.isZooming = false; if ( self.canTap ) { return self.onTap( e ); } self.speed = 366; // Speed in px/ms self.velocityX = self.distanceX / dMs * 0.5; self.velocityY = self.distanceY / dMs * 0.5; self.speedX = Math.max( self.speed * 0.5, Math.min( self.speed * 1.5, ( 1 / Math.abs( self.velocityX ) ) * self.speed ) ); if ( panning ) { self.endPanning(); } else if ( zooming ) { self.endZooming(); } else { self.endSwiping( swiping ); } return; }; Guestures.prototype.endSwiping = function( swiping ) { var self = this; var ret = false; self.instance.isSliding = false; self.sliderLastPos = null; // Close if swiped vertically / navigate if horizontally if ( swiping == 'y' && Math.abs( self.distanceY ) > 50 ) { // Continue vertical movement $.fancybox.animate( self.instance.current.$slide, { top : self.sliderStartPos.top + self.distanceY + ( self.velocityY * 150 ), opacity : 0 }, 150 ); ret = self.instance.close( true, 300 ); } else if ( swiping == 'x' && self.distanceX > 50 && self.instance.group.length > 1 ) { ret = self.instance.previous( self.speedX ); } else if ( swiping == 'x' && self.distanceX < -50 && self.instance.group.length > 1 ) { ret = self.instance.next( self.speedX ); } if ( ret === false && ( swiping == 'x' || swiping == 'y' ) ) { self.instance.jumpTo( self.instance.current.index, 150 ); } self.$container.removeClass( 'fancybox-is-sliding' ); }; // Limit panning from edges // ======================== Guestures.prototype.endPanning = function() { var self = this; var newOffsetX, newOffsetY, newPos; if ( !self.contentLastPos ) { return; } if ( self.opts.momentum === false ) { newOffsetX = self.contentLastPos.left; newOffsetY = self.contentLastPos.top; } else { // Continue movement newOffsetX = self.contentLastPos.left + ( self.velocityX * self.speed ); newOffsetY = self.contentLastPos.top + ( self.velocityY * self.speed ); } newPos = self.limitPosition( newOffsetX, newOffsetY, self.contentStartPos.width, self.contentStartPos.height ); newPos.width = self.contentStartPos.width; newPos.height = self.contentStartPos.height; $.fancybox.animate( self.$content, newPos, 330 ); }; Guestures.prototype.endZooming = function() { var self = this; var current = self.instance.current; var newOffsetX, newOffsetY, newPos, reset; var newWidth = self.newWidth; var newHeight = self.newHeight; if ( !self.contentLastPos ) { return; } newOffsetX = self.contentLastPos.left; newOffsetY = self.contentLastPos.top; reset = { top : newOffsetY, left : newOffsetX, width : newWidth, height : newHeight, scaleX : 1, scaleY : 1 }; // Reset scalex/scaleY values; this helps for perfomance and does not break animation $.fancybox.setTranslate( self.$content, reset ); if ( newWidth < self.canvasWidth && newHeight < self.canvasHeight ) { self.instance.scaleToFit( 150 ); } else if ( newWidth > current.width || newHeight > current.height ) { self.instance.scaleToActual( self.centerPointStartX, self.centerPointStartY, 150 ); } else { newPos = self.limitPosition( newOffsetX, newOffsetY, newWidth, newHeight ); // Switch from scale() to width/height or animation will not work correctly $.fancybox.setTranslate( self.content, $.fancybox.getTranslate( self.$content ) ); $.fancybox.animate( self.$content, newPos, 150 ); } }; Guestures.prototype.onTap = function(e) { var self = this; var $target = $( e.target ); var instance = self.instance; var current = instance.current; var endPoints = ( e && pointers( e ) ) || self.startPoints; var tapX = endPoints[0] ? endPoints[0].x - self.$stage.offset().left : 0; var tapY = endPoints[0] ? endPoints[0].y - self.$stage.offset().top : 0; var where; var process = function ( prefix ) { var action = current.opts[ prefix ]; if ( $.isFunction( action ) ) { action = action.apply( instance, [ current, e ] ); } if ( !action) { return; } switch ( action ) { case \"close\" : instance.close( self.startEvent ); break; case \"toggleControls\" : instance.toggleControls( true ); break; case \"next\" : instance.next(); break; case \"nextOrClose\" : if ( instance.group.length > 1 ) { instance.next(); } else { instance.close( self.startEvent ); } break; case \"zoom\" : if ( current.type == 'image' && ( current.isLoaded || current.$ghost ) ) { if ( instance.canPan() ) { instance.scaleToFit(); } else if ( instance.isScaledDown() ) { instance.scaleToActual( tapX, tapY ); } else if ( instance.group.length < 2 ) { instance.close( self.startEvent ); } } break; } }; // Ignore right click if ( e.originalEvent && e.originalEvent.button == 2 ) { return; } // Skip if current slide is not in the center if ( instance.isSliding ) { return; } // Skip if clicked on the scrollbar if ( tapX > $target[0].clientWidth + $target.offset().left ) { return; } // Check where is clicked if ( $target.is( '.fancybox-bg,.fancybox-inner,.fancybox-outer,.fancybox-container' ) ) { where = 'Outside'; } else if ( $target.is( '.fancybox-slide' ) ) { where = 'Slide'; } else if ( instance.current.$content && instance.current.$content.has( e.target ).length ) { where = 'Content'; } else { return; } // Check if this is a double tap if ( self.tapped ) { // Stop previously created single tap clearTimeout( self.tapped ); self.tapped = null; // Skip if distance between taps is too big if ( Math.abs( tapX - self.tapX ) > 50 || Math.abs( tapY - self.tapY ) > 50 || instance.isSliding ) { return this; } // OK, now we assume that this is a double-tap process( 'dblclick' + where ); } else { // Single tap will be processed if user has not clicked second time within 300ms // or there is no need to wait for double-tap self.tapX = tapX; self.tapY = tapY; if ( current.opts[ 'dblclick' + where ] && current.opts[ 'dblclick' + where ] !== current.opts[ 'click' + where ] ) { self.tapped = setTimeout(function() { self.tapped = null; process( 'click' + where ); }, 300); } else { process( 'click' + where ); } } return this; }; $(document).on('onActivate.fb', function (e, instance) { if ( instance && !instance.Guestures ) { instance.Guestures = new Guestures( instance ); } }); $(document).on('beforeClose.fb', function (e, instance) { if ( instance && instance.Guestures ) { instance.Guestures.destroy(); } }); }( window, document, window.jQuery || jQuery )); // ========================================================================== // // SlideShow // Enables slideshow functionality // // Example of usage: // $.fancybox.getInstance().SlideShow.start() // // ========================================================================== ;(function (document, $) { 'use strict'; $.extend(true, $.fancybox.defaults, { btnTpl : { slideShow : '' + '' + '' + '' + '' + '' }, slideShow : { autoStart : false, speed : 3000 } }); var SlideShow = function( instance ) { this.instance = instance; this.init(); }; $.extend( SlideShow.prototype, { timer : null, isActive : false, $button : null, init : function() { var self = this; self.$button = self.instance.$refs.toolbar.find('[data-fancybox-play]').on('click', function() { self.toggle(); }); if ( self.instance.group.length < 2 || !self.instance.group[ self.instance.currIndex ].opts.slideShow ) { self.$button.hide(); } }, set : function( force ) { var self = this; // Check if reached last element if ( self.instance && self.instance.current && (force === true || self.instance.current.opts.loop || self.instance.currIndex < self.instance.group.length - 1 )) { self.timer = setTimeout(function() { if ( self.isActive ) { self.instance.jumpTo( (self.instance.currIndex + 1) % self.instance.group.length ); } }, self.instance.current.opts.slideShow.speed); } else { self.stop(); self.instance.idleSecondsCounter = 0; self.instance.showControls(); } }, clear : function() { var self = this; clearTimeout( self.timer ); self.timer = null; }, start : function() { var self = this; var current = self.instance.current; if ( current ) { self.isActive = true; self.$button .attr( 'title', current.opts.i18n[ current.opts.lang ].PLAY_STOP ) .removeClass( 'fancybox-button--play' ) .addClass( 'fancybox-button--pause' ); self.set( true ); } }, stop : function() { var self = this; var current = self.instance.current; self.clear(); self.$button .attr( 'title', current.opts.i18n[ current.opts.lang ].PLAY_START ) .removeClass( 'fancybox-button--pause' ) .addClass( 'fancybox-button--play' ); self.isActive = false; }, toggle : function() { var self = this; if ( self.isActive ) { self.stop(); } else { self.start(); } } }); $(document).on({ 'onInit.fb' : function(e, instance) { if ( instance && !instance.SlideShow ) { instance.SlideShow = new SlideShow( instance ); } }, 'beforeShow.fb' : function(e, instance, current, firstRun) { var SlideShow = instance && instance.SlideShow; if ( firstRun ) { if ( SlideShow && current.opts.slideShow.autoStart ) { SlideShow.start(); } } else if ( SlideShow && SlideShow.isActive ) { SlideShow.clear(); } }, 'afterShow.fb' : function(e, instance, current) { var SlideShow = instance && instance.SlideShow; if ( SlideShow && SlideShow.isActive ) { SlideShow.set(); } }, 'afterKeydown.fb' : function(e, instance, current, keypress, keycode) { var SlideShow = instance && instance.SlideShow; // \"P\" or Spacebar if ( SlideShow && current.opts.slideShow && ( keycode === 80 || keycode === 32 ) && !$(document.activeElement).is( 'button,a,input' ) ) { keypress.preventDefault(); SlideShow.toggle(); } }, 'beforeClose.fb onDeactivate.fb' : function(e, instance) { var SlideShow = instance && instance.SlideShow; if ( SlideShow ) { SlideShow.stop(); } } }); // Page Visibility API to pause slideshow when window is not active $(document).on(\"visibilitychange\", function() { var instance = $.fancybox.getInstance(); var SlideShow = instance && instance.SlideShow; if ( SlideShow && SlideShow.isActive ) { if ( document.hidden ) { SlideShow.clear(); } else { SlideShow.set(); } } }); }( document, window.jQuery || jQuery )); // ========================================================================== // // FullScreen // Adds fullscreen functionality // // ========================================================================== ;(function (document, $) { 'use strict'; // Collection of methods supported by user browser var fn = (function () { var fnMap = [ [ 'requestFullscreen', 'exitFullscreen', 'fullscreenElement', 'fullscreenEnabled', 'fullscreenchange', 'fullscreenerror' ], // new WebKit [ 'webkitRequestFullscreen', 'webkitExitFullscreen', 'webkitFullscreenElement', 'webkitFullscreenEnabled', 'webkitfullscreenchange', 'webkitfullscreenerror' ], // old WebKit (Safari 5.1) [ 'webkitRequestFullScreen', 'webkitCancelFullScreen', 'webkitCurrentFullScreenElement', 'webkitCancelFullScreen', 'webkitfullscreenchange', 'webkitfullscreenerror' ], [ 'mozRequestFullScreen', 'mozCancelFullScreen', 'mozFullScreenElement', 'mozFullScreenEnabled', 'mozfullscreenchange', 'mozfullscreenerror' ], [ 'msRequestFullscreen', 'msExitFullscreen', 'msFullscreenElement', 'msFullscreenEnabled', 'MSFullscreenChange', 'MSFullscreenError' ] ]; var val; var ret = {}; var i, j; for ( i = 0; i < fnMap.length; i++ ) { val = fnMap[ i ]; if ( val && val[ 1 ] in document ) { for ( j = 0; j < val.length; j++ ) { ret[ fnMap[ 0 ][ j ] ] = val[ j ]; } return ret; } } return false; })(); // If browser does not have Full Screen API, then simply unset default button template and stop if ( !fn ) { if ( $ && $.fancybox ) { $.fancybox.defaults.btnTpl.fullScreen = false; } return; } var FullScreen = { request : function ( elem ) { elem = elem || document.documentElement; elem[ fn.requestFullscreen ]( elem.ALLOW_KEYBOARD_INPUT ); }, exit : function () { document[ fn.exitFullscreen ](); }, toggle : function ( elem ) { elem = elem || document.documentElement; if ( this.isFullscreen() ) { this.exit(); } else { this.request( elem ); } }, isFullscreen : function() { return Boolean( document[ fn.fullscreenElement ] ); }, enabled : function() { return Boolean( document[ fn.fullscreenEnabled ] ); } }; $.extend(true, $.fancybox.defaults, { btnTpl : { fullScreen : '' + '' + '' + '' + '' }, fullScreen : { autoStart : false } }); $(document).on({ 'onInit.fb' : function(e, instance) { var $container; if ( instance && instance.group[ instance.currIndex ].opts.fullScreen ) { $container = instance.$refs.container; $container.on('click.fb-fullscreen', '[data-fancybox-fullscreen]', function(e) { e.stopPropagation(); e.preventDefault(); FullScreen.toggle( $container[ 0 ] ); }); if ( instance.opts.fullScreen && instance.opts.fullScreen.autoStart === true ) { FullScreen.request( $container[ 0 ] ); } // Expose API instance.FullScreen = FullScreen; } else if ( instance ) { instance.$refs.toolbar.find('[data-fancybox-fullscreen]').hide(); } }, 'afterKeydown.fb' : function(e, instance, current, keypress, keycode) { // \"P\" or Spacebar if ( instance && instance.FullScreen && keycode === 70 ) { keypress.preventDefault(); instance.FullScreen.toggle( instance.$refs.container[ 0 ] ); } }, 'beforeClose.fb' : function( instance ) { if ( instance && instance.FullScreen ) { FullScreen.exit(); } } }); $(document).on(fn.fullscreenchange, function() { var isFullscreen = FullScreen.isFullscreen(), instance = $.fancybox.getInstance(); if ( instance ) { // If image is zooming, then force to stop and reposition properly if ( instance.current && instance.current.type === 'image' && instance.isAnimating ) { instance.current.$content.css( 'transition', 'none' ); instance.isAnimating = false; instance.update( true, true, 0 ); } instance.trigger( 'onFullscreenChange', isFullscreen ); instance.$refs.container.toggleClass( 'fancybox-is-fullscreen', isFullscreen ); } }); }( document, window.jQuery || jQuery )); // ========================================================================== // // Thumbs // Displays thumbnails in a grid // // ========================================================================== ;(function (document, $) { 'use strict'; // Make sure there are default values $.fancybox.defaults = $.extend(true, { btnTpl : { thumbs : '' + '' + '' + '' + '' }, thumbs : { autoStart : false, // Display thumbnails on opening hideOnClose : true, // Hide thumbnail grid when closing animation starts parentEl : '.fancybox-container', // Container is injected into this element axis : 'y' // Vertical (y) or horizontal (x) scrolling } }, $.fancybox.defaults); var FancyThumbs = function( instance ) { this.init( instance ); }; $.extend( FancyThumbs.prototype, { $button : null, $grid : null, $list : null, isVisible : false, isActive : false, init : function( instance ) { var self = this; self.instance = instance; instance.Thumbs = self; // Enable thumbs if at least two group items have thumbnails var first = instance.group[0], second = instance.group[1]; self.opts = instance.group[ instance.currIndex ].opts.thumbs; self.$button = instance.$refs.toolbar.find( '[data-fancybox-thumbs]' ); if ( self.opts && first && second && ( ( first.type == 'image' || first.opts.thumb || first.opts.$thumb ) && ( second.type == 'image' || second.opts.thumb || second.opts.$thumb ) )) { self.$button.show().on('click', function() { self.toggle(); }); self.isActive = true; } else { self.$button.hide(); } }, create : function() { var self = this, instance = self.instance, parentEl = self.opts.parentEl, list, src; self.$grid = $('').appendTo( instance.$refs.container.find( parentEl ).addBack().filter( parentEl ) ); // Build list HTML list = ''; $.each(instance.group, function( i, item ) { src = item.opts.thumb || ( item.opts.$thumb ? item.opts.$thumb.attr( 'src' ) : null ); if ( !src && item.type === 'image' ) { src = item.src; } if ( src && src.length ) { list += ''; } }); list += ''; self.$list = $( list ).appendTo( self.$grid ).on('click', 'li', function() { instance.jumpTo( $(this).data('index') ); }); self.$list.find( 'img' ).hide().one('load', function() { var $parent = $(this).parent().removeClass( 'fancybox-thumbs-loading' ), thumbWidth = $parent.outerWidth(), thumbHeight = $parent.outerHeight(), width, height, widthRatio, heightRatio; width = this.naturalWidth || this.width; height = this.naturalHeight || this.height; // Calculate thumbnail dimensions; center vertically and horizontally widthRatio = width / thumbWidth; heightRatio = height / thumbHeight; if (widthRatio >= 1 && heightRatio >= 1) { if (widthRatio > heightRatio) { width = width / heightRatio; height = thumbHeight; } else { width = thumbWidth; height = height / widthRatio; } } $(this).css({ width : Math.floor(width), height : Math.floor(height), 'margin-top' : height > thumbHeight ? ( Math.floor(thumbHeight * 0.3 - height * 0.3 ) ) : Math.floor(thumbHeight * 0.5 - height * 0.5 ), 'margin-left' : Math.floor(thumbWidth * 0.5 - width * 0.5 ) }).show(); }) .each(function() { this.src = $( this ).data( 'src' ); }); if ( self.opts.axis === 'x' ) { self.$list.width( parseInt( self.$grid.css(\"padding-right\") ) + ( instance.group.length * self.$list.children().eq(0).outerWidth(true) ) + 'px' ); } }, focus : function( duration ) { var self = this, $list = self.$list, thumb, thumbPos; if ( self.instance.current ) { thumb = $list.children() .removeClass( 'fancybox-thumbs-active' ) .filter('[data-index=\"' + self.instance.current.index + '\"]') .addClass('fancybox-thumbs-active'); thumbPos = thumb.position(); // Check if need to scroll to make current thumb visible if ( self.opts.axis === 'y' && ( thumbPos.top < 0 || thumbPos.top > ( $list.height() - thumb.outerHeight() ) ) ) { $list.stop().animate({ 'scrollTop' : $list.scrollTop() + thumbPos.top }, duration); } else if ( self.opts.axis === 'x' && ( thumbPos.left < $list.parent().scrollLeft() || thumbPos.left > ( $list.parent().scrollLeft() + ( $list.parent().width() - thumb.outerWidth() ) ) ) ) { $list.parent().stop().animate({ 'scrollLeft' : thumbPos.left }, duration); } } }, update : function() { this.instance.$refs.container.toggleClass( 'fancybox-show-thumbs', this.isVisible ); if ( this.isVisible ) { if ( !this.$grid ) { this.create(); } this.instance.trigger( 'onThumbsShow' ); this.focus( 0 ); } else if ( this.$grid ) { this.instance.trigger( 'onThumbsHide' ); } // Update content position this.instance.update(); }, hide : function() { this.isVisible = false; this.update(); }, show : function() { this.isVisible = true; this.update(); }, toggle : function() { this.isVisible = !this.isVisible; this.update(); } }); $(document).on({ 'onInit.fb' : function(e, instance) { var Thumbs; if ( instance && !instance.Thumbs ) { Thumbs = new FancyThumbs( instance ); if ( Thumbs.isActive && Thumbs.opts.autoStart === true ) { Thumbs.show(); } } }, 'beforeShow.fb' : function(e, instance, item, firstRun) { var Thumbs = instance && instance.Thumbs; if ( Thumbs && Thumbs.isVisible ) { Thumbs.focus( firstRun ? 0 : 250 ); } }, 'afterKeydown.fb' : function(e, instance, current, keypress, keycode) { var Thumbs = instance && instance.Thumbs; // \"G\" if ( Thumbs && Thumbs.isActive && keycode === 71 ) { keypress.preventDefault(); Thumbs.toggle(); } }, 'beforeClose.fb' : function( e, instance ) { var Thumbs = instance && instance.Thumbs; if ( Thumbs && Thumbs.isVisible && Thumbs.opts.hideOnClose !== false ) { Thumbs.$grid.hide(); } } }); }(document, window.jQuery)); //// ========================================================================== // // Share // Displays simple form for sharing current url // // ========================================================================== ;(function (document, $) { 'use strict'; $.extend(true, $.fancybox.defaults, { btnTpl : { share : '' + '' + '' + '' + '' }, share : { tpl : '' + '' + '' + '' + '' + 'Facebook' + '' + '' + '' + 'Pinterest' + '' + '' + '' + 'Twitter' + '' + '' + '' + '' } }); function escapeHtml(string) { var entityMap = { '&': '&amp;', '': '&gt;', '\"': '&quot;', \"'\": '&#39;', '/': '&#x2F;', '`': '&#x60;', '=': '&#x3D;' }; return String(string).replace(/[&\"'`=\\/]/g, function (s) { return entityMap[s]; }); } $(document).on('click', '[data-fancybox-share]', function() { var f = $.fancybox.getInstance(), url, tpl; if ( f ) { url = f.current.opts.hash === false ? f.current.src : window.location; tpl = f.current.opts.share.tpl .replace( /\\{\\{src\\}\\}/g, encodeURIComponent( url ) ) .replace( /\\{\\{src_raw\\}\\}/g, escapeHtml( url ) ) .replace( /\\{\\{descr\\}\\}/g, f.$caption ? encodeURIComponent( f.$caption.text() ) : '' ); $.fancybox.open({ src : f.translate( f, tpl ), type : 'html', opts : { animationEffect : \"fade\", animationDuration : 250 } }); } }); }( document, window.jQuery || jQuery )); // ========================================================================== // // Hash // Enables linking to each modal // // ========================================================================== ;(function (document, window, $) { 'use strict'; // Simple $.escapeSelector polyfill (for jQuery prior v3) if ( !$.escapeSelector ) { $.escapeSelector = function( sel ) { var rcssescape = /([\\0-\\x1f\\x7f]|^-?\\d)|^-$|[^\\x80-\\uFFFF\\w-]/g; var fcssescape = function( ch, asCodePoint ) { if ( asCodePoint ) { // U+0000 NULL becomes U+FFFD REPLACEMENT CHARACTER if ( ch === \"\\0\" ) { return \"\\uFFFD\"; } // Control characters and (dependent upon position) numbers get escaped as code points return ch.slice( 0, -1 ) + \"\\\\\" + ch.charCodeAt( ch.length - 1 ).toString( 16 ) + \" \"; } // Other potentially-special ASCII characters get backslash-escaped return \"\\\\\" + ch; }; return ( sel + \"\" ).replace( rcssescape, fcssescape ); }; } // Create new history entry only once var shouldCreateHistory = true; // Variable containing last hash value set by fancyBox // It will be used to determine if fancyBox needs to close after hash change is detected var currentHash = null; // Throttling the history change var timerID = null; // Get info about gallery name and current index from url function parseUrl() { var hash = window.location.hash.substr( 1 ); var rez = hash.split( '-' ); var index = rez.length > 1 && /^\\+?\\d+$/.test( rez[ rez.length - 1 ] ) ? parseInt( rez.pop( -1 ), 10 ) || 1 : 1; var gallery = rez.join( '-' ); // Index is starting from 1 if ( index < 1 ) { index = 1; } return { hash : hash, index : index, gallery : gallery }; } // Trigger click evnt on links to open new fancyBox instance function triggerFromUrl( url ) { var $el; if ( url.gallery !== '' ) { // If we can find element matching 'data-fancybox' atribute, then trigger click event for that .. $el = $( \"[data-fancybox='\" + $.escapeSelector( url.gallery ) + \"']\" ).eq( url.index - 1 ); if ( !$el.length ) { // .. if not, try finding element by ID $el = $( \"#\" + $.escapeSelector( url.gallery ) + \"\" ); } if ( $el.length ) { shouldCreateHistory = false; $el.trigger( 'click' ); } } } // Get gallery name from current instance function getGalleryID( instance ) { var opts; if ( !instance ) { return false; } opts = instance.current ? instance.current.opts : instance.opts; return opts.hash || ( opts.$orig ? opts.$orig.data( 'fancybox' ) : '' ); } // Start when DOM becomes ready $(function() { // Check if user has disabled this module if ( $.fancybox.defaults.hash === false ) { return; } // Update hash when opening/closing fancyBox $(document).on({ 'onInit.fb' : function( e, instance ) { var url, gallery; if ( instance.group[ instance.currIndex ].opts.hash === false ) { return; } url = parseUrl(); gallery = getGalleryID( instance ); // Make sure gallery start index matches index from hash if ( gallery && url.gallery && gallery == url.gallery ) { instance.currIndex = url.index - 1; } }, 'beforeShow.fb' : function( e, instance, current ) { var gallery; if ( !current || current.opts.hash === false ) { return; } gallery = getGalleryID( instance ); // Update window hash if ( gallery && gallery !== '' ) { if ( window.location.hash.indexOf( gallery ) < 0 ) { instance.opts.origHash = window.location.hash; } currentHash = gallery + ( instance.group.length > 1 ? '-' + ( current.index + 1 ) : '' ); if ( 'replaceState' in window.history ) { if ( timerID ) { clearTimeout( timerID ); } timerID = setTimeout(function() { window.history[ shouldCreateHistory ? 'pushState' : 'replaceState' ]( {} , document.title, window.location.pathname + window.location.search + '#' + currentHash ); timerID = null; shouldCreateHistory = false; }, 300); } else { window.location.hash = currentHash; } } }, 'beforeClose.fb' : function( e, instance, current ) { var gallery, origHash; if ( timerID ) { clearTimeout( timerID ); } if ( current.opts.hash === false ) { return; } gallery = getGalleryID( instance ); origHash = instance && instance.opts.origHash ? instance.opts.origHash : ''; // Remove hash from location bar if ( gallery && gallery !== '' ) { if ( 'replaceState' in history ) { window.history.replaceState( {} , document.title, window.location.pathname + window.location.search + origHash ); } else { window.location.hash = origHash; // Keep original scroll position $( window ).scrollTop( instance.scrollTop ).scrollLeft( instance.scrollLeft ); } } currentHash = null; } }); // Check if need to close after url has changed $(window).on('hashchange.fb', function() { var url = parseUrl(); if ( $.fancybox.getInstance() ) { if ( currentHash && currentHash !== url.gallery + '-' + url.index && !( url.index === 1 && currentHash == url.gallery ) ) { currentHash = null; $.fancybox.close(); } } else if ( url.gallery !== '' ) { triggerFromUrl( url ); } }); // Check current hash and trigger click event on matching element to start fancyBox, if needed setTimeout(function() { triggerFromUrl( parseUrl() ); }, 50); }); }( document, window, window.jQuery || jQuery ));"},{"title":"","date":"2019-02-15T07:57:56.287Z","updated":"2019-02-15T07:57:56.287Z","comments":true,"path":"lib/fancybox/source/jquery.fancybox.js","permalink":"https://ainevsia.github.io/lib/fancybox/source/jquery.fancybox.js","excerpt":"","text":"// ================================================== // fancyBox v3.2.5 // // Licensed GPLv3 for open source use // or fancyBox Commercial License for commercial use // // http://fancyapps.com/fancybox/ // Copyright 2017 fancyApps // // ================================================== ;(function (window, document, $, undefined) { 'use strict'; // If there's no jQuery, fancyBox can't work // ========================================= if ( !$ ) { return; } // Check if fancyBox is already initialized // ======================================== if ( $.fn.fancybox ) { if ( 'console' in window ) { console.log( 'fancyBox already initialized' ); } return; } // Private default settings // ======================== var defaults = { // Enable infinite gallery navigation loop : false, // Space around image, ignored if zoomed-in or viewport width is smaller than 800px margin : [44, 0], // Horizontal space between slides gutter : 50, // Enable keyboard navigation keyboard : true, // Should display navigation arrows at the screen edges arrows : true, // Should display infobar (counter and arrows at the top) infobar : true, // Should display toolbar (buttons at the top) toolbar : true, // What buttons should appear in the top right corner. // Buttons will be created using templates from `btnTpl` option // and they will be placed into toolbar (class=\"fancybox-toolbar\"` element) buttons : [ 'slideShow', 'fullScreen', 'thumbs', 'share', //'download', //'zoom', 'close' ], // Detect \"idle\" time in seconds idleTime : 3, // Should display buttons at top right corner of the content // If 'auto' - they will be created for content having type 'html', 'inline' or 'ajax' // Use template from `btnTpl.smallBtn` for customization smallBtn : 'auto', // Disable right-click and use simple image protection for images protect : false, // Shortcut to make content \"modal\" - disable keyboard navigtion, hide buttons, etc modal : false, image : { // Wait for images to load before displaying // Requires predefined image dimensions // If 'auto' - will zoom in thumbnail if 'width' and 'height' attributes are found preload : \"auto\" }, ajax : { // Object containing settings for ajax request settings : { // This helps to indicate that request comes from the modal // Feel free to change naming data : { fancybox : true } } }, iframe : { // Iframe template tpl : '', // Preload iframe before displaying it // This allows to calculate iframe content width and height // (note: Due to \"Same Origin Policy\", you can't get cross domain data). preload : true, // Custom CSS styling for iframe wrapping element // You can use this to set custom iframe dimensions css : {}, // Iframe tag attributes attr : { scrolling : 'auto' } }, // Default content type if cannot be detected automatically defaultType : 'image', // Open/close animation type // Possible values: // false - disable // \"zoom\" - zoom images from/to thumbnail // \"fade\" // \"zoom-in-out\" // animationEffect : \"zoom\", // Duration in ms for open/close animation animationDuration : 500, // Should image change opacity while zooming // If opacity is \"auto\", then opacity will be changed if image and thumbnail have different aspect ratios zoomOpacity : \"auto\", // Transition effect between slides // // Possible values: // false - disable // \"fade' // \"slide' // \"circular' // \"tube' // \"zoom-in-out' // \"rotate' // transitionEffect : \"fade\", // Duration in ms for transition animation transitionDuration : 366, // Custom CSS class for slide element slideClass : '', // Custom CSS class for layout baseClass : '', // Base template for layout baseTpl : '' + '' + '' + '' + '&nbsp;/&nbsp;' + '' + '' + '' + '' + '' + '' + '', // Loading indicator template spinnerTpl : '', // Error message template errorTpl : '', btnTpl : { download : '' + '' + '' + '' + '', zoom : '' + '' + '' + '' + '', close : '' + '' + '' + '' + '', // This small close button will be appended to your html/inline/ajax content by default, // if \"smallBtn\" option is not set to false smallBtn : '', // Arrows arrowLeft : '' + '' + '' + '' + '', arrowRight : '' + '' + '' + '' + '' }, // Container is injected into this element parentEl : 'body', // Focus handling // ============== // Try to focus on the first focusable element after opening autoFocus : false, // Put focus back to active element after closing backFocus : true, // Do not let user to focus on element outside modal content trapFocus : true, // Module specific options // ======================= fullScreen : { autoStart : false, }, // Set `touch: false` to disable dragging/swiping touch : { vertical : true, // Allow to drag content vertically momentum : true // Continue movement after releasing mouse/touch when panning }, // Hash value when initializing manually, // set `false` to disable hash change hash : null, // Customize or add new media types // Example: /* media : { youtube : { params : { autoplay : 0 } } } */ media : {}, slideShow : { autoStart : false, speed : 4000 }, thumbs : { autoStart : false, // Display thumbnails on opening hideOnClose : true, // Hide thumbnail grid when closing animation starts parentEl : '.fancybox-container', // Container is injected into this element axis : 'y' // Vertical (y) or horizontal (x) scrolling }, // Callbacks //========== // See Documentation/API/Events for more information // Example: /* afterShow: function( instance, current ) { console.info( 'Clicked element:' ); console.info( current.opts.$orig ); } */ onInit : $.noop, // When instance has been initialized beforeLoad : $.noop, // Before the content of a slide is being loaded afterLoad : $.noop, // When the content of a slide is done loading beforeShow : $.noop, // Before open animation starts afterShow : $.noop, // When content is done loading and animating beforeClose : $.noop, // Before the instance attempts to close. Return false to cancel the close. afterClose : $.noop, // After instance has been closed onActivate : $.noop, // When instance is brought to front onDeactivate : $.noop, // When other instance has been activated // Interaction // =========== // Use options below to customize taken action when user clicks or double clicks on the fancyBox area, // each option can be string or method that returns value. // // Possible values: // \"close\" - close instance // \"next\" - move to next gallery item // \"nextOrClose\" - move to next gallery item or close if gallery has only one item // \"toggleControls\" - show/hide controls // \"zoom\" - zoom image (if loaded) // false - do nothing // Clicked on the content clickContent : function( current, event ) { return current.type === 'image' ? 'zoom' : false; }, // Clicked on the slide clickSlide : 'close', // Clicked on the background (backdrop) element clickOutside : 'close', // Same as previous two, but for double click dblclickContent : false, dblclickSlide : false, dblclickOutside : false, // Custom options when mobile device is detected // ============================================= mobile : { margin : 0, clickContent : function( current, event ) { return current.type === 'image' ? 'toggleControls' : false; }, clickSlide : function( current, event ) { return current.type === 'image' ? 'toggleControls' : 'close'; }, dblclickContent : function( current, event ) { return current.type === 'image' ? 'zoom' : false; }, dblclickSlide : function( current, event ) { return current.type === 'image' ? 'zoom' : false; } }, // Internationalization // ============ lang : 'en', i18n : { 'en' : { CLOSE : 'Close', NEXT : 'Next', PREV : 'Previous', ERROR : 'The requested content cannot be loaded. Please try again later.', PLAY_START : 'Start slideshow', PLAY_STOP : 'Pause slideshow', FULL_SCREEN : 'Full screen', THUMBS : 'Thumbnails', DOWNLOAD : 'Download', SHARE : 'Share', ZOOM : 'Zoom' }, 'de' : { CLOSE : 'Schliessen', NEXT : 'Weiter', PREV : 'Zurück', ERROR : 'Die angeforderten Daten konnten nicht geladen werden. Bitte versuchen Sie es später nochmal.', PLAY_START : 'Diaschau starten', PLAY_STOP : 'Diaschau beenden', FULL_SCREEN : 'Vollbild', THUMBS : 'Vorschaubilder', DOWNLOAD : 'Herunterladen', SHARE : 'Teilen', ZOOM : 'Maßstab' } } }; // Few useful variables and methods // ================================ var $W = $(window); var $D = $(document); var called = 0; // Check if an object is a jQuery object and not a native JavaScript object // ======================================================================== var isQuery = function ( obj ) { return obj && obj.hasOwnProperty && obj instanceof $; }; // Handle multiple browsers for \"requestAnimationFrame\" and \"cancelAnimationFrame\" // =============================================================================== var requestAFrame = (function () { return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || // if all else fails, use setTimeout function (callback) { return window.setTimeout(callback, 1000 / 60); }; })(); // Detect the supported transition-end event property name // ======================================================= var transitionEnd = (function () { var t, el = document.createElement(\"fakeelement\"); var transitions = { \"transition\" : \"transitionend\", \"OTransition\" : \"oTransitionEnd\", \"MozTransition\" : \"transitionend\", \"WebkitTransition\": \"webkitTransitionEnd\" }; for (t in transitions) { if (el.style[t] !== undefined){ return transitions[t]; } } return 'transitionend'; })(); // Force redraw on an element. // This helps in cases where the browser doesn't redraw an updated element properly. // ================================================================================= var forceRedraw = function( $el ) { return ( $el && $el.length && $el[0].offsetHeight ); }; // Class definition // ================ var FancyBox = function( content, opts, index ) { var self = this; self.opts = $.extend( true, { index : index }, $.fancybox.defaults, opts || {} ); if ( $.fancybox.isMobile ) { self.opts = $.extend( true, {}, self.opts, self.opts.mobile ); } // Exclude buttons option from deep merging if ( opts && $.isArray( opts.buttons ) ) { self.opts.buttons = opts.buttons; } self.id = self.opts.id || ++called; self.group = []; self.currIndex = parseInt( self.opts.index, 10 ) || 0; self.prevIndex = null; self.prevPos = null; self.currPos = 0; self.firstRun = null; // Create group elements from original item collection self.createGroup( content ); if ( !self.group.length ) { return; } // Save last active element and current scroll position self.$lastFocus = $(document.activeElement).blur(); // Collection of gallery objects self.slides = {}; self.init(); }; $.extend(FancyBox.prototype, { // Create DOM structure // ==================== init : function() { var self = this, firstItem = self.group[ self.currIndex ], firstItemOpts = firstItem.opts, scrollbarWidth = $.fancybox.scrollbarWidth, $scrollDiv, $container, buttonStr; self.scrollTop = $D.scrollTop(); self.scrollLeft = $D.scrollLeft(); // Hide scrollbars // =============== if ( !$.fancybox.getInstance() ) { $( 'body' ).addClass( 'fancybox-active' ); // iOS hack if ( /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream ) { // iOS has problems for input elements inside fixed containers, // the workaround is to apply `position: fixed` to `` element, // unfortunately, this makes it lose the scrollbars and forces address bar to appear. if ( firstItem.type !== 'image' ) { $( 'body' ).css( 'top', $( 'body' ).scrollTop() * -1 ).addClass( 'fancybox-iosfix' ); } } else if ( !$.fancybox.isMobile && document.body.scrollHeight > window.innerHeight ) { if ( scrollbarWidth === undefined ) { $scrollDiv = $('').appendTo( 'body' ); scrollbarWidth = $.fancybox.scrollbarWidth = $scrollDiv[0].offsetWidth - $scrollDiv[0].clientWidth; $scrollDiv.remove(); } $( 'head' ).append( '.compensate-for-scrollbar { margin-right: ' + scrollbarWidth + 'px; }' ); $( 'body' ).addClass( 'compensate-for-scrollbar' ); } } // Build html markup and set references // ==================================== // Build html code for buttons and insert into main template buttonStr = ''; $.each( firstItemOpts.buttons, function( index, value ) { buttonStr += ( firstItemOpts.btnTpl[ value ] || '' ); }); // Create markup from base template, it will be initially hidden to // avoid unnecessary work like painting while initializing is not complete $container = $( self.translate( self, firstItemOpts.baseTpl .replace( '\\{\\{buttons\\}\\}', buttonStr ) .replace( '\\{\\{arrows\\}\\}', firstItemOpts.btnTpl.arrowLeft + firstItemOpts.btnTpl.arrowRight ) ) ) .attr( 'id', 'fancybox-container-' + self.id ) .addClass( 'fancybox-is-hidden' ) .addClass( firstItemOpts.baseClass ) .data( 'FancyBox', self ) .appendTo( firstItemOpts.parentEl ); // Create object holding references to jQuery wrapped nodes self.$refs = { container : $container }; [ 'bg', 'inner', 'infobar', 'toolbar', 'stage', 'caption', 'navigation' ].forEach(function(item) { self.$refs[ item ] = $container.find( '.fancybox-' + item ); }); self.trigger( 'onInit' ); // Enable events, deactive previous instances self.activate(); // Build slides, load and reveal content self.jumpTo( self.currIndex ); }, // Simple i18n support - replaces object keys found in template // with corresponding values // ============================================================ translate : function( obj, str ) { var arr = obj.opts.i18n[ obj.opts.lang ]; return str.replace(/\\{\\{(\\w+)\\}\\}/g, function(match, n) { var value = arr[n]; if ( value === undefined ) { return match; } return value; }); }, // Create array of gally item objects // Check if each object has valid type and content // =============================================== createGroup : function ( content ) { var self = this; var items = $.makeArray( content ); $.each(items, function( i, item ) { var obj = {}, opts = {}, $item, type, src, srcParts; // Step 1 - Make sure we have an object // ==================================== if ( $.isPlainObject( item ) ) { // We probably have manual usage here, something like // $.fancybox.open( [ { src : \"image.jpg\", type : \"image\" } ] ) obj = item; opts = item.opts || item; } else if ( $.type( item ) === 'object' && $( item ).length ) { // Here we probably have jQuery collection returned by some selector $item = $( item ); opts = $item.data(); opts = $.extend( {}, opts, opts.options || {} ); // Here we store clicked element opts.$orig = $item; obj.src = opts.src || $item.attr( 'href' ); // Assume that simple syntax is used, for example: // `$.fancybox.open( $(\"#test\"), {} );` if ( !obj.type && !obj.src ) { obj.type = 'inline'; obj.src = item; } } else { // Assume we have a simple html code, for example: // $.fancybox.open( 'Hi!' ); obj = { type : 'html', src : item + '' }; } // Each gallery object has full collection of options obj.opts = $.extend( true, {}, self.opts, opts ); // Do not merge buttons array if ( $.isArray( opts.buttons ) ) { obj.opts.buttons = opts.buttons; } // Step 2 - Make sure we have content type, if not - try to guess // ============================================================== type = obj.type || obj.opts.type; src = obj.src || ''; if ( !type && src ) { if ( src.match(/(^data:image\\/[a-z0-9+\\/=]*,)|(\\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\\?|#).*)?$)/i) ) { type = 'image'; } else if ( src.match(/\\.(pdf)((\\?|#).*)?$/i) ) { type = 'pdf'; } else if ( src.charAt(0) === '#' ) { type = 'inline'; } } if ( type ) { obj.type = type; } else { self.trigger( 'objectNeedsType', obj ); } // Step 3 - Some adjustments // ========================= obj.index = self.group.length; // Check if $orig and $thumb objects exist if ( obj.opts.$orig && !obj.opts.$orig.length ) { delete obj.opts.$orig; } if ( !obj.opts.$thumb && obj.opts.$orig ) { obj.opts.$thumb = obj.opts.$orig.find( 'img:first' ); } if ( obj.opts.$thumb && !obj.opts.$thumb.length ) { delete obj.opts.$thumb; } // \"caption\" is a \"special\" option, it can be used to customize caption per gallery item .. if ( $.type( obj.opts.caption ) === 'function' ) { obj.opts.caption = obj.opts.caption.apply( item, [ self, obj ] ); } if ( $.type( self.opts.caption ) === 'function' ) { obj.opts.caption = self.opts.caption.apply( item, [ self, obj ] ); } // Make sure we have caption as a string or jQuery object if ( !( obj.opts.caption instanceof $ ) ) { obj.opts.caption = obj.opts.caption === undefined ? '' : obj.opts.caption + ''; } // Check if url contains \"filter\" used to filter the content // Example: \"ajax.html #something\" if ( type === 'ajax' ) { srcParts = src.split(/\\s+/, 2); if ( srcParts.length > 1 ) { obj.src = srcParts.shift(); obj.opts.filter = srcParts.shift(); } } if ( obj.opts.smallBtn == 'auto' ) { if ( $.inArray( type, ['html', 'inline', 'ajax'] ) > -1 ) { obj.opts.toolbar = false; obj.opts.smallBtn = true; } else { obj.opts.smallBtn = false; } } // If the type is \"pdf\", then simply load file into iframe if ( type === 'pdf' ) { obj.type = 'iframe'; obj.opts.iframe.preload = false; } // Hide all buttons and disable interactivity for modal items if ( obj.opts.modal ) { obj.opts = $.extend(true, obj.opts, { // Remove buttons infobar : 0, toolbar : 0, smallBtn : 0, // Disable keyboard navigation keyboard : 0, // Disable some modules slideShow : 0, fullScreen : 0, thumbs : 0, touch : 0, // Disable click event handlers clickContent : false, clickSlide : false, clickOutside : false, dblclickContent : false, dblclickSlide : false, dblclickOutside : false }); } // Step 4 - Add processed object to group // ====================================== self.group.push( obj ); }); }, // Attach an event handler functions for: // - navigation buttons // - browser scrolling, resizing; // - focusing // - keyboard // - detect idle // ====================================== addEvents : function() { var self = this; self.removeEvents(); // Make navigation elements clickable self.$refs.container.on('click.fb-close', '[data-fancybox-close]', function(e) { e.stopPropagation(); e.preventDefault(); self.close( e ); }).on( 'click.fb-prev touchend.fb-prev', '[data-fancybox-prev]', function(e) { e.stopPropagation(); e.preventDefault(); self.previous(); }).on( 'click.fb-next touchend.fb-next', '[data-fancybox-next]', function(e) { e.stopPropagation(); e.preventDefault(); self.next(); }).on( 'click.fb', '[data-fancybox-zoom]', function(e) { // Click handler for zoom button self[ self.isScaledDown() ? 'scaleToActual' : 'scaleToFit' ](); }); // Handle page scrolling and browser resizing $W.on('orientationchange.fb resize.fb', function(e) { if ( e && e.originalEvent && e.originalEvent.type === \"resize\" ) { requestAFrame(function() { self.update(); }); } else { self.$refs.stage.hide(); setTimeout(function() { self.$refs.stage.show(); self.update(); }, 600); } }); // Trap keyboard focus inside of the modal, so the user does not accidentally tab outside of the modal // (a.k.a. \"escaping the modal\") $D.on('focusin.fb', function(e) { var instance = $.fancybox ? $.fancybox.getInstance() : null; if ( instance.isClosing || !instance.current || !instance.current.opts.trapFocus || $( e.target ).hasClass( 'fancybox-container' ) || $( e.target ).is( document ) ) { return; } if ( instance && $( e.target ).css( 'position' ) !== 'fixed' && !instance.$refs.container.has( e.target ).length ) { e.stopPropagation(); instance.focus(); // Sometimes page gets scrolled, set it back $W.scrollTop( self.scrollTop ).scrollLeft( self.scrollLeft ); } }); // Enable keyboard navigation $D.on('keydown.fb', function (e) { var current = self.current, keycode = e.keyCode || e.which; if ( !current || !current.opts.keyboard ) { return; } if ( $(e.target).is('input') || $(e.target).is('textarea') ) { return; } // Backspace and Esc keys if ( keycode === 8 || keycode === 27 ) { e.preventDefault(); self.close( e ); return; } // Left arrow and Up arrow if ( keycode === 37 || keycode === 38 ) { e.preventDefault(); self.previous(); return; } // Righ arrow and Down arrow if ( keycode === 39 || keycode === 40 ) { e.preventDefault(); self.next(); return; } self.trigger('afterKeydown', e, keycode); }); // Hide controls after some inactivity period if ( self.group[ self.currIndex ].opts.idleTime ) { self.idleSecondsCounter = 0; $D.on('mousemove.fb-idle mouseleave.fb-idle mousedown.fb-idle touchstart.fb-idle touchmove.fb-idle scroll.fb-idle keydown.fb-idle', function(e) { self.idleSecondsCounter = 0; if ( self.isIdle ) { self.showControls(); } self.isIdle = false; }); self.idleInterval = window.setInterval(function() { self.idleSecondsCounter++; if ( self.idleSecondsCounter >= self.group[ self.currIndex ].opts.idleTime ) { self.isIdle = true; self.idleSecondsCounter = 0; self.hideControls(); } }, 1000); } }, // Remove events added by the core // =============================== removeEvents : function() { var self = this; $W.off( 'orientationchange.fb resize.fb' ); $D.off( 'focusin.fb keydown.fb .fb-idle' ); this.$refs.container.off( '.fb-close .fb-prev .fb-next' ); if ( self.idleInterval ) { window.clearInterval( self.idleInterval ); self.idleInterval = null; } }, // Change to previous gallery item // =============================== previous : function( duration ) { return this.jumpTo( this.currPos - 1, duration ); }, // Change to next gallery item // =========================== next : function( duration ) { return this.jumpTo( this.currPos + 1, duration ); }, // Switch to selected gallery item // =============================== jumpTo : function ( pos, duration, slide ) { var self = this, firstRun, loop, current, previous, canvasWidth, currentPos, transitionProps; var groupLen = self.group.length; if ( self.isSliding || self.isClosing || ( self.isAnimating && self.firstRun ) ) { return; } pos = parseInt( pos, 10 ); loop = self.current ? self.current.opts.loop : self.opts.loop; if ( !loop && ( pos < 0 || pos >= groupLen ) ) { return false; } firstRun = self.firstRun = ( self.firstRun === null ); if ( groupLen < 2 && !firstRun && !!self.isSliding ) { return; } previous = self.current; self.prevIndex = self.currIndex; self.prevPos = self.currPos; // Create slides current = self.createSlide( pos ); if ( groupLen > 1 ) { if ( loop || current.index > 0 ) { self.createSlide( pos - 1 ); } if ( loop || current.index < groupLen - 1 ) { self.createSlide( pos + 1 ); } } self.current = current; self.currIndex = current.index; self.currPos = current.pos; self.trigger( 'beforeShow', firstRun ); self.updateControls(); currentPos = $.fancybox.getTranslate( current.$slide ); current.isMoved = ( currentPos.left !== 0 || currentPos.top !== 0 ) && !current.$slide.hasClass( 'fancybox-animated' ); current.forcedDuration = undefined; if ( $.isNumeric( duration ) ) { current.forcedDuration = duration; } else { duration = current.opts[ firstRun ? 'animationDuration' : 'transitionDuration' ]; } duration = parseInt( duration, 10 ); // Fresh start - reveal container, current slide and start loading content if ( firstRun ) { if ( current.opts.animationEffect && duration ) { self.$refs.container.css( 'transition-duration', duration + 'ms' ); } self.$refs.container.removeClass( 'fancybox-is-hidden' ); forceRedraw( self.$refs.container ); self.$refs.container.addClass( 'fancybox-is-open' ); // Make first slide visible (to display loading icon, if needed) current.$slide.addClass( 'fancybox-slide--current' ); self.loadSlide( current ); self.preload(); return; } // Clean up $.each(self.slides, function( index, slide ) { $.fancybox.stop( slide.$slide ); }); // Make current that slide is visible even if content is still loading current.$slide.removeClass( 'fancybox-slide--next fancybox-slide--previous' ).addClass( 'fancybox-slide--current' ); // If slides have been dragged, animate them to correct position if ( current.isMoved ) { canvasWidth = Math.round( current.$slide.width() ); $.each(self.slides, function( index, slide ) { var pos = slide.pos - current.pos; $.fancybox.animate( slide.$slide, { top : 0, left : ( pos * canvasWidth ) + ( pos * slide.opts.gutter ) }, duration, function() { slide.$slide.removeAttr('style').removeClass( 'fancybox-slide--next fancybox-slide--previous' ); if ( slide.pos === self.currPos ) { current.isMoved = false; self.complete(); } }); }); } else { self.$refs.stage.children().removeAttr( 'style' ); } // Start transition that reveals current content // or wait when it will be loaded if ( current.isLoaded ) { self.revealContent( current ); } else { self.loadSlide( current ); } self.preload(); if ( previous.pos === current.pos ) { return; } // Handle previous slide // ===================== transitionProps = 'fancybox-slide--' + ( previous.pos > current.pos ? 'next' : 'previous' ); previous.$slide.removeClass( 'fancybox-slide--complete fancybox-slide--current fancybox-slide--next fancybox-slide--previous' ); previous.isComplete = false; if ( !duration || ( !current.isMoved && !current.opts.transitionEffect ) ) { return; } if ( current.isMoved ) { previous.$slide.addClass( transitionProps ); } else { transitionProps = 'fancybox-animated ' + transitionProps + ' fancybox-fx-' + current.opts.transitionEffect; $.fancybox.animate( previous.$slide, transitionProps, duration, function() { previous.$slide.removeClass( transitionProps ).removeAttr( 'style' ); }); } }, // Create new \"slide\" element // These are gallery items that are actually added to DOM // ======================================================= createSlide : function( pos ) { var self = this; var $slide; var index; index = pos % self.group.length; index = index < 0 ? self.group.length + index : index; if ( !self.slides[ pos ] && self.group[ index ] ) { $slide = $('').appendTo( self.$refs.stage ); self.slides[ pos ] = $.extend( true, {}, self.group[ index ], { pos : pos, $slide : $slide, isLoaded : false, }); self.updateSlide( self.slides[ pos ] ); } return self.slides[ pos ]; }, // Scale image to the actual size of the image // =========================================== scaleToActual : function( x, y, duration ) { var self = this; var current = self.current; var $what = current.$content; var imgPos, posX, posY, scaleX, scaleY; var canvasWidth = parseInt( current.$slide.width(), 10 ); var canvasHeight = parseInt( current.$slide.height(), 10 ); var newImgWidth = current.width; var newImgHeight = current.height; if ( !( current.type == 'image' && !current.hasError) || !$what || self.isAnimating ) { return; } $.fancybox.stop( $what ); self.isAnimating = true; x = x === undefined ? canvasWidth * 0.5 : x; y = y === undefined ? canvasHeight * 0.5 : y; imgPos = $.fancybox.getTranslate( $what ); scaleX = newImgWidth / imgPos.width; scaleY = newImgHeight / imgPos.height; // Get center position for original image posX = ( canvasWidth * 0.5 - newImgWidth * 0.5 ); posY = ( canvasHeight * 0.5 - newImgHeight * 0.5 ); // Make sure image does not move away from edges if ( newImgWidth > canvasWidth ) { posX = imgPos.left * scaleX - ( ( x * scaleX ) - x ); if ( posX > 0 ) { posX = 0; } if ( posX < canvasWidth - newImgWidth ) { posX = canvasWidth - newImgWidth; } } if ( newImgHeight > canvasHeight) { posY = imgPos.top * scaleY - ( ( y * scaleY ) - y ); if ( posY > 0 ) { posY = 0; } if ( posY < canvasHeight - newImgHeight ) { posY = canvasHeight - newImgHeight; } } self.updateCursor( newImgWidth, newImgHeight ); $.fancybox.animate( $what, { top : posY, left : posX, scaleX : scaleX, scaleY : scaleY }, duration || 330, function() { self.isAnimating = false; }); // Stop slideshow if ( self.SlideShow && self.SlideShow.isActive ) { self.SlideShow.stop(); } }, // Scale image to fit inside parent element // ======================================== scaleToFit : function( duration ) { var self = this; var current = self.current; var $what = current.$content; var end; if ( !( current.type == 'image' && !current.hasError) || !$what || self.isAnimating ) { return; } $.fancybox.stop( $what ); self.isAnimating = true; end = self.getFitPos( current ); self.updateCursor( end.width, end.height ); $.fancybox.animate( $what, { top : end.top, left : end.left, scaleX : end.width / $what.width(), scaleY : end.height / $what.height() }, duration || 330, function() { self.isAnimating = false; }); }, // Calculate image size to fit inside viewport // =========================================== getFitPos : function( slide ) { var self = this; var $what = slide.$content; var imgWidth = slide.width; var imgHeight = slide.height; var margin = slide.opts.margin; var canvasWidth, canvasHeight, minRatio, width, height; if ( !$what || !$what.length || ( !imgWidth && !imgHeight) ) { return false; } // Convert \"margin to CSS style: [ top, right, bottom, left ] if ( $.type( margin ) === \"number\" ) { margin = [ margin, margin ]; } if ( margin.length == 2 ) { margin = [ margin[0], margin[1], margin[0], margin[1] ]; } // We can not use $slide width here, because it can have different diemensions while in transiton canvasWidth = parseInt( self.$refs.stage.width(), 10 ) - ( margin[ 1 ] + margin[ 3 ] ); canvasHeight = parseInt( self.$refs.stage.height(), 10 ) - ( margin[ 0 ] + margin[ 2 ] ); minRatio = Math.min(1, canvasWidth / imgWidth, canvasHeight / imgHeight ); width = Math.floor( minRatio * imgWidth ); height = Math.floor( minRatio * imgHeight ); // Use floor rounding to make sure it really fits return { top : Math.floor( ( canvasHeight - height ) * 0.5 ) + margin[ 0 ], left : Math.floor( ( canvasWidth - width ) * 0.5 ) + margin[ 3 ], width : width, height : height }; }, // Update position and content of all slides // ========================================= update : function() { var self = this; $.each( self.slides, function( key, slide ) { self.updateSlide( slide ); }); }, // Update slide position and scale content to fit // ============================================== updateSlide : function( slide ) { var self = this; var $what = slide.$content; if ( $what && ( slide.width || slide.height ) ) { self.isAnimating = false; $.fancybox.stop( $what ); $.fancybox.setTranslate( $what, self.getFitPos( slide ) ); if ( slide.pos === self.currPos ) { self.updateCursor(); } } slide.$slide.trigger( 'refresh' ); self.trigger( 'onUpdate', slide ); }, // Update cursor style depending if content can be zoomed // ====================================================== updateCursor : function( nextWidth, nextHeight ) { var self = this; var isScaledDown; var $container = self.$refs.container.removeClass( 'fancybox-is-zoomable fancybox-can-zoomIn fancybox-can-drag fancybox-can-zoomOut' ); if ( !self.current || self.isClosing ) { return; } if ( self.isZoomable() ) { $container.addClass( 'fancybox-is-zoomable' ); if ( nextWidth !== undefined && nextHeight !== undefined ) { isScaledDown = nextWidth < self.current.width && nextHeight < self.current.height; } else { isScaledDown = self.isScaledDown(); } if ( isScaledDown ) { // If image is scaled down, then, obviously, it can be zoomed to full size $container.addClass( 'fancybox-can-zoomIn' ); } else { if ( self.current.opts.touch ) { // If image size ir largen than available available and touch module is not disable, // then user can do panning $container.addClass( 'fancybox-can-drag' ); } else { $container.addClass( 'fancybox-can-zoomOut' ); } } } else if ( self.current.opts.touch ) { $container.addClass( 'fancybox-can-drag' ); } }, // Check if current slide is zoomable // ================================== isZoomable : function() { var self = this; var current = self.current; var fitPos; if ( !current || self.isClosing ) { return; } // Assume that slide is zoomable if // - image is loaded successfuly // - click action is \"zoom\" // - actual size of the image is smaller than available area if ( current.type === 'image' && current.isLoaded && !current.hasError && ( current.opts.clickContent === 'zoom' || ( $.isFunction( current.opts.clickContent ) && current.opts.clickContent( current ) === \"zoom\" ) ) ) { fitPos = self.getFitPos( current ); if ( current.width > fitPos.width || current.height > fitPos.height ) { return true; } } return false; }, // Check if current image dimensions are smaller than actual // ========================================================= isScaledDown : function() { var self = this; var current = self.current; var $what = current.$content; var rez = false; if ( $what ) { rez = $.fancybox.getTranslate( $what ); rez = rez.width < current.width || rez.height < current.height; } return rez; }, // Check if image dimensions exceed parent element // =============================================== canPan : function() { var self = this; var current = self.current; var $what = current.$content; var rez = false; if ( $what ) { rez = self.getFitPos( current ); rez = Math.abs( $what.width() - rez.width ) > 1 || Math.abs( $what.height() - rez.height ) > 1; } return rez; }, // Load content into the slide // =========================== loadSlide : function( slide ) { var self = this, type, $slide; var ajaxLoad; if ( slide.isLoading ) { return; } if ( slide.isLoaded ) { return; } slide.isLoading = true; self.trigger( 'beforeLoad', slide ); type = slide.type; $slide = slide.$slide; $slide .off( 'refresh' ) .trigger( 'onReset' ) .addClass( 'fancybox-slide--' + ( type || 'unknown' ) ) .addClass( slide.opts.slideClass ); // Create content depending on the type switch ( type ) { case 'image': self.setImage( slide ); break; case 'iframe': self.setIframe( slide ); break; case 'html': self.setContent( slide, slide.src || slide.content ); break; case 'inline': if ( $( slide.src ).length ) { self.setContent( slide, $( slide.src ) ); } else { self.setError( slide ); } break; case 'ajax': self.showLoading( slide ); ajaxLoad = $.ajax( $.extend( {}, slide.opts.ajax.settings, { url : slide.src, success : function ( data, textStatus ) { if ( textStatus === 'success' ) { self.setContent( slide, data ); } }, error : function ( jqXHR, textStatus ) { if ( jqXHR && textStatus !== 'abort' ) { self.setError( slide ); } } })); $slide.one( 'onReset', function () { ajaxLoad.abort(); }); break; default: self.setError( slide ); break; } return true; }, // Use thumbnail image, if possible // ================================ setImage : function( slide ) { var self = this; var srcset = slide.opts.srcset || slide.opts.image.srcset; var found, temp, pxRatio, windowWidth; // If we have \"srcset\", then we need to find matching \"src\" value. // This is necessary, because when you set an src attribute, the browser will preload the image // before any javascript or even CSS is applied. if ( srcset ) { pxRatio = window.devicePixelRatio || 1; windowWidth = window.innerWidth * pxRatio; temp = srcset.split(',').map(function ( el ) { var ret = {}; el.trim().split(/\\s+/).forEach(function ( el, i ) { var value = parseInt( el.substring(0, el.length - 1), 10 ); if ( i === 0 ) { return ( ret.url = el ); } if ( value ) { ret.value = value; ret.postfix = el[ el.length - 1 ]; } }); return ret; }); // Sort by value temp.sort(function (a, b) { return a.value - b.value; }); // Ok, now we have an array of all srcset values for ( var j = 0; j < temp.length; j++ ) { var el = temp[ j ]; if ( ( el.postfix === 'w' && el.value >= windowWidth ) || ( el.postfix === 'x' && el.value >= pxRatio ) ) { found = el; break; } } // If not found, take the last one if ( !found && temp.length ) { found = temp[ temp.length - 1 ]; } if ( found ) { slide.src = found.url; // If we have default width/height values, we can calculate height for matching source if ( slide.width && slide.height && found.postfix == 'w' ) { slide.height = ( slide.width / slide.height ) * found.value; slide.width = found.value; } } } // This will be wrapper containing both ghost and actual image slide.$content = $('') .addClass( 'fancybox-is-hidden' ) .appendTo( slide.$slide ); // If we have a thumbnail, we can display it while actual image is loading // Users will not stare at black screen and actual image will appear gradually if ( slide.opts.preload !== false && slide.opts.width && slide.opts.height && ( slide.opts.thumb || slide.opts.$thumb ) ) { slide.width = slide.opts.width; slide.height = slide.opts.height; slide.$ghost = $('') .one('error', function() { $(this).remove(); slide.$ghost = null; self.setBigImage( slide ); }) .one('load', function() { self.afterLoad( slide ); self.setBigImage( slide ); }) .addClass( 'fancybox-image' ) .appendTo( slide.$content ) .attr( 'src', slide.opts.thumb || slide.opts.$thumb.attr( 'src' ) ); } else { self.setBigImage( slide ); } }, // Create full-size image // ====================== setBigImage : function ( slide ) { var self = this; var $img = $(''); slide.$image = $img .one('error', function() { self.setError( slide ); }) .one('load', function() { // Clear timeout that checks if loading icon needs to be displayed clearTimeout( slide.timouts ); slide.timouts = null; if ( self.isClosing ) { return; } slide.width = this.naturalWidth; slide.height = this.naturalHeight; if ( slide.opts.image.srcset ) { $img.attr( 'sizes', '100vw' ).attr( 'srcset', slide.opts.image.srcset ); } self.hideLoading( slide ); if ( slide.$ghost ) { slide.timouts = setTimeout(function() { slide.timouts = null; slide.$ghost.hide(); }, Math.min( 300, Math.max( 1000, slide.height / 1600 ) ) ); } else { self.afterLoad( slide ); } }) .addClass( 'fancybox-image' ) .attr('src', slide.src) .appendTo( slide.$content ); if ( ( $img[0].complete || $img[0].readyState == \"complete\" ) && $img[0].naturalWidth && $img[0].naturalHeight ) { $img.trigger( 'load' ); } else if( $img[0].error ) { $img.trigger( 'error' ); } else { slide.timouts = setTimeout(function() { if ( !$img[0].complete && !slide.hasError ) { self.showLoading( slide ); } }, 100); } }, // Create iframe wrapper, iframe and bindings // ========================================== setIframe : function( slide ) { var self = this, opts = slide.opts.iframe, $slide = slide.$slide, $iframe; slide.$content = $('') .css( opts.css ) .appendTo( $slide ); $iframe = $( opts.tpl.replace(/\\{rnd\\}/g, new Date().getTime()) ) .attr( opts.attr ) .appendTo( slide.$content ); if ( opts.preload ) { self.showLoading( slide ); // Unfortunately, it is not always possible to determine if iframe is successfully loaded // (due to browser security policy) $iframe.on('load.fb error.fb', function(e) { this.isReady = 1; slide.$slide.trigger( 'refresh' ); self.afterLoad( slide ); }); // Recalculate iframe content size // =============================== $slide.on('refresh.fb', function() { var $wrap = slide.$content, frameWidth = opts.css.width, frameHeight = opts.css.height, scrollWidth, $contents, $body; if ( $iframe[0].isReady !== 1 ) { return; } // Check if content is accessible, // it will fail if frame is not with the same origin try { $contents = $iframe.contents(); $body = $contents.find('body'); } catch (ignore) {} // Calculate dimensions for the wrapper if ( $body && $body.length ) { if ( frameWidth === undefined ) { scrollWidth = $iframe[0].contentWindow.document.documentElement.scrollWidth; frameWidth = Math.ceil( $body.outerWidth(true) + ( $wrap.width() - scrollWidth ) ); frameWidth += $wrap.outerWidth() - $wrap.innerWidth(); } if ( frameHeight === undefined ) { frameHeight = Math.ceil( $body.outerHeight(true) ); frameHeight += $wrap.outerHeight() - $wrap.innerHeight(); } // Resize wrapper to fit iframe content if ( frameWidth ) { $wrap.width( frameWidth ); } if ( frameHeight ) { $wrap.height( frameHeight ); } } $wrap.removeClass( 'fancybox-is-hidden' ); }); } else { this.afterLoad( slide ); } $iframe.attr( 'src', slide.src ); if ( slide.opts.smallBtn === true ) { slide.$content.prepend( self.translate( slide, slide.opts.btnTpl.smallBtn ) ); } // Remove iframe if closing or changing gallery item $slide.one( 'onReset', function () { // This helps IE not to throw errors when closing try { $( this ).find( 'iframe' ).hide().attr( 'src', '//about:blank' ); } catch ( ignore ) {} $( this ).empty(); slide.isLoaded = false; }); }, // Wrap and append content to the slide // ====================================== setContent : function ( slide, content ) { var self = this; if ( self.isClosing ) { return; } self.hideLoading( slide ); slide.$slide.empty(); if ( isQuery( content ) && content.parent().length ) { // If content is a jQuery object, then it will be moved to the slide. // The placeholder is created so we will know where to put it back. // If user is navigating gallery fast, then the content might be already inside fancyBox // ===================================================================================== // Make sure content is not already moved to fancyBox content.parent( '.fancybox-slide--inline' ).trigger( 'onReset' ); // Create temporary element marking original place of the content slide.$placeholder = $( '' ).hide().insertAfter( content ); // Make sure content is visible content.css('display', 'inline-block'); } else if ( !slide.hasError ) { // If content is just a plain text, try to convert it to html if ( $.type( content ) === 'string' ) { content = $('').append( $.trim( content ) ).contents(); // If we have text node, then add wrapping element to make vertical alignment work if ( content[0].nodeType === 3 ) { content = $('').html( content ); } } // If \"filter\" option is provided, then filter content if ( slide.opts.filter ) { content = $('').html( content ).find( slide.opts.filter ); } } slide.$slide.one('onReset', function () { // Put content back if ( slide.$placeholder ) { slide.$placeholder.after( content.hide() ).remove(); slide.$placeholder = null; } // Remove custom close button if ( slide.$smallBtn ) { slide.$smallBtn.remove(); slide.$smallBtn = null; } // Remove content and mark slide as not loaded if ( !slide.hasError ) { $(this).empty(); slide.isLoaded = false; } }); slide.$content = $( content ).appendTo( slide.$slide ); this.afterLoad( slide ); }, // Display error message // ===================== setError : function ( slide ) { slide.hasError = true; slide.$slide.removeClass( 'fancybox-slide--' + slide.type ); this.setContent( slide, this.translate( slide, slide.opts.errorTpl ) ); }, // Show loading icon inside the slide // ================================== showLoading : function( slide ) { var self = this; slide = slide || self.current; if ( slide && !slide.$spinner ) { slide.$spinner = $( self.opts.spinnerTpl ).appendTo( slide.$slide ); } }, // Remove loading icon from the slide // ================================== hideLoading : function( slide ) { var self = this; slide = slide || self.current; if ( slide && slide.$spinner ) { slide.$spinner.remove(); delete slide.$spinner; } }, // Adjustments after slide content has been loaded // =============================================== afterLoad : function( slide ) { var self = this; if ( self.isClosing ) { return; } slide.isLoading = false; slide.isLoaded = true; self.trigger( 'afterLoad', slide ); self.hideLoading( slide ); if ( slide.opts.smallBtn && !slide.$smallBtn ) { slide.$smallBtn = $( self.translate( slide, slide.opts.btnTpl.smallBtn ) ).appendTo( slide.$content.filter('div,form').first() ); } if ( slide.opts.protect && slide.$content && !slide.hasError ) { // Disable right click slide.$content.on( 'contextmenu.fb', function( e ) { if ( e.button == 2 ) { e.preventDefault(); } return true; }); // Add fake element on top of the image // This makes a bit harder for user to select image if ( slide.type === 'image' ) { $( '' ).appendTo( slide.$content ); } } self.revealContent( slide ); }, // Make content visible // This method is called right after content has been loaded or // user navigates gallery and transition should start // ============================================================ revealContent : function( slide ) { var self = this; var $slide = slide.$slide; var effect, effectClassName, duration, opacity, end, start = false; effect = slide.opts[ self.firstRun ? 'animationEffect' : 'transitionEffect' ]; duration = slide.opts[ self.firstRun ? 'animationDuration' : 'transitionDuration' ]; duration = parseInt( slide.forcedDuration === undefined ? duration : slide.forcedDuration, 10 ); if ( slide.isMoved || slide.pos !== self.currPos || !duration ) { effect = false; } // Check if can zoom if ( effect === 'zoom' && !( slide.pos === self.currPos && duration && slide.type === 'image' && !slide.hasError && ( start = self.getThumbPos( slide ) ) ) ) { effect = 'fade'; } // Zoom animation // ============== if ( effect === 'zoom' ) { end = self.getFitPos( slide ); end.scaleX = end.width / start.width; end.scaleY = end.height / start.height; delete end.width; delete end.height; // Check if we need to animate opacity opacity = slide.opts.zoomOpacity; if ( opacity == 'auto' ) { opacity = Math.abs( slide.width / slide.height - start.width / start.height ) > 0.1; } if ( opacity ) { start.opacity = 0.1; end.opacity = 1; } // Draw image at start position $.fancybox.setTranslate( slide.$content.removeClass( 'fancybox-is-hidden' ), start ); forceRedraw( slide.$content ); // Start animation $.fancybox.animate( slide.$content, end, duration, function() { self.complete(); }); return; } self.updateSlide( slide ); // Simply show content // =================== if ( !effect ) { forceRedraw( $slide ); slide.$content.removeClass( 'fancybox-is-hidden' ); if ( slide.pos === self.currPos ) { self.complete(); } return; } $.fancybox.stop( $slide ); effectClassName = 'fancybox-animated fancybox-slide--' + ( slide.pos >= self.prevPos ? 'next' : 'previous' ) + ' fancybox-fx-' + effect; $slide.removeAttr( 'style' ).removeClass( 'fancybox-slide--current fancybox-slide--next fancybox-slide--previous' ).addClass( effectClassName ); slide.$content.removeClass( 'fancybox-is-hidden' ); //Force reflow for CSS3 transitions forceRedraw( $slide ); $.fancybox.animate( $slide, 'fancybox-slide--current', duration, function(e) { $slide.removeClass( effectClassName ).removeAttr( 'style' ); if ( slide.pos === self.currPos ) { self.complete(); } }, true); }, // Check if we can and have to zoom from thumbnail //================================================ getThumbPos : function( slide ) { var self = this; var rez = false; // Check if element is inside the viewport by at least 1 pixel var isElementVisible = function( $el ) { var element = $el[0]; var elementRect = element.getBoundingClientRect(); var parentRects = []; var visibleInAllParents; while ( element.parentElement !== null ) { if ( $(element.parentElement).css('overflow') === 'hidden' || $(element.parentElement).css('overflow') === 'auto' ) { parentRects.push(element.parentElement.getBoundingClientRect()); } element = element.parentElement; } visibleInAllParents = parentRects.every(function(parentRect){ var visiblePixelX = Math.min(elementRect.right, parentRect.right) - Math.max(elementRect.left, parentRect.left); var visiblePixelY = Math.min(elementRect.bottom, parentRect.bottom) - Math.max(elementRect.top, parentRect.top); return visiblePixelX > 0 && visiblePixelY > 0; }); return visibleInAllParents && elementRect.bottom > 0 && elementRect.right > 0 && elementRect.left < $(window).width() && elementRect.top < $(window).height(); }; var $thumb = slide.opts.$thumb; var thumbPos = $thumb ? $thumb.offset() : 0; var slidePos; if ( thumbPos && $thumb[0].ownerDocument === document && isElementVisible( $thumb ) ) { slidePos = self.$refs.stage.offset(); rez = { top : thumbPos.top - slidePos.top + parseFloat( $thumb.css( \"border-top-width\" ) || 0 ), left : thumbPos.left - slidePos.left + parseFloat( $thumb.css( \"border-left-width\" ) || 0 ), width : $thumb.width(), height : $thumb.height(), scaleX : 1, scaleY : 1 }; } return rez; }, // Final adjustments after current gallery item is moved to position // and it`s content is loaded // ================================================================== complete : function() { var self = this; var current = self.current; var slides = {}; if ( current.isMoved || !current.isLoaded || current.isComplete ) { return; } current.isComplete = true; current.$slide.siblings().trigger( 'onReset' ); // Trigger any CSS3 transiton inside the slide forceRedraw( current.$slide ); current.$slide.addClass( 'fancybox-slide--complete' ); // Remove unnecessary slides $.each( self.slides, function( key, slide ) { if ( slide.pos >= self.currPos - 1 && slide.pos 1 ) ) .toggleClass( 'fancybox-show-nav', !!( opts.arrows && self.group.length > 1 ) ) .toggleClass( 'fancybox-is-modal', !!opts.modal ); if ( self.$caption ) { $container.addClass( 'fancybox-show-caption '); } else { $container.removeClass( 'fancybox-show-caption' ); } }, // Toggle toolbar and caption // ========================== toggleControls : function() { if ( this.isHiddenControls ) { this.showControls(); } else { this.hideControls(); } }, }); $.fancybox = { version : \"3.2.5\", defaults : defaults, // Get current instance and execute a command. // // Examples of usage: // // $instance = $.fancybox.getInstance(); // $.fancybox.getInstance().jumpTo( 1 ); // $.fancybox.getInstance( 'jumpTo', 1 ); // $.fancybox.getInstance( function() { // console.info( this.currIndex ); // }); // ====================================================== getInstance : function ( command ) { var instance = $('.fancybox-container:not(\".fancybox-is-closing\"):last').data( 'FancyBox' ); var args = Array.prototype.slice.call(arguments, 1); if ( instance instanceof FancyBox ) { if ( $.type( command ) === 'string' ) { instance[ command ].apply( instance, args ); } else if ( $.type( command ) === 'function' ) { command.apply( instance, args ); } return instance; } return false; }, // Create new instance // =================== open : function ( items, opts, index ) { return new FancyBox( items, opts, index ); }, // Close current or all instances // ============================== close : function ( all ) { var instance = this.getInstance(); if ( instance ) { instance.close(); // Try to find and close next instance if ( all === true ) { this.close(); } } }, // Close instances and unbind all events // ============================== destroy : function() { this.close( true ); $D.off( 'click.fb-start' ); }, // Try to detect mobile devices // ============================ isMobile : document.createTouch !== undefined && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent), // Detect if 'translate3d' support is available // ============================================ use3d : (function() { var div = document.createElement('div'); return window.getComputedStyle && window.getComputedStyle( div ).getPropertyValue('transform') && !(document.documentMode && document.documentMode < 11); }()), // Helper function to get current visual state of an element // returns array[ top, left, horizontal-scale, vertical-scale, opacity ] // ===================================================================== getTranslate : function( $el ) { var matrix; if ( !$el || !$el.length ) { return false; } matrix = $el.eq( 0 ).css('transform'); if ( matrix && matrix.indexOf( 'matrix' ) !== -1 ) { matrix = matrix.split('(')[1]; matrix = matrix.split(')')[0]; matrix = matrix.split(','); } else { matrix = []; } if ( matrix.length ) { // If IE if ( matrix.length > 10 ) { matrix = [ matrix[13], matrix[12], matrix[0], matrix[5] ]; } else { matrix = [ matrix[5], matrix[4], matrix[0], matrix[3]]; } matrix = matrix.map(parseFloat); } else { matrix = [ 0, 0, 1, 1 ]; var transRegex = /\\.*translate\\((.*)px,(.*)px\\)/i; var transRez = transRegex.exec( $el.eq( 0 ).attr('style') ); if ( transRez ) { matrix[ 0 ] = parseFloat( transRez[2] ); matrix[ 1 ] = parseFloat( transRez[1] ); } } return { top : matrix[ 0 ], left : matrix[ 1 ], scaleX : matrix[ 2 ], scaleY : matrix[ 3 ], opacity : parseFloat( $el.css('opacity') ), width : $el.width(), height : $el.height() }; }, // Shortcut for setting \"translate3d\" properties for element // Can set be used to set opacity, too // ======================================================== setTranslate : function( $el, props ) { var str = ''; var css = {}; if ( !$el || !props ) { return; } if ( props.left !== undefined || props.top !== undefined ) { str = ( props.left === undefined ? $el.position().left : props.left ) + 'px, ' + ( props.top === undefined ? $el.position().top : props.top ) + 'px'; if ( this.use3d ) { str = 'translate3d(' + str + ', 0px)'; } else { str = 'translate(' + str + ')'; } } if ( props.scaleX !== undefined && props.scaleY !== undefined ) { str = (str.length ? str + ' ' : '') + 'scale(' + props.scaleX + ', ' + props.scaleY + ')'; } if ( str.length ) { css.transform = str; } if ( props.opacity !== undefined ) { css.opacity = props.opacity; } if ( props.width !== undefined ) { css.width = props.width; } if ( props.height !== undefined ) { css.height = props.height; } return $el.css( css ); }, // Simple CSS transition handler // ============================= animate : function ( $el, to, duration, callback, leaveAnimationName ) { if ( $.isFunction( duration ) ) { callback = duration; duration = null; } if ( !$.isPlainObject( to ) ) { $el.removeAttr('style'); } $el.on( transitionEnd, function(e) { // Skip events from child elements and z-index change if ( e && e.originalEvent && ( !$el.is( e.originalEvent.target ) || e.originalEvent.propertyName == 'z-index' ) ) { return; } $.fancybox.stop( $el ); if ( $.isPlainObject( to ) ) { if ( to.scaleX !== undefined && to.scaleY !== undefined ) { $el.css( 'transition-duration', '' ); to.width = Math.round( $el.width() * to.scaleX ); to.height = Math.round( $el.height() * to.scaleY ); to.scaleX = 1; to.scaleY = 1; $.fancybox.setTranslate( $el, to ); } } else if ( leaveAnimationName !== true ) { $el.removeClass( to ); } if ( $.isFunction( callback ) ) { callback( e ); } }); if ( $.isNumeric( duration ) ) { $el.css( 'transition-duration', duration + 'ms' ); } if ( $.isPlainObject( to ) ) { $.fancybox.setTranslate( $el, to ); } else { $el.addClass( to ); } if ( to.scaleX && $el.hasClass( 'fancybox-image-wrap' ) ) { $el.parent().addClass( 'fancybox-is-scaling' ); } // Make sure that `transitionend` callback gets fired $el.data(\"timer\", setTimeout(function() { $el.trigger( 'transitionend' ); }, duration + 16)); }, stop : function( $el ) { clearTimeout( $el.data(\"timer\") ); $el.off( 'transitionend' ).css( 'transition-duration', '' ); if ( $el.hasClass( 'fancybox-image-wrap' ) ) { $el.parent().removeClass( 'fancybox-is-scaling' ); } } }; // Default click handler for \"fancyboxed\" links // ============================================ function _run( e ) { var $target = $( e.currentTarget ), opts = e.data ? e.data.options : {}, value = $target.attr( 'data-fancybox' ) || '', index = 0, items = []; // Avoid opening multiple times if ( e.isDefaultPrevented() ) { return; } e.preventDefault(); // Get all related items and find index for clicked one if ( value ) { items = opts.selector ? $( opts.selector ) : ( e.data ? e.data.items : [] ); items = items.length ? items.filter( '[data-fancybox=\"' + value + '\"]' ) : $( '[data-fancybox=\"' + value + '\"]' ); index = items.index( $target ); // Sometimes current item can not be found // (for example, when slider clones items) if ( index < 0 ) { index = 0; } } else { items = [ $target ]; } $.fancybox.open( items, opts, index ); } // Create a jQuery plugin // ====================== $.fn.fancybox = function (options) { var selector; options = options || {}; selector = options.selector || false; if ( selector ) { $( 'body' ).off( 'click.fb-start', selector ).on( 'click.fb-start', selector, { options : options }, _run ); } else { this.off( 'click.fb-start' ).on( 'click.fb-start', { items : this, options : options }, _run); } return this; }; // Self initializing plugin // ======================== $D.on( 'click.fb-start', '[data-fancybox]', _run ); }( window, document, window.jQuery || jQuery )); // ========================================================================== // // Media // Adds additional media type support // // ========================================================================== ;(function ($) { 'use strict'; // Formats matching url to final form var format = function (url, rez, params) { if ( !url ) { return; } params = params || ''; if ( $.type(params) === \"object\" ) { params = $.param(params, true); } $.each(rez, function (key, value) { url = url.replace('$' + key, value || ''); }); if (params.length) { url += (url.indexOf('?') > 0 ? '&' : '?') + params; } return url; }; // Object containing properties for each media type var defaults = { youtube : { matcher : /(youtube\\.com|youtu\\.be|youtube\\-nocookie\\.com)\\/(watch\\?(.*&)?v=|v\\/|u\\/|embed\\/?)?(videoseries\\?list=(.*)|[\\w-]{11}|\\?listType=(.*)&list=(.*))(.*)/i, params : { autoplay : 1, autohide : 1, fs : 1, rel : 0, hd : 1, wmode : 'transparent', enablejsapi : 1, html5 : 1 }, paramPlace : 8, type : 'iframe', url : '//www.youtube.com/embed/$4', thumb : '//img.youtube.com/vi/$4/hqdefault.jpg' }, vimeo : { matcher : /^.+vimeo.com\\/(.*\\/)?([\\d]+)(.*)?/, params : { autoplay : 1, hd : 1, show_title : 1, show_byline : 1, show_portrait : 0, fullscreen : 1, api : 1 }, paramPlace : 3, type : 'iframe', url : '//player.vimeo.com/video/$2' }, metacafe : { matcher : /metacafe.com\\/watch\\/(\\d+)\\/(.*)?/, type : 'iframe', url : '//www.metacafe.com/embed/$1/?ap=1' }, dailymotion : { matcher : /dailymotion.com\\/video\\/(.*)\\/?(.*)/, params : { additionalInfos : 0, autoStart : 1 }, type : 'iframe', url : '//www.dailymotion.com/embed/video/$1' }, vine : { matcher : /vine.co\\/v\\/([a-zA-Z0-9\\?\\=\\-]+)/, type : 'iframe', url : '//vine.co/v/$1/embed/simple' }, instagram : { matcher : /(instagr\\.am|instagram\\.com)\\/p\\/([a-zA-Z0-9_\\-]+)\\/?/i, type : 'image', url : '//$1/p/$2/media/?size=l' }, // Examples: // http://maps.google.com/?ll=48.857995,2.294297&spn=0.007666,0.021136&t=m&z=16 // https://www.google.com/maps/@37.7852006,-122.4146355,14.65z // https://www.google.com/maps/place/Googleplex/@37.4220041,-122.0833494,17z/data=!4m5!3m4!1s0x0:0x6c296c66619367e0!8m2!3d37.4219998!4d-122.0840572 gmap_place : { matcher : /(maps\\.)?google\\.([a-z]{2,3}(\\.[a-z]{2})?)\\/(((maps\\/(place\\/(.*)\\/)?\\@(.*),(\\d+.?\\d+?)z))|(\\?ll=))(.*)?/i, type : 'iframe', url : function (rez) { return '//maps.google.' + rez[2] + '/?ll=' + ( rez[9] ? rez[9] + '&z=' + Math.floor( rez[10] ) + ( rez[12] ? rez[12].replace(/^\\//, \"&\") : '' ) : rez[12] ) + '&output=' + ( rez[12] && rez[12].indexOf('layer=c') > 0 ? 'svembed' : 'embed' ); } }, // Examples: // https://www.google.com/maps/search/Empire+State+Building/ // https://www.google.com/maps/search/?api=1&query=centurylink+field // https://www.google.com/maps/search/?api=1&query=47.5951518,-122.3316393 gmap_search : { matcher : /(maps\\.)?google\\.([a-z]{2,3}(\\.[a-z]{2})?)\\/(maps\\/search\\/)(.*)/i, type : 'iframe', url : function (rez) { return '//maps.google.' + rez[2] + '/maps?q=' + rez[5].replace('query=', 'q=').replace('api=1', '') + '&output=embed'; } } }; $(document).on('objectNeedsType.fb', function (e, instance, item) { var url = item.src || '', type = false, media, thumb, rez, params, urlParams, paramObj, provider; media = $.extend( true, {}, defaults, item.opts.media ); // Look for any matching media type $.each(media, function ( providerName, providerOpts ) { rez = url.match( providerOpts.matcher ); if ( !rez ) { return; } type = providerOpts.type; paramObj = {}; if ( providerOpts.paramPlace && rez[ providerOpts.paramPlace ] ) { urlParams = rez[ providerOpts.paramPlace ]; if ( urlParams[ 0 ] == '?' ) { urlParams = urlParams.substring(1); } urlParams = urlParams.split('&'); for ( var m = 0; m < urlParams.length; ++m ) { var p = urlParams[ m ].split('=', 2); if ( p.length == 2 ) { paramObj[ p[0] ] = decodeURIComponent( p[1].replace(/\\+/g, \" \") ); } } } params = $.extend( true, {}, providerOpts.params, item.opts[ providerName ], paramObj ); url = $.type( providerOpts.url ) === \"function\" ? providerOpts.url.call( this, rez, params, item ) : format( providerOpts.url, rez, params ); thumb = $.type( providerOpts.thumb ) === \"function\" ? providerOpts.thumb.call( this, rez, params, item ) : format( providerOpts.thumb, rez ); if ( providerName === 'vimeo' ) { url = url.replace('&%23', '#'); } return false; }); // If it is found, then change content type and update the url if ( type ) { item.src = url; item.type = type; if ( !item.opts.thumb && !( item.opts.$thumb && item.opts.$thumb.length ) ) { item.opts.thumb = thumb; } if ( type === 'iframe' ) { $.extend(true, item.opts, { iframe : { preload : false, attr : { scrolling : \"no\" } } }); item.contentProvider = provider; item.opts.slideClass += ' fancybox-slide--' + ( provider == 'gmap_place' || provider == 'gmap_search' ? 'map' : 'video' ); } } else if ( url ) { item.type = item.opts.defaultType; } }); }( window.jQuery || jQuery )); // ========================================================================== // // Guestures // Adds touch guestures, handles click and tap events // // ========================================================================== ;(function (window, document, $) { 'use strict'; var requestAFrame = (function () { return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || // if all else fails, use setTimeout function (callback) { return window.setTimeout(callback, 1000 / 60); }; })(); var cancelAFrame = (function () { return window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.oCancelAnimationFrame || function (id) { window.clearTimeout(id); }; })(); var pointers = function( e ) { var result = []; e = e.originalEvent || e || window.e; e = e.touches && e.touches.length ? e.touches : ( e.changedTouches && e.changedTouches.length ? e.changedTouches : [ e ] ); for ( var key in e ) { if ( e[ key ].pageX ) { result.push( { x : e[ key ].pageX, y : e[ key ].pageY } ); } else if ( e[ key ].clientX ) { result.push( { x : e[ key ].clientX, y : e[ key ].clientY } ); } } return result; }; var distance = function( point2, point1, what ) { if ( !point1 || !point2 ) { return 0; } if ( what === 'x' ) { return point2.x - point1.x; } else if ( what === 'y' ) { return point2.y - point1.y; } return Math.sqrt( Math.pow( point2.x - point1.x, 2 ) + Math.pow( point2.y - point1.y, 2 ) ); }; var isClickable = function( $el ) { if ( $el.is('a,area,button,[role=\"button\"],input,label,select,summary,textarea') || $.isFunction( $el.get(0).onclick ) || $el.data('selectable') ) { return true; } // Check for attributes like data-fancybox-next or data-fancybox-close for ( var i = 0, atts = $el[0].attributes, n = atts.length; i < n; i++ ) { if ( atts[i].nodeName.substr(0, 14) === 'data-fancybox-' ) { return true; } } return false; }; var hasScrollbars = function( el ) { var overflowY = window.getComputedStyle( el )['overflow-y']; var overflowX = window.getComputedStyle( el )['overflow-x']; var vertical = (overflowY === 'scroll' || overflowY === 'auto') && el.scrollHeight > el.clientHeight; var horizontal = (overflowX === 'scroll' || overflowX === 'auto') && el.scrollWidth > el.clientWidth; return vertical || horizontal; }; var isScrollable = function ( $el ) { var rez = false; while ( true ) { rez = hasScrollbars( $el.get(0) ); if ( rez ) { break; } $el = $el.parent(); if ( !$el.length || $el.hasClass( 'fancybox-stage' ) || $el.is( 'body' ) ) { break; } } return rez; }; var Guestures = function ( instance ) { var self = this; self.instance = instance; self.$bg = instance.$refs.bg; self.$stage = instance.$refs.stage; self.$container = instance.$refs.container; self.destroy(); self.$container.on( 'touchstart.fb.touch mousedown.fb.touch', $.proxy(self, 'ontouchstart') ); }; Guestures.prototype.destroy = function() { this.$container.off( '.fb.touch' ); }; Guestures.prototype.ontouchstart = function( e ) { var self = this; var $target = $( e.target ); var instance = self.instance; var current = instance.current; var $content = current.$content; var isTouchDevice = ( e.type == 'touchstart' ); // Do not respond to both events if ( isTouchDevice ) { self.$container.off( 'mousedown.fb.touch' ); } // Ignore clicks while zooming or closing if ( !current || self.instance.isAnimating || self.instance.isClosing ) { e.stopPropagation(); e.preventDefault(); return; } // Ignore right click if ( e.originalEvent && e.originalEvent.button == 2 ) { return; } // Ignore taping on links, buttons, input elements if ( !$target.length || isClickable( $target ) || isClickable( $target.parent() ) ) { return; } // Ignore clicks on the scrollbar if ( e.originalEvent.clientX > $target[0].clientWidth + $target.offset().left ) { return; } self.startPoints = pointers( e ); // Prevent zooming if already swiping if ( !self.startPoints || ( self.startPoints.length > 1 && instance.isSliding ) ) { return; } self.$target = $target; self.$content = $content; self.canTap = true; self.opts = current.opts.touch; $(document).off( '.fb.touch' ); $(document).on( isTouchDevice ? 'touchend.fb.touch touchcancel.fb.touch' : 'mouseup.fb.touch mouseleave.fb.touch', $.proxy(self, \"ontouchend\")); $(document).on( isTouchDevice ? 'touchmove.fb.touch' : 'mousemove.fb.touch', $.proxy(self, \"ontouchmove\")); if ( !(self.opts || instance.canPan() ) || !( $target.is( self.$stage ) || self.$stage.find( $target ).length ) ) { // Prevent ghosting if ( $target.is('img') ) { e.preventDefault(); } return; } e.stopPropagation(); if ( !( $.fancybox.isMobile && ( isScrollable( self.$target ) || isScrollable( self.$target.parent() ) ) ) ) { e.preventDefault(); } self.canvasWidth = Math.round( current.$slide[0].clientWidth ); self.canvasHeight = Math.round( current.$slide[0].clientHeight ); self.startTime = new Date().getTime(); self.distanceX = self.distanceY = self.distance = 0; self.isPanning = false; self.isSwiping = false; self.isZooming = false; self.sliderStartPos = self.sliderLastPos || { top: 0, left: 0 }; self.contentStartPos = $.fancybox.getTranslate( self.$content ); self.contentLastPos = null; if ( self.startPoints.length === 1 && !self.isZooming ) { self.canTap = !instance.isSliding; if ( current.type === 'image' && ( self.contentStartPos.width > self.canvasWidth + 1 || self.contentStartPos.height > self.canvasHeight + 1 ) ) { $.fancybox.stop( self.$content ); self.$content.css( 'transition-duration', '0ms' ); self.isPanning = true; } else { self.isSwiping = true; } self.$container.addClass('fancybox-controls--isGrabbing'); } if ( self.startPoints.length === 2 && !instance.isAnimating && !current.hasError && current.type === 'image' && ( current.isLoaded || current.$ghost ) ) { self.isZooming = true; self.isSwiping = false; self.isPanning = false; $.fancybox.stop( self.$content ); self.$content.css( 'transition-duration', '0ms' ); self.centerPointStartX = ( ( self.startPoints[0].x + self.startPoints[1].x ) * 0.5 ) - $(window).scrollLeft(); self.centerPointStartY = ( ( self.startPoints[0].y + self.startPoints[1].y ) * 0.5 ) - $(window).scrollTop(); self.percentageOfImageAtPinchPointX = ( self.centerPointStartX - self.contentStartPos.left ) / self.contentStartPos.width; self.percentageOfImageAtPinchPointY = ( self.centerPointStartY - self.contentStartPos.top ) / self.contentStartPos.height; self.startDistanceBetweenFingers = distance( self.startPoints[0], self.startPoints[1] ); } }; Guestures.prototype.ontouchmove = function( e ) { var self = this; self.newPoints = pointers( e ); if ( $.fancybox.isMobile && ( isScrollable( self.$target ) || isScrollable( self.$target.parent() ) ) ) { e.stopPropagation(); self.canTap = false; return; } if ( !( self.opts || self.instance.canPan() ) || !self.newPoints || !self.newPoints.length ) { return; } self.distanceX = distance( self.newPoints[0], self.startPoints[0], 'x' ); self.distanceY = distance( self.newPoints[0], self.startPoints[0], 'y' ); self.distance = distance( self.newPoints[0], self.startPoints[0] ); // Skip false ontouchmove events (Chrome) if ( self.distance > 0 ) { if ( !( self.$target.is( self.$stage ) || self.$stage.find( self.$target ).length ) ) { return; } e.stopPropagation(); e.preventDefault(); if ( self.isSwiping ) { self.onSwipe(); } else if ( self.isPanning ) { self.onPan(); } else if ( self.isZooming ) { self.onZoom(); } } }; Guestures.prototype.onSwipe = function() { var self = this; var swiping = self.isSwiping; var left = self.sliderStartPos.left || 0; var angle; if ( swiping === true ) { if ( Math.abs( self.distance ) > 10 ) { self.canTap = false; if ( self.instance.group.length < 2 && self.opts.vertical ) { self.isSwiping = 'y'; } else if ( self.instance.isSliding || self.opts.vertical === false || ( self.opts.vertical === 'auto' && $( window ).width() > 800 ) ) { self.isSwiping = 'x'; } else { angle = Math.abs( Math.atan2( self.distanceY, self.distanceX ) * 180 / Math.PI ); self.isSwiping = ( angle > 45 && angle < 135 ) ? 'y' : 'x'; } self.instance.isSliding = self.isSwiping; // Reset points to avoid jumping, because we dropped first swipes to calculate the angle self.startPoints = self.newPoints; $.each(self.instance.slides, function( index, slide ) { $.fancybox.stop( slide.$slide ); slide.$slide.css( 'transition-duration', '0ms' ); slide.inTransition = false; if ( slide.pos === self.instance.current.pos ) { self.sliderStartPos.left = $.fancybox.getTranslate( slide.$slide ).left; } }); //self.instance.current.isMoved = true; // Stop slideshow if ( self.instance.SlideShow && self.instance.SlideShow.isActive ) { self.instance.SlideShow.stop(); } } } else { if ( swiping == 'x' ) { // Sticky edges if ( self.distanceX > 0 && ( self.instance.group.length < 2 || ( self.instance.current.index === 0 && !self.instance.current.opts.loop ) ) ) { left = left + Math.pow( self.distanceX, 0.8 ); } else if ( self.distanceX < 0 && ( self.instance.group.length < 2 || ( self.instance.current.index === self.instance.group.length - 1 && !self.instance.current.opts.loop ) ) ) { left = left - Math.pow( -self.distanceX, 0.8 ); } else { left = left + self.distanceX; } } self.sliderLastPos = { top : swiping == 'x' ? 0 : self.sliderStartPos.top + self.distanceY, left : left }; if ( self.requestId ) { cancelAFrame( self.requestId ); self.requestId = null; } self.requestId = requestAFrame(function() { if ( self.sliderLastPos ) { $.each(self.instance.slides, function( index, slide ) { var pos = slide.pos - self.instance.currPos; $.fancybox.setTranslate( slide.$slide, { top : self.sliderLastPos.top, left : self.sliderLastPos.left + ( pos * self.canvasWidth ) + ( pos * slide.opts.gutter ) }); }); self.$container.addClass( 'fancybox-is-sliding' ); } }); } }; Guestures.prototype.onPan = function() { var self = this; var newOffsetX, newOffsetY, newPos; self.canTap = false; if ( self.contentStartPos.width > self.canvasWidth ) { newOffsetX = self.contentStartPos.left + self.distanceX; } else { newOffsetX = self.contentStartPos.left; } newOffsetY = self.contentStartPos.top + self.distanceY; newPos = self.limitMovement( newOffsetX, newOffsetY, self.contentStartPos.width, self.contentStartPos.height ); newPos.scaleX = self.contentStartPos.scaleX; newPos.scaleY = self.contentStartPos.scaleY; self.contentLastPos = newPos; if ( self.requestId ) { cancelAFrame( self.requestId ); self.requestId = null; } self.requestId = requestAFrame(function() { $.fancybox.setTranslate( self.$content, self.contentLastPos ); }); }; // Make panning sticky to the edges Guestures.prototype.limitMovement = function( newOffsetX, newOffsetY, newWidth, newHeight ) { var self = this; var minTranslateX, minTranslateY, maxTranslateX, maxTranslateY; var canvasWidth = self.canvasWidth; var canvasHeight = self.canvasHeight; var currentOffsetX = self.contentStartPos.left; var currentOffsetY = self.contentStartPos.top; var distanceX = self.distanceX; var distanceY = self.distanceY; // Slow down proportionally to traveled distance minTranslateX = Math.max(0, canvasWidth * 0.5 - newWidth * 0.5 ); minTranslateY = Math.max(0, canvasHeight * 0.5 - newHeight * 0.5 ); maxTranslateX = Math.min( canvasWidth - newWidth, canvasWidth * 0.5 - newWidth * 0.5 ); maxTranslateY = Math.min( canvasHeight - newHeight, canvasHeight * 0.5 - newHeight * 0.5 ); if ( newWidth > canvasWidth ) { // -> if ( distanceX > 0 && newOffsetX > minTranslateX ) { newOffsetX = minTranslateX - 1 + Math.pow( -minTranslateX + currentOffsetX + distanceX, 0.8 ) || 0; } // 0 && newOffsetY > minTranslateY ) { newOffsetY = minTranslateY - 1 + Math.pow(-minTranslateY + currentOffsetY + distanceY, 0.8 ) || 0; } // /\\ if ( distanceY < 0 && newOffsetY < maxTranslateY ) { newOffsetY = maxTranslateY + 1 - Math.pow ( maxTranslateY - currentOffsetY - distanceY, 0.8 ) || 0; } } return { top : newOffsetY, left : newOffsetX }; }; Guestures.prototype.limitPosition = function( newOffsetX, newOffsetY, newWidth, newHeight ) { var self = this; var canvasWidth = self.canvasWidth; var canvasHeight = self.canvasHeight; if ( newWidth > canvasWidth ) { newOffsetX = newOffsetX > 0 ? 0 : newOffsetX; newOffsetX = newOffsetX < canvasWidth - newWidth ? canvasWidth - newWidth : newOffsetX; } else { // Center horizontally newOffsetX = Math.max( 0, canvasWidth / 2 - newWidth / 2 ); } if ( newHeight > canvasHeight ) { newOffsetY = newOffsetY > 0 ? 0 : newOffsetY; newOffsetY = newOffsetY < canvasHeight - newHeight ? canvasHeight - newHeight : newOffsetY; } else { // Center vertically newOffsetY = Math.max( 0, canvasHeight / 2 - newHeight / 2 ); } return { top : newOffsetY, left : newOffsetX }; }; Guestures.prototype.onZoom = function() { var self = this; // Calculate current distance between points to get pinch ratio and new width and height var currentWidth = self.contentStartPos.width; var currentHeight = self.contentStartPos.height; var currentOffsetX = self.contentStartPos.left; var currentOffsetY = self.contentStartPos.top; var endDistanceBetweenFingers = distance( self.newPoints[0], self.newPoints[1] ); var pinchRatio = endDistanceBetweenFingers / self.startDistanceBetweenFingers; var newWidth = Math.floor( currentWidth * pinchRatio ); var newHeight = Math.floor( currentHeight * pinchRatio ); // This is the translation due to pinch-zooming var translateFromZoomingX = (currentWidth - newWidth) * self.percentageOfImageAtPinchPointX; var translateFromZoomingY = (currentHeight - newHeight) * self.percentageOfImageAtPinchPointY; //Point between the two touches var centerPointEndX = ((self.newPoints[0].x + self.newPoints[1].x) / 2) - $(window).scrollLeft(); var centerPointEndY = ((self.newPoints[0].y + self.newPoints[1].y) / 2) - $(window).scrollTop(); // And this is the translation due to translation of the centerpoint // between the two fingers var translateFromTranslatingX = centerPointEndX - self.centerPointStartX; var translateFromTranslatingY = centerPointEndY - self.centerPointStartY; // The new offset is the old/current one plus the total translation var newOffsetX = currentOffsetX + ( translateFromZoomingX + translateFromTranslatingX ); var newOffsetY = currentOffsetY + ( translateFromZoomingY + translateFromTranslatingY ); var newPos = { top : newOffsetY, left : newOffsetX, scaleX : self.contentStartPos.scaleX * pinchRatio, scaleY : self.contentStartPos.scaleY * pinchRatio }; self.canTap = false; self.newWidth = newWidth; self.newHeight = newHeight; self.contentLastPos = newPos; if ( self.requestId ) { cancelAFrame( self.requestId ); self.requestId = null; } self.requestId = requestAFrame(function() { $.fancybox.setTranslate( self.$content, self.contentLastPos ); }); }; Guestures.prototype.ontouchend = function( e ) { var self = this; var dMs = Math.max( (new Date().getTime() ) - self.startTime, 1); var swiping = self.isSwiping; var panning = self.isPanning; var zooming = self.isZooming; self.endPoints = pointers( e ); self.$container.removeClass( 'fancybox-controls--isGrabbing' ); $(document).off( '.fb.touch' ); if ( self.requestId ) { cancelAFrame( self.requestId ); self.requestId = null; } self.isSwiping = false; self.isPanning = false; self.isZooming = false; if ( self.canTap ) { return self.onTap( e ); } self.speed = 366; // Speed in px/ms self.velocityX = self.distanceX / dMs * 0.5; self.velocityY = self.distanceY / dMs * 0.5; self.speedX = Math.max( self.speed * 0.5, Math.min( self.speed * 1.5, ( 1 / Math.abs( self.velocityX ) ) * self.speed ) ); if ( panning ) { self.endPanning(); } else if ( zooming ) { self.endZooming(); } else { self.endSwiping( swiping ); } return; }; Guestures.prototype.endSwiping = function( swiping ) { var self = this; var ret = false; self.instance.isSliding = false; self.sliderLastPos = null; // Close if swiped vertically / navigate if horizontally if ( swiping == 'y' && Math.abs( self.distanceY ) > 50 ) { // Continue vertical movement $.fancybox.animate( self.instance.current.$slide, { top : self.sliderStartPos.top + self.distanceY + ( self.velocityY * 150 ), opacity : 0 }, 150 ); ret = self.instance.close( true, 300 ); } else if ( swiping == 'x' && self.distanceX > 50 && self.instance.group.length > 1 ) { ret = self.instance.previous( self.speedX ); } else if ( swiping == 'x' && self.distanceX < -50 && self.instance.group.length > 1 ) { ret = self.instance.next( self.speedX ); } if ( ret === false && ( swiping == 'x' || swiping == 'y' ) ) { self.instance.jumpTo( self.instance.current.index, 150 ); } self.$container.removeClass( 'fancybox-is-sliding' ); }; // Limit panning from edges // ======================== Guestures.prototype.endPanning = function() { var self = this; var newOffsetX, newOffsetY, newPos; if ( !self.contentLastPos ) { return; } if ( self.opts.momentum === false ) { newOffsetX = self.contentLastPos.left; newOffsetY = self.contentLastPos.top; } else { // Continue movement newOffsetX = self.contentLastPos.left + ( self.velocityX * self.speed ); newOffsetY = self.contentLastPos.top + ( self.velocityY * self.speed ); } newPos = self.limitPosition( newOffsetX, newOffsetY, self.contentStartPos.width, self.contentStartPos.height ); newPos.width = self.contentStartPos.width; newPos.height = self.contentStartPos.height; $.fancybox.animate( self.$content, newPos, 330 ); }; Guestures.prototype.endZooming = function() { var self = this; var current = self.instance.current; var newOffsetX, newOffsetY, newPos, reset; var newWidth = self.newWidth; var newHeight = self.newHeight; if ( !self.contentLastPos ) { return; } newOffsetX = self.contentLastPos.left; newOffsetY = self.contentLastPos.top; reset = { top : newOffsetY, left : newOffsetX, width : newWidth, height : newHeight, scaleX : 1, scaleY : 1 }; // Reset scalex/scaleY values; this helps for perfomance and does not break animation $.fancybox.setTranslate( self.$content, reset ); if ( newWidth < self.canvasWidth && newHeight < self.canvasHeight ) { self.instance.scaleToFit( 150 ); } else if ( newWidth > current.width || newHeight > current.height ) { self.instance.scaleToActual( self.centerPointStartX, self.centerPointStartY, 150 ); } else { newPos = self.limitPosition( newOffsetX, newOffsetY, newWidth, newHeight ); // Switch from scale() to width/height or animation will not work correctly $.fancybox.setTranslate( self.content, $.fancybox.getTranslate( self.$content ) ); $.fancybox.animate( self.$content, newPos, 150 ); } }; Guestures.prototype.onTap = function(e) { var self = this; var $target = $( e.target ); var instance = self.instance; var current = instance.current; var endPoints = ( e && pointers( e ) ) || self.startPoints; var tapX = endPoints[0] ? endPoints[0].x - self.$stage.offset().left : 0; var tapY = endPoints[0] ? endPoints[0].y - self.$stage.offset().top : 0; var where; var process = function ( prefix ) { var action = current.opts[ prefix ]; if ( $.isFunction( action ) ) { action = action.apply( instance, [ current, e ] ); } if ( !action) { return; } switch ( action ) { case \"close\" : instance.close( self.startEvent ); break; case \"toggleControls\" : instance.toggleControls( true ); break; case \"next\" : instance.next(); break; case \"nextOrClose\" : if ( instance.group.length > 1 ) { instance.next(); } else { instance.close( self.startEvent ); } break; case \"zoom\" : if ( current.type == 'image' && ( current.isLoaded || current.$ghost ) ) { if ( instance.canPan() ) { instance.scaleToFit(); } else if ( instance.isScaledDown() ) { instance.scaleToActual( tapX, tapY ); } else if ( instance.group.length < 2 ) { instance.close( self.startEvent ); } } break; } }; // Ignore right click if ( e.originalEvent && e.originalEvent.button == 2 ) { return; } // Skip if current slide is not in the center if ( instance.isSliding ) { return; } // Skip if clicked on the scrollbar if ( tapX > $target[0].clientWidth + $target.offset().left ) { return; } // Check where is clicked if ( $target.is( '.fancybox-bg,.fancybox-inner,.fancybox-outer,.fancybox-container' ) ) { where = 'Outside'; } else if ( $target.is( '.fancybox-slide' ) ) { where = 'Slide'; } else if ( instance.current.$content && instance.current.$content.has( e.target ).length ) { where = 'Content'; } else { return; } // Check if this is a double tap if ( self.tapped ) { // Stop previously created single tap clearTimeout( self.tapped ); self.tapped = null; // Skip if distance between taps is too big if ( Math.abs( tapX - self.tapX ) > 50 || Math.abs( tapY - self.tapY ) > 50 || instance.isSliding ) { return this; } // OK, now we assume that this is a double-tap process( 'dblclick' + where ); } else { // Single tap will be processed if user has not clicked second time within 300ms // or there is no need to wait for double-tap self.tapX = tapX; self.tapY = tapY; if ( current.opts[ 'dblclick' + where ] && current.opts[ 'dblclick' + where ] !== current.opts[ 'click' + where ] ) { self.tapped = setTimeout(function() { self.tapped = null; process( 'click' + where ); }, 300); } else { process( 'click' + where ); } } return this; }; $(document).on('onActivate.fb', function (e, instance) { if ( instance && !instance.Guestures ) { instance.Guestures = new Guestures( instance ); } }); $(document).on('beforeClose.fb', function (e, instance) { if ( instance && instance.Guestures ) { instance.Guestures.destroy(); } }); }( window, document, window.jQuery || jQuery )); // ========================================================================== // // SlideShow // Enables slideshow functionality // // Example of usage: // $.fancybox.getInstance().SlideShow.start() // // ========================================================================== ;(function (document, $) { 'use strict'; $.extend(true, $.fancybox.defaults, { btnTpl : { slideShow : '' + '' + '' + '' + '' + '' }, slideShow : { autoStart : false, speed : 3000 } }); var SlideShow = function( instance ) { this.instance = instance; this.init(); }; $.extend( SlideShow.prototype, { timer : null, isActive : false, $button : null, init : function() { var self = this; self.$button = self.instance.$refs.toolbar.find('[data-fancybox-play]').on('click', function() { self.toggle(); }); if ( self.instance.group.length < 2 || !self.instance.group[ self.instance.currIndex ].opts.slideShow ) { self.$button.hide(); } }, set : function( force ) { var self = this; // Check if reached last element if ( self.instance && self.instance.current && (force === true || self.instance.current.opts.loop || self.instance.currIndex < self.instance.group.length - 1 )) { self.timer = setTimeout(function() { if ( self.isActive ) { self.instance.jumpTo( (self.instance.currIndex + 1) % self.instance.group.length ); } }, self.instance.current.opts.slideShow.speed); } else { self.stop(); self.instance.idleSecondsCounter = 0; self.instance.showControls(); } }, clear : function() { var self = this; clearTimeout( self.timer ); self.timer = null; }, start : function() { var self = this; var current = self.instance.current; if ( current ) { self.isActive = true; self.$button .attr( 'title', current.opts.i18n[ current.opts.lang ].PLAY_STOP ) .removeClass( 'fancybox-button--play' ) .addClass( 'fancybox-button--pause' ); self.set( true ); } }, stop : function() { var self = this; var current = self.instance.current; self.clear(); self.$button .attr( 'title', current.opts.i18n[ current.opts.lang ].PLAY_START ) .removeClass( 'fancybox-button--pause' ) .addClass( 'fancybox-button--play' ); self.isActive = false; }, toggle : function() { var self = this; if ( self.isActive ) { self.stop(); } else { self.start(); } } }); $(document).on({ 'onInit.fb' : function(e, instance) { if ( instance && !instance.SlideShow ) { instance.SlideShow = new SlideShow( instance ); } }, 'beforeShow.fb' : function(e, instance, current, firstRun) { var SlideShow = instance && instance.SlideShow; if ( firstRun ) { if ( SlideShow && current.opts.slideShow.autoStart ) { SlideShow.start(); } } else if ( SlideShow && SlideShow.isActive ) { SlideShow.clear(); } }, 'afterShow.fb' : function(e, instance, current) { var SlideShow = instance && instance.SlideShow; if ( SlideShow && SlideShow.isActive ) { SlideShow.set(); } }, 'afterKeydown.fb' : function(e, instance, current, keypress, keycode) { var SlideShow = instance && instance.SlideShow; // \"P\" or Spacebar if ( SlideShow && current.opts.slideShow && ( keycode === 80 || keycode === 32 ) && !$(document.activeElement).is( 'button,a,input' ) ) { keypress.preventDefault(); SlideShow.toggle(); } }, 'beforeClose.fb onDeactivate.fb' : function(e, instance) { var SlideShow = instance && instance.SlideShow; if ( SlideShow ) { SlideShow.stop(); } } }); // Page Visibility API to pause slideshow when window is not active $(document).on(\"visibilitychange\", function() { var instance = $.fancybox.getInstance(); var SlideShow = instance && instance.SlideShow; if ( SlideShow && SlideShow.isActive ) { if ( document.hidden ) { SlideShow.clear(); } else { SlideShow.set(); } } }); }( document, window.jQuery || jQuery )); // ========================================================================== // // FullScreen // Adds fullscreen functionality // // ========================================================================== ;(function (document, $) { 'use strict'; // Collection of methods supported by user browser var fn = (function () { var fnMap = [ [ 'requestFullscreen', 'exitFullscreen', 'fullscreenElement', 'fullscreenEnabled', 'fullscreenchange', 'fullscreenerror' ], // new WebKit [ 'webkitRequestFullscreen', 'webkitExitFullscreen', 'webkitFullscreenElement', 'webkitFullscreenEnabled', 'webkitfullscreenchange', 'webkitfullscreenerror' ], // old WebKit (Safari 5.1) [ 'webkitRequestFullScreen', 'webkitCancelFullScreen', 'webkitCurrentFullScreenElement', 'webkitCancelFullScreen', 'webkitfullscreenchange', 'webkitfullscreenerror' ], [ 'mozRequestFullScreen', 'mozCancelFullScreen', 'mozFullScreenElement', 'mozFullScreenEnabled', 'mozfullscreenchange', 'mozfullscreenerror' ], [ 'msRequestFullscreen', 'msExitFullscreen', 'msFullscreenElement', 'msFullscreenEnabled', 'MSFullscreenChange', 'MSFullscreenError' ] ]; var val; var ret = {}; var i, j; for ( i = 0; i < fnMap.length; i++ ) { val = fnMap[ i ]; if ( val && val[ 1 ] in document ) { for ( j = 0; j < val.length; j++ ) { ret[ fnMap[ 0 ][ j ] ] = val[ j ]; } return ret; } } return false; })(); // If browser does not have Full Screen API, then simply unset default button template and stop if ( !fn ) { if ( $ && $.fancybox ) { $.fancybox.defaults.btnTpl.fullScreen = false; } return; } var FullScreen = { request : function ( elem ) { elem = elem || document.documentElement; elem[ fn.requestFullscreen ]( elem.ALLOW_KEYBOARD_INPUT ); }, exit : function () { document[ fn.exitFullscreen ](); }, toggle : function ( elem ) { elem = elem || document.documentElement; if ( this.isFullscreen() ) { this.exit(); } else { this.request( elem ); } }, isFullscreen : function() { return Boolean( document[ fn.fullscreenElement ] ); }, enabled : function() { return Boolean( document[ fn.fullscreenEnabled ] ); } }; $.extend(true, $.fancybox.defaults, { btnTpl : { fullScreen : '' + '' + '' + '' + '' }, fullScreen : { autoStart : false } }); $(document).on({ 'onInit.fb' : function(e, instance) { var $container; if ( instance && instance.group[ instance.currIndex ].opts.fullScreen ) { $container = instance.$refs.container; $container.on('click.fb-fullscreen', '[data-fancybox-fullscreen]', function(e) { e.stopPropagation(); e.preventDefault(); FullScreen.toggle( $container[ 0 ] ); }); if ( instance.opts.fullScreen && instance.opts.fullScreen.autoStart === true ) { FullScreen.request( $container[ 0 ] ); } // Expose API instance.FullScreen = FullScreen; } else if ( instance ) { instance.$refs.toolbar.find('[data-fancybox-fullscreen]').hide(); } }, 'afterKeydown.fb' : function(e, instance, current, keypress, keycode) { // \"P\" or Spacebar if ( instance && instance.FullScreen && keycode === 70 ) { keypress.preventDefault(); instance.FullScreen.toggle( instance.$refs.container[ 0 ] ); } }, 'beforeClose.fb' : function( instance ) { if ( instance && instance.FullScreen ) { FullScreen.exit(); } } }); $(document).on(fn.fullscreenchange, function() { var isFullscreen = FullScreen.isFullscreen(), instance = $.fancybox.getInstance(); if ( instance ) { // If image is zooming, then force to stop and reposition properly if ( instance.current && instance.current.type === 'image' && instance.isAnimating ) { instance.current.$content.css( 'transition', 'none' ); instance.isAnimating = false; instance.update( true, true, 0 ); } instance.trigger( 'onFullscreenChange', isFullscreen ); instance.$refs.container.toggleClass( 'fancybox-is-fullscreen', isFullscreen ); } }); }( document, window.jQuery || jQuery )); // ========================================================================== // // Thumbs // Displays thumbnails in a grid // // ========================================================================== ;(function (document, $) { 'use strict'; // Make sure there are default values $.fancybox.defaults = $.extend(true, { btnTpl : { thumbs : '' + '' + '' + '' + '' }, thumbs : { autoStart : false, // Display thumbnails on opening hideOnClose : true, // Hide thumbnail grid when closing animation starts parentEl : '.fancybox-container', // Container is injected into this element axis : 'y' // Vertical (y) or horizontal (x) scrolling } }, $.fancybox.defaults); var FancyThumbs = function( instance ) { this.init( instance ); }; $.extend( FancyThumbs.prototype, { $button : null, $grid : null, $list : null, isVisible : false, isActive : false, init : function( instance ) { var self = this; self.instance = instance; instance.Thumbs = self; // Enable thumbs if at least two group items have thumbnails var first = instance.group[0], second = instance.group[1]; self.opts = instance.group[ instance.currIndex ].opts.thumbs; self.$button = instance.$refs.toolbar.find( '[data-fancybox-thumbs]' ); if ( self.opts && first && second && ( ( first.type == 'image' || first.opts.thumb || first.opts.$thumb ) && ( second.type == 'image' || second.opts.thumb || second.opts.$thumb ) )) { self.$button.show().on('click', function() { self.toggle(); }); self.isActive = true; } else { self.$button.hide(); } }, create : function() { var self = this, instance = self.instance, parentEl = self.opts.parentEl, list, src; self.$grid = $('').appendTo( instance.$refs.container.find( parentEl ).addBack().filter( parentEl ) ); // Build list HTML list = ''; $.each(instance.group, function( i, item ) { src = item.opts.thumb || ( item.opts.$thumb ? item.opts.$thumb.attr( 'src' ) : null ); if ( !src && item.type === 'image' ) { src = item.src; } if ( src && src.length ) { list += ''; } }); list += ''; self.$list = $( list ).appendTo( self.$grid ).on('click', 'li', function() { instance.jumpTo( $(this).data('index') ); }); self.$list.find( 'img' ).hide().one('load', function() { var $parent = $(this).parent().removeClass( 'fancybox-thumbs-loading' ), thumbWidth = $parent.outerWidth(), thumbHeight = $parent.outerHeight(), width, height, widthRatio, heightRatio; width = this.naturalWidth || this.width; height = this.naturalHeight || this.height; // Calculate thumbnail dimensions; center vertically and horizontally widthRatio = width / thumbWidth; heightRatio = height / thumbHeight; if (widthRatio >= 1 && heightRatio >= 1) { if (widthRatio > heightRatio) { width = width / heightRatio; height = thumbHeight; } else { width = thumbWidth; height = height / widthRatio; } } $(this).css({ width : Math.floor(width), height : Math.floor(height), 'margin-top' : height > thumbHeight ? ( Math.floor(thumbHeight * 0.3 - height * 0.3 ) ) : Math.floor(thumbHeight * 0.5 - height * 0.5 ), 'margin-left' : Math.floor(thumbWidth * 0.5 - width * 0.5 ) }).show(); }) .each(function() { this.src = $( this ).data( 'src' ); }); if ( self.opts.axis === 'x' ) { self.$list.width( parseInt( self.$grid.css(\"padding-right\") ) + ( instance.group.length * self.$list.children().eq(0).outerWidth(true) ) + 'px' ); } }, focus : function( duration ) { var self = this, $list = self.$list, thumb, thumbPos; if ( self.instance.current ) { thumb = $list.children() .removeClass( 'fancybox-thumbs-active' ) .filter('[data-index=\"' + self.instance.current.index + '\"]') .addClass('fancybox-thumbs-active'); thumbPos = thumb.position(); // Check if need to scroll to make current thumb visible if ( self.opts.axis === 'y' && ( thumbPos.top < 0 || thumbPos.top > ( $list.height() - thumb.outerHeight() ) ) ) { $list.stop().animate({ 'scrollTop' : $list.scrollTop() + thumbPos.top }, duration); } else if ( self.opts.axis === 'x' && ( thumbPos.left < $list.parent().scrollLeft() || thumbPos.left > ( $list.parent().scrollLeft() + ( $list.parent().width() - thumb.outerWidth() ) ) ) ) { $list.parent().stop().animate({ 'scrollLeft' : thumbPos.left }, duration); } } }, update : function() { this.instance.$refs.container.toggleClass( 'fancybox-show-thumbs', this.isVisible ); if ( this.isVisible ) { if ( !this.$grid ) { this.create(); } this.instance.trigger( 'onThumbsShow' ); this.focus( 0 ); } else if ( this.$grid ) { this.instance.trigger( 'onThumbsHide' ); } // Update content position this.instance.update(); }, hide : function() { this.isVisible = false; this.update(); }, show : function() { this.isVisible = true; this.update(); }, toggle : function() { this.isVisible = !this.isVisible; this.update(); } }); $(document).on({ 'onInit.fb' : function(e, instance) { var Thumbs; if ( instance && !instance.Thumbs ) { Thumbs = new FancyThumbs( instance ); if ( Thumbs.isActive && Thumbs.opts.autoStart === true ) { Thumbs.show(); } } }, 'beforeShow.fb' : function(e, instance, item, firstRun) { var Thumbs = instance && instance.Thumbs; if ( Thumbs && Thumbs.isVisible ) { Thumbs.focus( firstRun ? 0 : 250 ); } }, 'afterKeydown.fb' : function(e, instance, current, keypress, keycode) { var Thumbs = instance && instance.Thumbs; // \"G\" if ( Thumbs && Thumbs.isActive && keycode === 71 ) { keypress.preventDefault(); Thumbs.toggle(); } }, 'beforeClose.fb' : function( e, instance ) { var Thumbs = instance && instance.Thumbs; if ( Thumbs && Thumbs.isVisible && Thumbs.opts.hideOnClose !== false ) { Thumbs.$grid.hide(); } } }); }(document, window.jQuery)); //// ========================================================================== // // Share // Displays simple form for sharing current url // // ========================================================================== ;(function (document, $) { 'use strict'; $.extend(true, $.fancybox.defaults, { btnTpl : { share : '' + '' + '' + '' + '' }, share : { tpl : '' + '' + '' + '' + '' + 'Facebook' + '' + '' + '' + 'Pinterest' + '' + '' + '' + 'Twitter' + '' + '' + '' + '' } }); function escapeHtml(string) { var entityMap = { '&': '&amp;', '': '&gt;', '\"': '&quot;', \"'\": '&#39;', '/': '&#x2F;', '`': '&#x60;', '=': '&#x3D;' }; return String(string).replace(/[&\"'`=\\/]/g, function (s) { return entityMap[s]; }); } $(document).on('click', '[data-fancybox-share]', function() { var f = $.fancybox.getInstance(), url, tpl; if ( f ) { url = f.current.opts.hash === false ? f.current.src : window.location; tpl = f.current.opts.share.tpl .replace( /\\{\\{src\\}\\}/g, encodeURIComponent( url ) ) .replace( /\\{\\{src_raw\\}\\}/g, escapeHtml( url ) ) .replace( /\\{\\{descr\\}\\}/g, f.$caption ? encodeURIComponent( f.$caption.text() ) : '' ); $.fancybox.open({ src : f.translate( f, tpl ), type : 'html', opts : { animationEffect : \"fade\", animationDuration : 250 } }); } }); }( document, window.jQuery || jQuery )); // ========================================================================== // // Hash // Enables linking to each modal // // ========================================================================== ;(function (document, window, $) { 'use strict'; // Simple $.escapeSelector polyfill (for jQuery prior v3) if ( !$.escapeSelector ) { $.escapeSelector = function( sel ) { var rcssescape = /([\\0-\\x1f\\x7f]|^-?\\d)|^-$|[^\\x80-\\uFFFF\\w-]/g; var fcssescape = function( ch, asCodePoint ) { if ( asCodePoint ) { // U+0000 NULL becomes U+FFFD REPLACEMENT CHARACTER if ( ch === \"\\0\" ) { return \"\\uFFFD\"; } // Control characters and (dependent upon position) numbers get escaped as code points return ch.slice( 0, -1 ) + \"\\\\\" + ch.charCodeAt( ch.length - 1 ).toString( 16 ) + \" \"; } // Other potentially-special ASCII characters get backslash-escaped return \"\\\\\" + ch; }; return ( sel + \"\" ).replace( rcssescape, fcssescape ); }; } // Create new history entry only once var shouldCreateHistory = true; // Variable containing last hash value set by fancyBox // It will be used to determine if fancyBox needs to close after hash change is detected var currentHash = null; // Throttling the history change var timerID = null; // Get info about gallery name and current index from url function parseUrl() { var hash = window.location.hash.substr( 1 ); var rez = hash.split( '-' ); var index = rez.length > 1 && /^\\+?\\d+$/.test( rez[ rez.length - 1 ] ) ? parseInt( rez.pop( -1 ), 10 ) || 1 : 1; var gallery = rez.join( '-' ); // Index is starting from 1 if ( index < 1 ) { index = 1; } return { hash : hash, index : index, gallery : gallery }; } // Trigger click evnt on links to open new fancyBox instance function triggerFromUrl( url ) { var $el; if ( url.gallery !== '' ) { // If we can find element matching 'data-fancybox' atribute, then trigger click event for that .. $el = $( \"[data-fancybox='\" + $.escapeSelector( url.gallery ) + \"']\" ).eq( url.index - 1 ); if ( !$el.length ) { // .. if not, try finding element by ID $el = $( \"#\" + $.escapeSelector( url.gallery ) + \"\" ); } if ( $el.length ) { shouldCreateHistory = false; $el.trigger( 'click' ); } } } // Get gallery name from current instance function getGalleryID( instance ) { var opts; if ( !instance ) { return false; } opts = instance.current ? instance.current.opts : instance.opts; return opts.hash || ( opts.$orig ? opts.$orig.data( 'fancybox' ) : '' ); } // Start when DOM becomes ready $(function() { // Check if user has disabled this module if ( $.fancybox.defaults.hash === false ) { return; } // Update hash when opening/closing fancyBox $(document).on({ 'onInit.fb' : function( e, instance ) { var url, gallery; if ( instance.group[ instance.currIndex ].opts.hash === false ) { return; } url = parseUrl(); gallery = getGalleryID( instance ); // Make sure gallery start index matches index from hash if ( gallery && url.gallery && gallery == url.gallery ) { instance.currIndex = url.index - 1; } }, 'beforeShow.fb' : function( e, instance, current ) { var gallery; if ( !current || current.opts.hash === false ) { return; } gallery = getGalleryID( instance ); // Update window hash if ( gallery && gallery !== '' ) { if ( window.location.hash.indexOf( gallery ) < 0 ) { instance.opts.origHash = window.location.hash; } currentHash = gallery + ( instance.group.length > 1 ? '-' + ( current.index + 1 ) : '' ); if ( 'replaceState' in window.history ) { if ( timerID ) { clearTimeout( timerID ); } timerID = setTimeout(function() { window.history[ shouldCreateHistory ? 'pushState' : 'replaceState' ]( {} , document.title, window.location.pathname + window.location.search + '#' + currentHash ); timerID = null; shouldCreateHistory = false; }, 300); } else { window.location.hash = currentHash; } } }, 'beforeClose.fb' : function( e, instance, current ) { var gallery, origHash; if ( timerID ) { clearTimeout( timerID ); } if ( current.opts.hash === false ) { return; } gallery = getGalleryID( instance ); origHash = instance && instance.opts.origHash ? instance.opts.origHash : ''; // Remove hash from location bar if ( gallery && gallery !== '' ) { if ( 'replaceState' in history ) { window.history.replaceState( {} , document.title, window.location.pathname + window.location.search + origHash ); } else { window.location.hash = origHash; // Keep original scroll position $( window ).scrollTop( instance.scrollTop ).scrollLeft( instance.scrollLeft ); } } currentHash = null; } }); // Check if need to close after url has changed $(window).on('hashchange.fb', function() { var url = parseUrl(); if ( $.fancybox.getInstance() ) { if ( currentHash && currentHash !== url.gallery + '-' + url.index && !( url.index === 1 && currentHash == url.gallery ) ) { currentHash = null; $.fancybox.close(); } } else if ( url.gallery !== '' ) { triggerFromUrl( url ); } }); // Check current hash and trigger click event on matching element to start fancyBox, if needed setTimeout(function() { triggerFromUrl( parseUrl() ); }, 50); }); }( document, window, window.jQuery || jQuery ));"},{"title":"","date":"2019-02-15T07:41:43.419Z","updated":"2019-02-15T07:41:43.419Z","comments":true,"path":"lib/three/three.min.js","permalink":"https://ainevsia.github.io/lib/three/three.min.js","excerpt":"","text":"// threejs.org/license (function(l,pa){\"object\"===typeof exports&&\"undefined\"!==typeof module?pa(exports):\"function\"===typeof define&&define.amd?define([\"exports\"],pa):pa(l.THREE=l.THREE||{})})(this,function(l){function pa(){}function D(a,b){this.x=a||0;this.y=b||0}function ea(a,b,c,d,e,f,g,h,m,k){Object.defineProperty(this,\"id\",{value:Ze++});this.uuid=N.generateUUID();this.name=\"\";this.image=void 0!==a?a:ea.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:ea.DEFAULT_MAPPING;this.wrapS=void 0!==c?c:1001;this.wrapT= void 0!==d?d:1001;this.magFilter=void 0!==e?e:1006;this.minFilter=void 0!==f?f:1008;this.anisotropy=void 0!==m?m:1;this.format=void 0!==g?g:1023;this.type=void 0!==h?h:1009;this.offset=new D(0,0);this.repeat=new D(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=void 0!==k?k:3E3;this.version=0;this.onUpdate=null}function fa(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1}function Ya(a,b,c){this.uuid=N.generateUUID();this.width= a;this.height=b;this.scissor=new fa(0,0,a,b);this.scissorTest=!1;this.viewport=new fa(0,0,a,b);c=c||{};void 0===c.minFilter&&(c.minFilter=1006);this.texture=new ea(void 0,void 0,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.encoding);this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.depthTexture=void 0!==c.depthTexture?c.depthTexture:null}function Gb(a,b,c){Ya.call(this,a,b,c);this.activeMipMapLevel= this.activeCubeFace=0}function ca(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1}function q(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0}function S(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);0= d||0k||k>p)return[]}else{if(0d;d++)p=3*y[m++],G=new q(x[p++],x[p++],x[p]),2!==d&&u.vertexNormals.push(G),0!==d&&r.vertexNormals.push(G);l&&(l=y[m++],l=v[l],u.color.setHex(l),r.color.setHex(l));if(b)for(d=0;4>d;d++)l=y[m++],l=v[l],2!==d&&u.vertexColors.push(new J(l)),0!==d&&r.vertexColors.push(new J(l));c.faces.push(u);c.faces.push(r)}else{u=new ha;u.a=y[m++];u.b=y[m++];u.c=y[m++];h&&(h=y[m++],u.materialIndex=h);h=c.faces.length;if(d)for(d=0;dg;g++)n=y[m++],w=A[2*n],n=A[2*n+1],w=new D(w,n),c.faceVertexUvs[d][h].push(w);p&&(p=3*y[m++],u.normal.set(x[p++],x[p++],x[p]));if(G)for(d=0;3>d;d++)p=3*y[m++],G=new q(x[p++],x[p++],x[p]),u.vertexNormals.push(G);l&&(l=y[m++],u.color.setHex(v[l]));if(b)for(d=0;3>d;d++)l=y[m++],u.vertexColors.push(new J(v[l]));c.faces.push(u)}})(d);(function(){var b=void 0!==a.influencesPerVertex?a.influencesPerVertex:2;if(a.skinWeights)for(var d=0,g=a.skinWeights.length;d=c){var p=c++,n=b[p];d[n.uuid]=l;b[l]=n;d[k]=p;b[p]=m;m=0;for(k=f;m!==k;++m){var n=e[m],q=n[l];n[l]=n[p];n[p]=q}}}this.nCachedObjects_=c},uncache:function(a){for(var b=this._objects,c=b.length,d=this.nCachedObjects_,e=this._indicesByUUID,f=this._bindings,g=f.length,h=0,m=arguments.length;h!==m;++h){var k=arguments[h].uuid,l=e[k]; if(void 0!==l)if(delete e[k],lb||0===c)return;this._startTime=null;b*=c}b*=this._updateTimeScale(a);c=this._updateTime(b);a=this._updateWeight(a);if(0c.parameterPositions[1]&& (this.stopFading(),0===d&&(this.enabled=!1))}}return this._effectiveWeight=b},_updateTimeScale:function(a){var b=0;if(!this.paused){var b=this.timeScale,c=this._timeScaleInterpolant;if(null!==c){var d=c.evaluate(a)[0],b=b*d;a>c.parameterPositions[1]&&(this.stopWarping(),0===b?this.paused=!0:this.timeScale=b)}}return this._effectiveTimeScale=b},_updateTime:function(a){var b=this.time+a;if(0===a)return b;var c=this._clip.duration,d=this.loop,e=this._loopCount;if(2200===d)a:{if(-1===e&&(this._loopCount= 0,this._setEndings(!0,!0,!1)),b>=c)b=c;else if(0>b)b=0;else break a;this.clampWhenFinished?this.paused=!0:this.enabled=!1;this._mixer.dispatchEvent({type:\"finished\",action:this,direction:0>a?-1:1})}else{d=2202===d;-1===e&&(0=c||0>b){var f=Math.floor(b/c),b=b-c*f,e=e+Math.abs(f),g=this.repetitions-e;0>g?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,b=0d.time)d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.directionBackwards=!0),0>d.time&&(d.time=0,d.directionBackwards=!1)}else d.time%=d.duration,0>d.time&&(d.time+=d.duration);var f=d.start+N.clamp(Math.floor(d.time/e),0,d.length-1),g=d.weight;f!==d.currentFrame&&(this.morphTargetInfluences[d.lastFrame]=0,this.morphTargetInfluences[d.currentFrame]=1*g,this.morphTargetInfluences[f]=0,d.lastFrame=d.currentFrame,d.currentFrame=f);e=d.time%e/e;d.directionBackwards&&(e=1-e);d.currentFrame!== d.lastFrame?(this.morphTargetInfluences[d.currentFrame]=e*g,this.morphTargetInfluences[d.lastFrame]=(1-e)*g):this.morphTargetInfluences[d.currentFrame]=g}}};dd.prototype=Object.create(x.prototype);dd.prototype.constructor=dd;dd.prototype.isImmediateRenderObject=!0;ed.prototype=Object.create(ga.prototype);ed.prototype.constructor=ed;ed.prototype.update=function(){var a=new q,b=new q,c=new ya;return function(){var d=[\"a\",\"b\",\"c\"];this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld); var e=this.object.matrixWorld,f=this.geometry.attributes.position,g=this.object.geometry;if(g&&g.isGeometry)for(var h=g.vertices,l=g.faces,k=g=0,q=l.length;kc&&console.log(\"duh, you need at least 2 points\");a*=c-(this.closed?0:1);var d=Math.floor(a);a-=d;this.closed?d+=0c&&(c=d);1E-4>h&&(h=d);ye.initNonuniformCatmullRom(e.x,f.x,g.x,b.x,c,d,h);ze.initNonuniformCatmullRom(e.y,f.y,g.y,b.y,c,d,h);Ae.initNonuniformCatmullRom(e.z,f.z,g.z,b.z,c,d,h)}else\"catmullrom\"===this.type&&(c=void 0!==this.tension?this.tension: .5,ye.initCatmullRom(e.x,f.x,g.x,b.x,c),ze.initCatmullRom(e.y,f.y,g.y,b.y,c),Ae.initCatmullRom(e.z,f.z,g.z,b.z,c));return new q(ye.calc(a),ze.calc(a),Ae.calc(a))};id.prototype=Object.create(ua.prototype);id.prototype.constructor=id;id.prototype.getPoint=function(a){var b=this.v0,c=this.v1,d=this.v2,e=this.v3;return new q(Bb(a,b.x,c.x,d.x,e.x),Bb(a,b.y,c.y,d.y,e.y),Bb(a,b.z,c.z,d.z,e.z))};jd.prototype=Object.create(ua.prototype);jd.prototype.constructor=jd;jd.prototype.getPoint=function(a){var b=this.v0, c=this.v1,d=this.v2;return new q(Ab(a,b.x,c.x,d.x),Ab(a,b.y,c.y,d.y),Ab(a,b.z,c.z,d.z))};kd.prototype=Object.create(ua.prototype);kd.prototype.constructor=kd;kd.prototype.getPoint=function(a){if(1===a)return this.v2.clone();var b=new q;b.subVectors(this.v2,this.v1);b.multiplyScalar(a);b.add(this.v1);return b};Od.prototype=Object.create(Wa.prototype);Od.prototype.constructor=Od;ua.create=function(a,b){console.log(\"THREE.Curve.create() has been deprecated\");a.prototype=Object.create(ua.prototype);a.prototype.constructor= a;a.prototype.getPoint=b;return a};Xe.prototype=Object.create(va.prototype);Ye.prototype=Object.create(va.prototype);we.prototype=Object.create(va.prototype);Object.assign(we.prototype,{initFromArray:function(a){console.error(\"THREE.Spline: .initFromArray() has been removed.\")},getControlPointsArray:function(a){console.error(\"THREE.Spline: .getControlPointsArray() has been removed.\")},reparametrizeByArcLength:function(a){console.error(\"THREE.Spline: .reparametrizeByArcLength() has been removed.\")}}); fd.prototype.setColors=function(){console.error(\"THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.\")};Object.assign(sc.prototype,{center:function(a){console.warn(\"THREE.Box2: .center() has been renamed to .getCenter().\");return this.getCenter(a)},empty:function(){console.warn(\"THREE.Box2: .empty() has been renamed to .isEmpty().\");return this.isEmpty()},isIntersectionBox:function(a){console.warn(\"THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().\"); return this.intersectsBox(a)},size:function(a){console.warn(\"THREE.Box2: .size() has been renamed to .getSize().\");return this.getSize(a)}});Object.assign(Pa.prototype,{center:function(a){console.warn(\"THREE.Box3: .center() has been renamed to .getCenter().\");return this.getCenter(a)},empty:function(){console.warn(\"THREE.Box3: .empty() has been renamed to .isEmpty().\");return this.isEmpty()},isIntersectionBox:function(a){console.warn(\"THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().\"); return this.intersectsBox(a)},isIntersectionSphere:function(a){console.warn(\"THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().\");return this.intersectsSphere(a)},size:function(a){console.warn(\"THREE.Box3: .size() has been renamed to .getSize().\");return this.getSize(a)}});hb.prototype.center=function(a){console.warn(\"THREE.Line3: .center() has been renamed to .getCenter().\");return this.getCenter(a)};N.random16=function(){console.warn(\"THREE.Math.random16() has been deprecated. Use Math.random() instead.\"); return Math.random()};Object.assign(ya.prototype,{flattenToArrayOffset:function(a,b){console.warn(\"THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.\");return this.toArray(a,b)},multiplyVector3:function(a){console.warn(\"THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.\");return a.applyMatrix3(this)},multiplyVector3Array:function(a){console.warn(\"THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.\"); return this.applyToVector3Array(a)},applyToBuffer:function(a,b,c){console.warn(\"THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.\");return this.applyToBufferAttribute(a)},applyToVector3Array:function(a,b,c){console.error(\"THREE.Matrix3: .applyToVector3Array() has been removed.\")}});Object.assign(S.prototype,{extractPosition:function(a){console.warn(\"THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().\");return this.copyPosition(a)}, flattenToArrayOffset:function(a,b){console.warn(\"THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.\");return this.toArray(a,b)},getPosition:function(){var a;return function(){void 0===a&&(a=new q);console.warn(\"THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.\");return a.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(a){console.warn(\"THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().\"); return this.makeRotationFromQuaternion(a)},multiplyVector3:function(a){console.warn(\"THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.\");return a.applyMatrix4(this)},multiplyVector4:function(a){console.warn(\"THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.\");return a.applyMatrix4(this)},multiplyVector3Array:function(a){console.warn(\"THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.\"); return this.applyToVector3Array(a)},rotateAxis:function(a){console.warn(\"THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.\");a.transformDirection(this)},crossVector:function(a){console.warn(\"THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.\");return a.applyMatrix4(this)},translate:function(){console.error(\"THREE.Matrix4: .translate() has been removed.\")},rotateX:function(){console.error(\"THREE.Matrix4: .rotateX() has been removed.\")}, rotateY:function(){console.error(\"THREE.Matrix4: .rotateY() has been removed.\")},rotateZ:function(){console.error(\"THREE.Matrix4: .rotateZ() has been removed.\")},rotateByAxis:function(){console.error(\"THREE.Matrix4: .rotateByAxis() has been removed.\")},applyToBuffer:function(a,b,c){console.warn(\"THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.\");return this.applyToBufferAttribute(a)},applyToVector3Array:function(a,b,c){console.error(\"THREE.Matrix4: .applyToVector3Array() has been removed.\")}, makeFrustum:function(a,b,c,d,e,f){console.warn(\"THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.\");return this.makePerspective(a,b,d,c,e,f)}});la.prototype.isIntersectionLine=function(a){console.warn(\"THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().\");return this.intersectsLine(a)};ca.prototype.multiplyVector3=function(a){console.warn(\"THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.\"); return a.applyQuaternion(this)};Object.assign(cb.prototype,{isIntersectionBox:function(a){console.warn(\"THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().\");return this.intersectsBox(a)},isIntersectionPlane:function(a){console.warn(\"THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().\");return this.intersectsPlane(a)},isIntersectionSphere:function(a){console.warn(\"THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().\");return this.intersectsSphere(a)}}); Object.assign(Db.prototype,{extrude:function(a){console.warn(\"THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.\");return new La(this,a)},makeGeometry:function(a){console.warn(\"THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.\");return new Yb(this,a)}});Object.assign(D.prototype,{fromAttribute:function(a,b,c){console.error(\"THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().\");return this.fromBufferAttribute(a,b,c)}});Object.assign(q.prototype, {setEulerFromRotationMatrix:function(){console.error(\"THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.\")},setEulerFromQuaternion:function(){console.error(\"THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.\")},getPositionFromMatrix:function(a){console.warn(\"THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().\");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn(\"THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().\"); return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){console.warn(\"THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().\");return this.setFromMatrixColumn(b,a)},applyProjection:function(a){console.warn(\"THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.\");return this.applyMatrix4(a)},fromAttribute:function(a,b,c){console.error(\"THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().\");return this.fromBufferAttribute(a, b,c)}});Object.assign(fa.prototype,{fromAttribute:function(a,b,c){console.error(\"THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().\");return this.fromBufferAttribute(a,b,c)}});T.prototype.computeTangents=function(){console.warn(\"THREE.Geometry: .computeTangents() has been removed.\")};Object.assign(x.prototype,{getChildByName:function(a){console.warn(\"THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().\");return this.getObjectByName(a)},renderDepth:function(){console.warn(\"THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.\")}, translate:function(a,b){console.warn(\"THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.\");return this.translateOnAxis(b,a)}});Object.defineProperties(x.prototype,{eulerOrder:{get:function(){console.warn(\"THREE.Object3D: .eulerOrder is now .rotation.order.\");return this.rotation.order},set:function(a){console.warn(\"THREE.Object3D: .eulerOrder is now .rotation.order.\");this.rotation.order=a}},useQuaternion:{get:function(){console.warn(\"THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.\")}, set:function(){console.warn(\"THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.\")}}});Object.defineProperties(Ec.prototype,{objects:{get:function(){console.warn(\"THREE.LOD: .objects has been renamed to .levels.\");return this.levels}}});Fa.prototype.setLens=function(a,b){console.warn(\"THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.\");void 0!==b&&(this.filmGauge=b);this.setFocalLength(a)};Object.defineProperties(ma.prototype, {onlyShadow:{set:function(){console.warn(\"THREE.Light: .onlyShadow has been removed.\")}},shadowCameraFov:{set:function(a){console.warn(\"THREE.Light: .shadowCameraFov is now .shadow.camera.fov.\");this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn(\"THREE.Light: .shadowCameraLeft is now .shadow.camera.left.\");this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn(\"THREE.Light: .shadowCameraRight is now .shadow.camera.right.\");this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn(\"THREE.Light: .shadowCameraTop is now .shadow.camera.top.\"); this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn(\"THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.\");this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn(\"THREE.Light: .shadowCameraNear is now .shadow.camera.near.\");this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn(\"THREE.Light: .shadowCameraFar is now .shadow.camera.far.\");this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn(\"THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.\")}}, shadowBias:{set:function(a){console.warn(\"THREE.Light: .shadowBias is now .shadow.bias.\");this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn(\"THREE.Light: .shadowDarkness has been removed.\")}},shadowMapWidth:{set:function(a){console.warn(\"THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.\");this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn(\"THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.\");this.shadow.mapSize.height=a}}});Object.defineProperties(U.prototype, {length:{get:function(){console.warn(\"THREE.BufferAttribute: .length has been deprecated. Use .count instead.\");return this.array.length}}});Object.assign(I.prototype,{addIndex:function(a){console.warn(\"THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().\");this.setIndex(a)},addDrawCall:function(a,b,c){void 0!==c&&console.warn(\"THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.\");console.warn(\"THREE.BufferGeometry: .addDrawCall() is now .addGroup().\");this.addGroup(a, b)},clearDrawCalls:function(){console.warn(\"THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().\");this.clearGroups()},computeTangents:function(){console.warn(\"THREE.BufferGeometry: .computeTangents() has been removed.\")},computeOffsets:function(){console.warn(\"THREE.BufferGeometry: .computeOffsets() has been removed.\")}});Object.defineProperties(I.prototype,{drawcalls:{get:function(){console.error(\"THREE.BufferGeometry: .drawcalls has been renamed to .groups.\");return this.groups}},offsets:{get:function(){console.warn(\"THREE.BufferGeometry: .offsets has been renamed to .groups.\"); return this.groups}}});Object.defineProperties(Kd.prototype,{dynamic:{set:function(){console.warn(\"THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.\")}},onUpdate:{value:function(){console.warn(\"THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.\");return this}}});Object.defineProperties(X.prototype,{wrapAround:{get:function(){console.warn(\"THREE.\"+this.type+\": .wrapAround has been removed.\")},set:function(){console.warn(\"THREE.\"+this.type+ \": .wrapAround has been removed.\")}},wrapRGB:{get:function(){console.warn(\"THREE.\"+this.type+\": .wrapRGB has been removed.\");return new J}}});Object.defineProperties(Ca.prototype,{metal:{get:function(){console.warn(\"THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.\");return!1},set:function(){console.warn(\"THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead\")}}});Object.defineProperties(Ha.prototype,{derivatives:{get:function(){console.warn(\"THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.\"); return this.extensions.derivatives},set:function(a){console.warn(\"THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.\");this.extensions.derivatives=a}}});Object.assign(Yd.prototype,{supportsFloatTextures:function(){console.warn(\"THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).\");return this.extensions.get(\"OES_texture_float\")},supportsHalfFloatTextures:function(){console.warn(\"THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).\"); return this.extensions.get(\"OES_texture_half_float\")},supportsStandardDerivatives:function(){console.warn(\"THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).\");return this.extensions.get(\"OES_standard_derivatives\")},supportsCompressedTextureS3TC:function(){console.warn(\"THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).\");return this.extensions.get(\"WEBGL_compressed_texture_s3tc\")}, supportsCompressedTexturePVRTC:function(){console.warn(\"THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).\");return this.extensions.get(\"WEBGL_compressed_texture_pvrtc\")},supportsBlendMinMax:function(){console.warn(\"THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).\");return this.extensions.get(\"EXT_blend_minmax\")},supportsVertexTextures:function(){console.warn(\"THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.\"); return this.capabilities.vertexTextures},supportsInstancedArrays:function(){console.warn(\"THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).\");return this.extensions.get(\"ANGLE_instanced_arrays\")},enableScissorTest:function(a){console.warn(\"THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().\");this.setScissorTest(a)},initMaterial:function(){console.warn(\"THREE.WebGLRenderer: .initMaterial() has been removed.\")},addPrePlugin:function(){console.warn(\"THREE.WebGLRenderer: .addPrePlugin() has been removed.\")}, addPostPlugin:function(){console.warn(\"THREE.WebGLRenderer: .addPostPlugin() has been removed.\")},updateShadowMap:function(){console.warn(\"THREE.WebGLRenderer: .updateShadowMap() has been removed.\")}});Object.defineProperties(Yd.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn(\"THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.\");this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn(\"THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.\"); this.shadowMap.type=a}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(a){console.warn(\"THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.\");this.shadowMap.cullFace=a}}});Object.defineProperties(Ke.prototype,{cullFace:{get:function(){return this.renderReverseSided?2:1},set:function(a){a=1!==a;console.warn(\"WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to \"+a+\".\");this.renderReverseSided=a}}});Object.defineProperties(Ya.prototype, {wrapS:{get:function(){console.warn(\"THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.\");return this.texture.wrapS},set:function(a){console.warn(\"THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.\");this.texture.wrapS=a}},wrapT:{get:function(){console.warn(\"THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.\");return this.texture.wrapT},set:function(a){console.warn(\"THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.\");this.texture.wrapT=a}},magFilter:{get:function(){console.warn(\"THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.\"); return this.texture.magFilter},set:function(a){console.warn(\"THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.\");this.texture.magFilter=a}},minFilter:{get:function(){console.warn(\"THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.\");return this.texture.minFilter},set:function(a){console.warn(\"THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.\");this.texture.minFilter=a}},anisotropy:{get:function(){console.warn(\"THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.\"); return this.texture.anisotropy},set:function(a){console.warn(\"THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.\");this.texture.anisotropy=a}},offset:{get:function(){console.warn(\"THREE.WebGLRenderTarget: .offset is now .texture.offset.\");return this.texture.offset},set:function(a){console.warn(\"THREE.WebGLRenderTarget: .offset is now .texture.offset.\");this.texture.offset=a}},repeat:{get:function(){console.warn(\"THREE.WebGLRenderTarget: .repeat is now .texture.repeat.\");return this.texture.repeat}, set:function(a){console.warn(\"THREE.WebGLRenderTarget: .repeat is now .texture.repeat.\");this.texture.repeat=a}},format:{get:function(){console.warn(\"THREE.WebGLRenderTarget: .format is now .texture.format.\");return this.texture.format},set:function(a){console.warn(\"THREE.WebGLRenderTarget: .format is now .texture.format.\");this.texture.format=a}},type:{get:function(){console.warn(\"THREE.WebGLRenderTarget: .type is now .texture.type.\");return this.texture.type},set:function(a){console.warn(\"THREE.WebGLRenderTarget: .type is now .texture.type.\"); this.texture.type=a}},generateMipmaps:{get:function(){console.warn(\"THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.\");return this.texture.generateMipmaps},set:function(a){console.warn(\"THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.\");this.texture.generateMipmaps=a}}});hc.prototype.load=function(a){console.warn(\"THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.\");var b=this;(new ge).load(a,function(a){b.setBuffer(a)});return this}; le.prototype.getData=function(){console.warn(\"THREE.AudioAnalyser: .getData() is now .getFrequencyData().\");return this.getFrequencyData()};l.WebGLRenderTargetCube=Gb;l.WebGLRenderTarget=Ya;l.WebGLRenderer=Yd;l.ShaderLib=bb;l.UniformsLib=V;l.UniformsUtils=Ja;l.ShaderChunk=Z;l.FogExp2=Kb;l.Fog=Lb;l.Scene=mb;l.LensFlare=Zd;l.Sprite=Dc;l.LOD=Ec;l.SkinnedMesh=qd;l.Skeleton=od;l.Bone=pd;l.Mesh=Aa;l.LineSegments=ga;l.Line=Ua;l.Points=Mb;l.Group=Fc;l.VideoTexture=rd;l.DataTexture=eb;l.CompressedTexture= Nb;l.CubeTexture=Za;l.CanvasTexture=sd;l.DepthTexture=Gc;l.Texture=ea;l.CompressedTextureLoader=Re;l.DataTextureLoader=ae;l.CubeTextureLoader=be;l.TextureLoader=td;l.ObjectLoader=Se;l.MaterialLoader=Hd;l.BufferGeometryLoader=ce;l.DefaultLoadingManager=ta;l.LoadingManager=$d;l.JSONLoader=de;l.ImageLoader=Yc;l.FontLoader=Ue;l.FileLoader=sa;l.Loader=zb;l.Cache=ld;l.AudioLoader=ge;l.SpotLightShadow=vd;l.SpotLight=wd;l.PointLight=xd;l.RectAreaLight=he;l.HemisphereLight=ud;l.DirectionalLightShadow=yd;l.DirectionalLight= zd;l.AmbientLight=Ad;l.LightShadow=wb;l.Light=ma;l.StereoCamera=Ve;l.PerspectiveCamera=Fa;l.OrthographicCamera=Jb;l.CubeCamera=Id;l.Camera=ra;l.AudioListener=ie;l.PositionalAudio=ke;l.AudioContext=je;l.AudioAnalyser=le;l.Audio=hc;l.VectorKeyframeTrack=dc;l.StringKeyframeTrack=Ed;l.QuaternionKeyframeTrack=$c;l.NumberKeyframeTrack=ec;l.ColorKeyframeTrack=Gd;l.BooleanKeyframeTrack=Fd;l.PropertyMixer=Jd;l.PropertyBinding=ka;l.KeyframeTrack=yb;l.AnimationUtils=na;l.AnimationObjectGroup=me;l.AnimationMixer= cd;l.AnimationClip=qa;l.Uniform=Kd;l.InstancedBufferGeometry=Eb;l.BufferGeometry=I;l.GeometryIdCount=function(){return Vd++};l.Geometry=T;l.InterleavedBufferAttribute=oe;l.InstancedInterleavedBuffer=jc;l.InterleavedBuffer=ic;l.InstancedBufferAttribute=kc;l.Face3=ha;l.Object3D=x;l.Raycaster=pe;l.Layers=nd;l.EventDispatcher=pa;l.Clock=re;l.QuaternionLinearInterpolant=Dd;l.LinearInterpolant=Zc;l.DiscreteInterpolant=Cd;l.CubicInterpolant=Bd;l.Interpolant=xa;l.Triangle=za;l.Math=N;l.Spherical=se;l.Cylindrical= te;l.Plane=la;l.Frustum=tc;l.Sphere=Na;l.Ray=cb;l.Matrix4=S;l.Matrix3=ya;l.Box3=Pa;l.Box2=sc;l.Line3=hb;l.Euler=db;l.Vector4=fa;l.Vector3=q;l.Vector2=D;l.Quaternion=ca;l.Color=J;l.MorphBlendMesh=oa;l.ImmediateRenderObject=dd;l.VertexNormalsHelper=ed;l.SpotLightHelper=lc;l.SkeletonHelper=mc;l.PointLightHelper=nc;l.RectAreaLightHelper=oc;l.HemisphereLightHelper=pc;l.GridHelper=fd;l.PolarGridHelper=Ld;l.FaceNormalsHelper=gd;l.DirectionalLightHelper=qc;l.CameraHelper=hd;l.BoxHelper=rc;l.ArrowHelper=Fb; l.AxisHelper=Nd;l.CatmullRomCurve3=va;l.CubicBezierCurve3=id;l.QuadraticBezierCurve3=jd;l.LineCurve3=kd;l.ArcCurve=Od;l.EllipseCurve=Wa;l.SplineCurve=Cb;l.CubicBezierCurve=fc;l.QuadraticBezierCurve=gc;l.LineCurve=Ta;l.Shape=Db;l.Path=bd;l.ShapePath=ee;l.Font=fe;l.CurvePath=ad;l.Curve=ua;l.ShapeUtils=Ia;l.SceneUtils={createMultiMaterialObject:function(a,b){for(var c=new Fc,d=0,e=b.length;d"}],"posts":[{"title":"使用hexo-next+LaTeX输入公式时遇到的一些错误","slug":"usingLaTeXinmd","date":"2019-03-23T06:37:00.704Z","updated":"2019-03-23T06:54:30.631Z","comments":true,"path":"2019/03/23/usingLaTeXinmd/","link":"","permalink":"https://ainevsia.github.io/2019/03/23/usingLaTeXinmd/","excerpt":"起因去next配置里开了mathjax功能试了一下，遇到了些问题。 举个栗子当你按照LaTeX语法在md文件里输入如下公式时，在本地的Markdown preview里是没有任何错误的，但是部署上线后会是如下的效果","text":"起因去next配置里开了mathjax功能试了一下，遇到了些问题。 举个栗子当你按照LaTeX语法在md文件里输入如下公式时，在本地的Markdown preview里是没有任何错误的，但是部署上线后会是如下的效果 公式 1$J(\\theta)=-\\frac&#123;1&#125;&#123;m&#125; \\sum_&#123;i=1&#125;^&#123;m&#125;\\left[y^&#123;(i)&#125; \\log \\left(h_&#123;\\theta&#125;\\left(x^&#123;(i)&#125;\\right)\\right)+\\left(1-y^&#123;(i)&#125;\\right) \\log \\left(1-h_&#123;\\theta&#125;\\left(x^&#123;(i)&#125;\\right)\\right)\\right]$ 效果 $J(\\theta)=-\\frac{1}{m} \\sum{i=1}^{m}\\left[y^{(i)} \\log \\left(h{\\theta}\\left(x^{(i)}\\right)\\right)+\\left(1-y^{(i)}\\right) \\log \\left(1-h_{\\theta}\\left(x^{(i)}\\right)\\right)\\right]$ 注意在_之间的部分全部被解析成了Markdown语法中的斜体，其实原因就是hexo在静态生成网页时是先用Markdown的语法解析器解析你的md文件，然后再交给mathjax解析其中的公式。 解决在_前全部加上Markdown语法中的转义符\\。 不过这样感觉就即不是纯正的Markdown，也不是是纯正的LaTeX了。 公式 1$J(\\theta)=-\\frac&#123;1&#125;&#123;m&#125; \\sum\\_&#123;i=1&#125;^&#123;m&#125;\\left[y^&#123;(i)&#125; \\log \\left(h\\_&#123;\\theta&#125;\\left(x^&#123;(i)&#125;\\right)\\right)+\\left(1-y^&#123;(i)&#125;\\right) \\log \\left(1-h\\_&#123;\\theta&#125;\\left(x^&#123;(i)&#125;\\right)\\right)\\right]$ 效果 $J(\\theta)=-\\frac{1}{m} \\sum_{i=1}^{m}\\left[y^{(i)} \\log \\left(h_{\\theta}\\left(x^{(i)}\\right)\\right)+\\left(1-y^{(i)}\\right) \\log \\left(1-h_{\\theta}\\left(x^{(i)}\\right)\\right)\\right]$","categories":[{"name":"hexo","slug":"hexo","permalink":"https://ainevsia.github.io/categories/hexo/"}],"tags":[{"name":"LaTeX hexo-nex","slug":"LaTeX-hexo-nex","permalink":"https://ainevsia.github.io/tags/LaTeX-hexo-nex/"}]},{"title":"Machine Learning Note Week 3","slug":"ML-W3","date":"2019-03-12T09:18:05.367Z","updated":"2019-03-20T07:03:28.523Z","comments":true,"path":"2019/03/12/ML-W3/","link":"","permalink":"https://ainevsia.github.io/2019/03/12/ML-W3/","excerpt":"ClassificationTo attempt classification, one method is to use linear regression and map all predictions greater than 0.5 as a 1 and all less than 0.5 as a 0. However, this method doesn’t work well because classification is not actually a linear function. The classification problem is just like the regression problem, except that the values we now want to predict take on only a small number of discrete values. For now, we will focus on the binary classification problem in which y can take on only two values, 0 and 1. (Most of what we say here will also generalize to the multiple-class case.)","text":"ClassificationTo attempt classification, one method is to use linear regression and map all predictions greater than 0.5 as a 1 and all less than 0.5 as a 0. However, this method doesn’t work well because classification is not actually a linear function. The classification problem is just like the regression problem, except that the values we now want to predict take on only a small number of discrete values. For now, we will focus on the binary classification problem in which y can take on only two values, 0 and 1. (Most of what we say here will also generalize to the multiple-class case.)For instance, if we are trying to build a spam classifier for email, then $x^{(i)}$may be some features of a piece of email, and y may be 1 if it is a piece of spam mail, and 0 otherwise. Hence, y∈{0,1}. 0 is also called the negative class, and 1 the positive class, and they are sometimes also denoted by the symbols “-” and “+.” Given $x^{(i)}$, the corresponding $y^{(i)}$ is also called the label for the training example. Simplified Cost Function and Gradient DescentWe can fully write out our entire cost function as follows: $J(\\theta)=-\\frac{1}{m} \\sum_{i=1}^{m}\\left[y^{(i)} \\log \\left(h_{\\theta}\\left(x^{(i)}\\right)\\right)+\\left(1-y^{(i)}\\right) \\log \\left(1-h_{\\theta}\\left(x^{(i)}\\right)\\right)\\right]$ $\\theta_{j} :=\\theta_{j}-\\frac{\\alpha}{m} \\sum_{i=1}^{m}\\left(h_{\\theta}\\left(x^{(i)}\\right)-y^{(i)}\\right) x_{j}^{(i)}$ A vectorized implementation is: $\\theta :=\\theta-\\frac{\\alpha}{m} X^{T}(g(X \\theta)-\\vec{y})$","categories":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/categories/SJTU/"}],"tags":[{"name":"MachineLearning","slug":"MachineLearning","permalink":"https://ainevsia.github.io/tags/MachineLearning/"}]},{"title":"Machine Learning Note Week 2","slug":"ML-W2","date":"2019-03-11T03:20:39.640Z","updated":"2019-03-20T07:03:29.842Z","comments":true,"path":"2019/03/11/ML-W2/","link":"","permalink":"https://ainevsia.github.io/2019/03/11/ML-W2/","excerpt":"Multiple FeaturesLinear regression with multiple variables is also known as “multivariate linear regression”. We now introduce notation for equations where we can have any number of input variables.","text":"Multiple FeaturesLinear regression with multiple variables is also known as “multivariate linear regression”. We now introduce notation for equations where we can have any number of input variables. Gradient Descent in Practice I - Feature Scaling 特征缩放We can speed up gradient descent by having each of our input values in roughly the same range. This is because θ will descend quickly on small ranges and slowly on large ranges, and so will oscillate inefficiently down to the optimum when the variables are very uneven. The way to prevent this is to modify the ranges of our input variables so that they are all roughly the same. The goal is to get all input variables into roughly one of these ranges, give or take a few. Two techniques to help with this are feature scaling and mean normalization. Feature scaling involves dividing the input values by the range (i.e. the maximum value minus the minimum value) of the input variable, resulting in a new range of just 1. Mean normalization involves subtracting the average value for an input variable from the values for that input variable resulting in a new average value for the input variable of just zero. To implement both of these techniques, adjust your input values as shown in this formula: $x_{i} :=\\frac{x_{i}-\\mu_{i}}{s_{i}}$ Note that dividing by the range, or dividing by the standard deviation, give different results. The quizzes in this course use range - the programming exercises use standard deviation. Normal EquationGradient descent gives one way of minimizing J. Let’s discuss a second way of doing so, this time performing the minimization explicitly and without resorting to an iterative algorithm. In the “Normal Equation” method, we will minimize J by explicitly taking its derivatives with respect to the θj ’s, and setting them to zero. This allows us to find the optimum theta without iteration. The normal equation formula is given below: $\\theta=\\left(X^{T} X\\right)^{-1} X^{T} y$ round off 四舍五入","categories":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/categories/SJTU/"}],"tags":[{"name":"MachineLearning","slug":"MachineLearning","permalink":"https://ainevsia.github.io/tags/MachineLearning/"}]},{"title":"Anagram","slug":"anagram","date":"2019-03-09T09:50:07.080Z","updated":"2019-03-09T10:26:31.997Z","comments":true,"path":"2019/03/09/anagram/","link":"","permalink":"https://ainevsia.github.io/2019/03/09/anagram/","excerpt":"一个很有意思的易位构词本来想在寝室四人的合影上刻上一句话 结果想到了易位构词 Three hero outwit few gamer.","text":"一个很有意思的易位构词本来想在寝室四人的合影上刻上一句话 结果想到了易位构词 Three hero outwit few gamer. Together with me, we are four.","categories":[{"name":"Fun","slug":"Fun","permalink":"https://ainevsia.github.io/categories/Fun/"}],"tags":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/tags/SJTU/"}]},{"title":"Machine Learning Note","slug":"ML-W1","date":"2019-03-07T09:33:50.292Z","updated":"2019-03-23T06:36:27.220Z","comments":true,"path":"2019/03/07/ML-W1/","link":"","permalink":"https://ainevsia.github.io/2019/03/07/ML-W1/","excerpt":"What is Machine Learning?Two definitions of Machine Learning are offered. Arthur Samuel described it as: “the field of study that gives computers the abilit3y to learn without being explicitly programmed.” This is an older, informal definition. Tom Mitchell provides a more modern definition: “A computer program is said to learn from experience E with respect to some class of tasks T and performance measure P, if its performance at tasks in T, as measured by P, improves with experience E.”","text":"What is Machine Learning?Two definitions of Machine Learning are offered. Arthur Samuel described it as: “the field of study that gives computers the abilit3y to learn without being explicitly programmed.” This is an older, informal definition. Tom Mitchell provides a more modern definition: “A computer program is said to learn from experience E with respect to some class of tasks T and performance measure P, if its performance at tasks in T, as measured by P, improves with experience E.” Example: playing checkers.E = the experience of playing many games of checkersT = the task of playing checkers.P = the probability that the program will win the next game.In general, any machine learning problem can be assigned to one of two broad classifications:Supervised learning and Unsupervised learning. Machine Learning Algorithms Supervised Learning Unsupervised Learning Supervised LearningIn supervised learning, we are given a data set and already know what our correct output should look like, having the idea that there is a relationship between the input and the output.Supervised learning problems are categorized into “regression” and “classification” problems. In a regression problem, we are trying to predict results within a continuous output, meaning that we are trying to map input variables to some continuous function. In a classification problem, we are instead trying to predict results in a discrete output. In other words, we are trying to map input variables into discrete categories. Example 1:Given data about the size of houses on the real estate market, try to predict their price. Price as a function of size is a continuous output, so this is a regression problem.We could turn this example into a classification problem by instead making our output about whether the house “sells for more or less than the asking price.” Here we are classifying the houses based on price into two discrete categories. Example 2:(a) Regression - Given a picture of a person, we have to predict their age on the basis of the given picture(b) Classification - Given a patient with a tumor, we have to predict whether the tumor is malignant or benign. Unsupervised LearningUnsupervised learning allows us to approach problems with little or no idea what our results should look like. We can derive structure from data where we don’t necessarily know the effect of the variables.We can derive this structure by clustering the data based on relationships among the variables in the data.With unsupervised learning there is no feedback based on the prediction results. Example:Clustering: Take a collection of 1,000,000 different genes, and find a way to automatically group these genes into groups that are somehow similar or related by different variables, such as lifespan, location, roles, and so on.Non-clustering: The “Cocktail Party Algorithm”, allows you to find structure in a chaotic environment. (i.e. identifying individual voices and music from a mesh of sounds at a cocktail party). Linear RegressionModel RepresentationTo establish notation for future use, we’ll use $x^{(i)}$ to denote the “input” variables (living area in this example), also called input features, and $y^{(i)}$ to denote the “output” or target variable that we are trying to predict (price). A pair $\\left(x^{(i)}, y^{(i)}\\right)$ is called a training example, and the dataset that we’ll be using to learn—a list of m training examples $\\left(x^{(i)}, y^{(i)}\\right); i=1,…,m$—is called a training set. Note that the superscript “(i)” in the notation is simply an index into the training set, and has nothing to do with exponentiation. We will also use X to denote the space of input values, and Y to denote the space of output values. In this example, X = Y = ℝ. To describe the supervised learning problem slightly more formally, our goal is, given a training set, to learn a function h : X → Y so that h(x) is a “good” predictor for the corresponding value of y. For historical reasons, this function h is called a hypothesis. Seen pictorially, the process is therefore like this: When the target variable that we’re trying to predict is continuous, such as in our housing example, we call the learning problem a regression problem. When y can take on only a small number of discrete values (such as if, given the living area, we wanted to predict if a dwelling is a house or an apartment, say), we call it a classification problem. Cost FunctionWe can measure the accuracy of our hypothesis function by using a cost function. This takes an average difference (actually a fancier version of an average) of all the results of the hypothesis with inputs from x’s and the actual output y’s. ​$J\\left(\\theta_{0}, \\theta_{1}\\right)=\\frac{1}{2 m} \\sum_{i=1}^{m}\\limits\\left(\\hat{y}_{i}-y_{i}\\right)^{2}=\\frac{1}{2 m} \\sum_{i=1}^{m}\\limits\\left(h_{\\theta}\\left(x_{i}\\right)-y_{i}\\right)^{2}$ 注释：方差(Mean squared error)的1/2。统计学中参数估计部分的内容。 To break it apart, it is $\\frac{1}{2}\\bar{x}$ where $\\bar{x}$ is the mean of the squares of $h_{\\theta}\\left(x_{i}\\right)-y_{i}$, or the difference between the predicted value and the actual value. This function is otherwise called the “Squared error function”, or “Mean squared error”. The mean is halved$\\left(\\frac{1}{2}\\right)$ as a convenience for the computation of the gradient descent(梯度下降), as the derivative(导数) term of the square function will cancel out the $\\frac{1}{2}$ term. The following image summarizes what the cost function does: Cost Function - Intuition IIf we try to think of it in visual terms, our training data set is scattered on the x-y plane. We are trying to make a straight line (defined by hθ(x)) which passes through these scattered data points. Our objective is to get the best possible line. The best possible line will be such so that the average squared vertical distances of the scattered points from the line will be the least. Ideally, the line should pass through all the points of our training data set. In such a case, the value of J(θ0,θ1) will be 0. Thus as a goal, we should try to minimize the cost function. In this case, θ1=1 is our global minimum. Cost Function - Intuition IIA contour plot(等高线地形图) is a graph that contains many contour lines. A contour line of a two variable function has a constant value at all points of the same line.","categories":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/categories/SJTU/"}],"tags":[{"name":"MachineLearning","slug":"MachineLearning","permalink":"https://ainevsia.github.io/tags/MachineLearning/"}]},{"title":"2. Add Two Numbers","slug":"LeetCode-2-AddTwoNumbers","date":"2019-03-01T09:50:34.255Z","updated":"2019-03-01T10:54:49.502Z","comments":true,"path":"2019/03/01/LeetCode-2-AddTwoNumbers/","link":"","permalink":"https://ainevsia.github.io/2019/03/01/LeetCode-2-AddTwoNumbers/","excerpt":"","text":"读题的时候不认真看题写的时候就会完全按照自己想象中的题目去解题 这道题两个数字明明是已经逆向好给我做加法了 我还傻呵呵地先写了一遍 把两个链表逆向了一遍 另外 java也不太懂 reflections5+5的情况WA了一次 没有想到这样的情况 myCode1234567891011121314151617181920212223242526272829303132333435363738394041/** * Definition for singly-linked list. * public class ListNode &#123; * int val; * ListNode next; * ListNode(int x) &#123; val = x; &#125; * &#125; */class Solution &#123; public ListNode addTwoNumbers(ListNode l1, ListNode l2) &#123; int carry = 0; boolean conti = true; ListNode ret = new ListNode(0), al1 = l1, al2 = l2; ListNode r = ret; while (conti) &#123; int a1 = 0, a2 = 0; if (al1!=null) &#123; a1 = al1.val; al1 = al1.next; &#125; if (al2!=null) &#123; a2 = al2.val; al2 = al2.next; &#125; int sum = a1 + a2 + carry; if (sum&gt;=10) &#123; sum -= 10; carry = 1; &#125;else &#123; carry = 0; &#125; ret.val = sum; if (al1==null &amp;&amp; al2==null &amp;&amp; carry==0) conti = false; if (conti) &#123; ret.next = new ListNode(0); ret = ret.next; &#125; &#125; return r; &#125;&#125; Official12345678910111213141516171819public ListNode addTwoNumbers(ListNode l1, ListNode l2) &#123; ListNode dummyHead = new ListNode(0); ListNode p = l1, q = l2, curr = dummyHead; int carry = 0; while (p != null || q != null) &#123; int x = (p != null) ? p.val : 0; int y = (q != null) ? q.val : 0; int sum = carry + x + y; carry = sum / 10; curr.next = new ListNode(sum % 10); curr = curr.next; if (p != null) p = p.next; if (q != null) q = q.next; &#125; if (carry &gt; 0) &#123; curr.next = new ListNode(carry); &#125; return dummyHead.next;&#125; 真的是短小精悍啊！","categories":[{"name":"LeetCode","slug":"LeetCode","permalink":"https://ainevsia.github.io/categories/LeetCode/"}],"tags":[{"name":"linked-list math","slug":"linked-list-math","permalink":"https://ainevsia.github.io/tags/linked-list-math/"}]},{"title":"Future","slug":"Future","date":"2019-02-17T01:10:46.000Z","updated":"2019-03-02T06:40:23.469Z","comments":true,"path":"2019/02/17/Future/","link":"","permalink":"https://ainevsia.github.io/2019/02/17/Future/","excerpt":"","text":"刚刚和父母聊了聊他们对于我未来的规划，重大的选择之前，我总是会考虑他们的意见。 无论对我的任何选择，母亲总是会理解我、支持我，而父亲则是站在了一个完全理性的角度给我指明可预见的最好的那条路。 我说我打算出国，美国太乱的话欧洲也可以。 父亲指出：我目前自理能力全无，衣食住行没有一样是能够独立的。以我的能力，能申请到的也都是些野鸡学校。 我反驳，我自理能力确实不行，但是我绝对能申请到名校！ 父亲说，现在已经不是改革开放了，大家都挤破头往外国去。目前外国的毕业生在就业市场上并没有什么什么优势。 我沉默了。 如果最终的目标还是回国工作的话，为什么要舍近求远呢？ # 晚餐后看了一篇毕世门的推送，感觉自己的内心好像又开始动摇了 想想父母的话，我又觉得心安了。 这是机会啊学了什么会了什么目前有些什么想法任何问题都可以问 大学生涯综述目前掌握的技能一点点把自己培养成技术人员该达到的水平 学习到的 读过的书 网络是怎样连接的 网络部 户根勤 密码学 jsdom编程艺术 编程语言类 课程ics 使用过c/c++/简易汇编/python/matlab/java/js/html/css/ ctf Linux/mac -&gt; 实验室 软件漏洞分析 人工智能的方法 漏洞分析学校的课程软硬皆功 理财 基金 背单词 小说 课余活动 志愿者 团体活动学生组织课业做ps 不会设计 想退实验室 看书 尽快地 运动比较少与人交流比较少认识的朋友也 想法长远考虑读硕士 不读博士走业界 不走学界 读完硕士 在国内就职 不想就简简单单写代码","categories":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/categories/SJTU/"}],"tags":[{"name":"保研 出国","slug":"保研-出国","permalink":"https://ainevsia.github.io/tags/保研-出国/"}]},{"title":"自建服务器","slug":"OpenVpnOnOpenWrt","date":"2019-02-17T01:10:46.000Z","updated":"2019-03-07T12:11:00.522Z","comments":true,"path":"2019/02/17/OpenVpnOnOpenWrt/","link":"","permalink":"https://ainevsia.github.io/2019/02/17/OpenVpnOnOpenWrt/","excerpt":"","text":"现状目前手上有三台服务器：一台windows，两台linux，还有一台路由器，openwrt固件，上面跑openvpn服务器，客户端安装openvpn客户端实现连接。公网ip从哪里来的还不清楚，暂时默认是从百度云上买来的，算是已知的了。 目标5月份开始正式调试，最多两周的时间要搞定，不想拖的时间太长了。 最终实现的目标是完整地复制已有的路由器的所有功能，目前主要只有openvpn的配置。","categories":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/categories/SJTU/"}],"tags":[{"name":"vpn 计算机网络","slug":"vpn-计算机网络","permalink":"https://ainevsia.github.io/tags/vpn-计算机网络/"}]},{"title":"寒假回顾+学期计划","slug":"sophomore-Winter","date":"2019-02-17T01:10:46.000Z","updated":"2019-03-02T06:46:24.009Z","comments":true,"path":"2019/02/17/sophomore-Winter/","link":"","permalink":"https://ainevsia.github.io/2019/02/17/sophomore-Winter/","excerpt":"","text":"寒假见闻寒假从1月14日开始执行，由于在1月25日约了朋友一起参加美赛，所以14日到25日这两个礼拜就是常规培训、准备美赛。由于我和密院同年级的同学组队，中途跑了一个，只好带了一个大一小学妹凑满3个人，十足的菜鸡队配置。好像是第一次认认真真地参加大型团队竞赛，内心也没有什么底，抱着纯粹体验一把的心态稀里糊涂地就混到了25日。 我个人确实是极其不擅长与他人合作完成一个项目。开赛两小时我去图书馆借走了相关的书，我一度认为这些书能成为我们队的优势。但是，可能就是这些书限制了思路。书上用了CA，虽然到最后我们也没有能实现这个程序。当我和别人发生意见上的分歧时，我总是很难说服对方，我总是倾向于放弃我自己的想法，去听别人的指挥做事。我觉得自己除了第一天状态是在线的，剩下的4天智商全面下线，程序不想写，模型不知道怎么建，自暴自弃。 最后一天的通宵也是非常有意思。人生中第一次通宵，0点小憩了10分钟左右，之后完全没有很难受的感觉。整个教室挤满了人，没有回去睡觉的……虽然如此，如果是为了我个人的事情，我是绝对不会通宵的。 我也很想变的强一点，想一个更好的模型云云。美赛结束就已经29日了，再过一个礼拜就春节了。29日到除夕这个礼拜就完全是放飞自我的状态，每天打网游、补番、刷小说，干着自己每次放假都会干的事。把自己玩过的游戏一个个地玩过来，没有一个游戏能让我玩超过半天。我已经不再年轻了，曾经陪我一起打网游的人，现在也都各奔东西，再也找不到曾今的感觉了。而那些游戏，也随之失去了意义。嘛总之，花了不超过两周吧，把那些令人放纵的东西都玩腻了，把目光转向修养身心的东西上。 阅读文学类的从学期结束之前就已经在知米阅读上看原版的《时间机器》和《弗兰肯斯坦》，也不是会每天都读，会把情节攒起来一口气看。开学之后必须要养成每日打卡的习惯了，因为没什么时间能一口气看了。 非文学类的看了《万万没想到》、《csapp》、《算法》，这三本都是只看了10页的那种看，真正看的主要是老师要求的《漏洞分析》。 春节的时候，我轻哼：三个礼拜二十一天三百页十七章，按照我三天四章的速度，真的是绰绰有余。今天已经是寒假最后一天了，我正好看了一半。 有些时候吧，求其上者得其中，这种感觉真的实在是太强烈了。像我这种懒惰的人，在设定目标的时候就应该设置的高一点。压力对我来说并不是朋友，在高压下我只会惊慌失措，只有在心情平稳的时候我的效率才是最高的。所以说，大段的连续的时间是我必须要全神贯注地工作学习的时候。 有的时候我会问自己：我这是在干什么？当舍友告诉我他因为组会没法参加而决定退出的时候，我问自己：我是真的喜欢漏洞挖掘所以来到目前的这个实验室吗？我思考问题的时候一直是一种小农思想，即使进入大学这种想法也没法改正过来。过分地关注短期将会得到的利益，而不做长远的考虑。我害怕做出选择，选择之后又患得患失。我还需学习的知识实在是太多了，不知道我学什么能够学好。解决这种选择困难的方法就是安慰自己：我的生活并不会因为这一个选择就能变好，选了就选了，硬着头皮干下去，时间和努力不会亏待你的。 未来规划这个寒假和父母稍微聊了一下关于自己未来准备走的路线。我个人还是非常向往国外的教育的，但是父亲指出我根本不具备一个人在异国独立生活的基本能力。我想想也是，所以还是把目标定在了保研或是考研国内升学的方向。 上个学期给自己定下的每门课不低于85分的目标完美地完成了，更多的还是因为课程考试不难的原因，但是这学期出现了信号与系统和模电，我不敢再轻言不下85了。我渐渐意识到这种单纯以成绩来评价一学期是不科学的，因为这学期我还会有实验室的工作要做，难免会占去学习课内知识的时间。 我这学期的计划是信安的专业课我绝对是放在第一优先级的事情，然后再是电院的平台课，中间穿插实验室的研究吧。 写的非常的乱，但都是心底想说的话，暂且作为人生这一小段时光的总结吧。","categories":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/categories/SJTU/"}],"tags":[{"name":"保研 出国","slug":"保研-出国","permalink":"https://ainevsia.github.io/tags/保研-出国/"}]},{"title":"Sophomore Winter Dairy","slug":"SophomoreWinter","date":"2019-02-05T10:41:45.000Z","updated":"2019-02-15T09:03:25.994Z","comments":true,"path":"2019/02/05/SophomoreWinter/","link":"","permalink":"https://ainevsia.github.io/2019/02/05/SophomoreWinter/","excerpt":"","text":"2019年2月5日18:41:53大年初一，在家宅了一整天没有出门。 下午在玩新发现的卡牌类MOBA红莲之王，感觉可定制的程度更加大了，同时竞技性略有下降，娱乐性确实很强。 早上在Pinterest上随便搜了一张图群发微信好友，发到一半就不怎么想发了。 看到阿阳男神今天第一次上高架，特别羡慕，我还有几天才能满1年能上高架。 感觉他们都各有各自的朋友，而我，什么也没有。 忍受寂寞。 2019年2月3日19:36:04决定和寒假颓废的自己告别了 QQ飞车也开过了 LOL也打过了 王者荣耀也玩了 300英雄也玩了漫画也看了 番也补了 小说也看了 想做的事都干了 很遗憾我闲下来的时候最先想到的居然是这些事 说人话的话 就是： 我玩腻了 2019年2月1日23:56:00又在家宅了一整天 白天下LOL 下午玩LOL 晚上卸载LOL 苦笑 这也算是一种进步吧 不是吗 已经没有游戏能够吸引我超过一天了 在游戏里我也无法寻找自己曾经所追寻的那个世界了 还有2min 睡了","categories":[{"name":"Dairy","slug":"Dairy","permalink":"https://ainevsia.github.io/categories/Dairy/"}],"tags":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/tags/SJTU/"}]},{"title":"MCM/ICM Thoughts","slug":"MCM&ICM","date":"2019-01-29T01:55:37.000Z","updated":"2019-01-29T02:01:32.242Z","comments":true,"path":"2019/01/29/MCM&ICM/","link":"","permalink":"https://ainevsia.github.io/2019/01/29/MCM&ICM/","excerpt":"","text":"2019-1-29 09:55:44随便写点什么吧 随便写点关于参加完美赛的感想 可是我发觉我根本什么都不想写 美赛的四天，我大部分时间是在郁闷中度过的 今天通了个宵 没有什么特别的感觉 看着太阳落下去 然后再次升起来 有一种恍若隔世的感觉 春节已经到了 美赛完了 我也没有任何特别的计划 没有人逼着我我是不会去学的 可是我在巨大的压力之下 又学不进 前几天红星的歌现在是一首也听不进 研究计划已经跟不上了 还有厚厚的一本书等着我 shit 2019-1-21 12:34:15 这是大一的暑假我们四人留下的为数不多的合影 好想和他们每隔一段时间都留下一张令人难忘的合影啊 从长远来看，所有的事情都会变得物是人非 既然这样 为什么还要对现况患得患失 享受当下 2019-1-19 23:20:03开始慌了不知道自己能不能应对这次的MCM挑战啊 英语阅读已经连着一个礼拜没有碰过了 培训前3天我还在打游戏的时候重要的培训都已经讲过了555 后悔ing","categories":[],"tags":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/tags/SJTU/"}]},{"title":"Sophomore Fall Final","slug":"Final","date":"2019-01-11T07:26:48.000Z","updated":"2019-01-17T06:37:02.065Z","comments":true,"path":"2019/01/11/Final/","link":"","permalink":"https://ainevsia.github.io/2019/01/11/Final/","excerpt":"","text":"剩余的课程已经没有剩余的考试了感谢自己到最后都没有放弃我自己感谢自己又熬过了一个期末这真是我度过的最难受的一个期末了看这考试列表里的科目被一门一门地划掉原来最多只能有6级标题 随便写点吧看这考试列表里的科目被一门一门地划掉，现在一个人在寝室里安享这静谧的午后：熟悉的atom界面时隔一周又能够打开了，可以放心地在空调间里脱去棉袄而不用担心着凉感冒了，这个午后注定是我一生中独特的、无所顾虑的午后。 总结一下这次考试周从后往前吧，概统是我复习的最不充分的一门。理力考前一天凌晨3点梦中惊醒，发现自己浑身是汗，被子都出湿了，然后入睡困难，爬起来听歌，再睡，第二天战略性地睡懒觉。 我给自己的压力实在太大了，这也和我这学期平时确实没有好好学习有关。实力没有，靠前虚，还想考个好成绩。现在回想起来，真的是太难受了。 我宁愿回高中考垫底、也不想在大学面临挂科的压力而学习了。 整理一下接下来要做的事情一件事情的结束永远意味着另外一件事情的开始 考完试，专业的老师就立马开了专业介绍会 好让我们想清楚自己剩下的2.5年在交大的生活该怎么过 我对自己的未来感到摇摆不定了 我想出国，但是不一定想读博士，但是老师却说在国外最好待满5年，别2年就回来，会被别人瞧不起。 但是无论如何，无论工作、保研、出国选择哪一条路 学习永远是排在第一位的 永远记住 学习永远是排在第一位的 梳理一下接下来的工作 准备数学建模竞赛 扫题 写作业 实验室 看书 写读书报告 自己看算法 用java实现 看一看下学期专业课的内容，最好预习起来 预约姚医生 学期总结考试周结束的这个周末，我车也开了，王者荣耀也打过了，小说也熬夜看过了，漫画也看过了，斗地主也打了。 该放纵自己的事情差不多全干完了，该收收心好好学习了。 我时刻提醒着自己不要忘记了我迈入交大第一天时自己的心情。 那可能是我本科期间最充满自信的一段时光 走到哪儿都是挺直了腰杆的，高傲的男孩 如今他在哪儿？ 相信自己能够成为自己心中的那个人 你的目标在哪儿？ 你后悔你当初考入交大的决定吗？ 我永远都不会后悔","categories":[],"tags":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/tags/SJTU/"}]},{"title":"KMP Algorithm","slug":"Knuth-Morris-Pratt-Algorithm","date":"2018-11-30T05:44:39.000Z","updated":"2019-02-15T10:11:25.789Z","comments":true,"path":"2018/11/30/Knuth-Morris-Pratt-Algorithm/","link":"","permalink":"https://ainevsia.github.io/2018/11/30/Knuth-Morris-Pratt-Algorithm/","excerpt":"","text":"Introduction &amp;&amp; Core thoughtsCalculate the maximum shifting digits based on the characterics of the given patten string. How to calculate?Suppose we have a pattern string p[0:n] and the comparation failure happened when comparing s[i+j] with p[j] (when comparing s[i:i+n] with p[0:n]), that indicates that s[i:j-1] are already known and are equal to p[0:j-1]. So that suggests us to take a great heap as much as possible provided that Notice that when the failure happens at p[j], the digits before are already clearify and can tell whether the naive comparsion will succeed or not. VisualizationI think these two pictures can clearly illustrate the phenomenon: AcknowledgementsA lot of thanks to KMP算法详解 which let me understand this algorithm.","categories":[],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"https://ainevsia.github.io/tags/Algorithm/"}]},{"title":"scholarship","slug":"scholarship","date":"2018-11-14T08:07:10.000Z","updated":"2019-01-15T07:38:52.853Z","comments":true,"path":"2018/11/14/scholarship/","link":"","permalink":"https://ainevsia.github.io/2018/11/14/scholarship/","excerpt":"","text":"奖学金每当自己要填各种申请表格的时候，我总会发现自己一无是处。 两面性今天的铣工做的是还算不是很爆炸，但是晚上情绪就很低落，大物和概统的作业都做的很难受。 不敢相信他们了不想看着自己每况愈下，成绩渐渐开始走下坡路。 所以说我为什么不喜欢在qq上问别人问题我讨厌等别人回答我迫切需要解答的问题 想要自己弄明白一切的东西，想要知道这一切背后所隐藏的奥秘，想要从一开始就有一个好的基础。 所以上课好好听可以嘛？ 理论力学…没能做完…，一道典型的三联杆问题，第一下没反应过来就慌了，到最后才突然明白是三联杆。 计算确实有点太慢，但也没办法，这就是我啊…这就是考试呗。 媒体创意经济结束了很遗憾这学期并没有学到什么东西，最后的小组大作业我自己也是什么事情都没有干，就是把大家的论文全部拼起来，加一个头加一个尾。真的是抱到了大腿了。 在家靠父母，出门靠朋友。 朋友越多，遇到事情就不会感到害怕。这是你的人脉啊。 人脉资源将是你踏上社会之后最重要的资源 小组报告我也觉得没有怎么用心做 要是我自己根本就不敢上去讲.. 突然发现我已经好久没有码代码了向github上提交的内容全是划水的注释上马回来之后觉得自己又成长了一些 钳工交大学子都是能够给一张图纸就能够把整机装起来的人！","categories":[],"tags":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/tags/SJTU/"}]},{"title":"07-图5 Saving James Bond - Hard Version","slug":"DS-07-图5","date":"2018-10-17T13:43:08.000Z","updated":"2019-03-02T06:44:01.843Z","comments":true,"path":"2018/10/17/DS-07-图5/","link":"","permalink":"https://ainevsia.github.io/2018/10/17/DS-07-图5/","excerpt":"","text":"LinksHere ThoughtsHow to use the function qsort() parameters: qsort(void * array, int numberofcells, int sizeofeachcell, function cmp) function cmp: cmp(const void * a, const void * b) &#123;12 return ((*pointer* to the type of the elements waiting to be sorted)a)-&gt;some attribute of the element - ...b;&#125; It is certainly a great habbit to write comments while writing the codesTalk is cheap, show me your Codes123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103#include &lt;iostream&gt;#include &lt;cmath&gt;#include &lt;cstdlib&gt;#define max 102const int radius = 50;int maxtime = max;struct node &#123; //crocodile -- node int x, y; //position label x and y bool flag; //true if the crocodile is close enough to the beach node * precedent; //pointer to the previous crocodile double distance; //distance to the previous crocodile int nodetime; //attribute that trace the distance from island&#125;;struct Stack &#123; //stack to implement the closest way node * stack[max * 2]; int sp; node * Pop()&#123;return stack[sp--];&#125; void Push(node * ptr)&#123;stack[++sp] = ptr;&#125;&#125;;node croco[max]; //all the crocodiles are kept in this arrayStack priostack; //priority stacknode * FinalNode = NULL;//keep the exitusing namespace std;double getdis(int x1, int y1, int x2, int y2);void dfs(node * ptr, int n, int d, node * pre, int times);int cmp(const void * a, const void * b);int main(int argc, char const *argv[]) &#123; freopen(\"../test.txt\", \"r\", stdin); int n, d;cin &gt;&gt; n &gt;&gt; d; priostack.sp = -1; for (int i = 0; i &lt; n; ++i) &#123; //inialization cin &gt;&gt; croco[i].x &gt;&gt; croco[i].y; croco[i].flag = radius - abs(croco[i].x) &lt;= d || radius - abs(croco[i].y) &lt;= d; croco[i].precedent = NULL; croco[i].distance = 0; croco[i].nodetime = max; &#125; //first iteration for (int i = 0; i &lt; n; ++i) &#123; if (getdis(0,0,croco[i].x,croco[i].y)&lt;=7.5+d) &#123; croco[i].distance = getdis(0,0,croco[i].x,croco[i].y); priostack.Push(&amp;croco[i]); &#125; &#125; if (priostack.sp+1 &gt; 1) qsort(&amp;priostack.stack[0], priostack.sp+1, sizeof(node*), cmp); int cnt = 0, num = priostack.sp + 1; while (cnt++ &lt; num) dfs(priostack.Pop(),n,d,NULL,1); //out put section if (maxtime == max) cout &lt;&lt; 0; else if (d &gt;= 43) cout &lt;&lt; 1; else &#123; int outputcnt = 0; while (FinalNode) &#123; outputcnt++; priostack.Push(FinalNode); FinalNode = FinalNode-&gt;precedent; &#125; cout &lt;&lt; outputcnt + 1 &lt;&lt; endl; while (outputcnt--) &#123; FinalNode = priostack.Pop(); cout &lt;&lt; FinalNode-&gt;x &lt;&lt; ' ' &lt;&lt; FinalNode-&gt;y &lt;&lt; endl; &#125; &#125; return 0;&#125;void dfs(node * ptr, int n, int d, node * pre, int times) &#123; ptr-&gt;precedent = pre; if (ptr-&gt;flag &amp;&amp; times &lt; maxtime) &#123; maxtime = times; FinalNode = ptr; &#125; ptr-&gt;nodetime = times; int bp = priostack.sp; for (int i = 0; i &lt; n; ++i) &#123; if (croco[i].nodetime&gt;times+1 &amp;&amp; getdis(ptr-&gt;x,ptr-&gt;y,croco[i].x,croco[i].y)&lt;=d) &#123; croco[i].distance = getdis(0,0,croco[i].x,croco[i].y); priostack.Push(&amp;croco[i]); &#125; &#125; int num = priostack.sp - bp; if (num &gt; 1) qsort(&amp;priostack.stack[bp+1], (size_t)priostack.sp-bp, sizeof(node*), cmp); int cnt = 0; while (cnt++ &lt; num) dfs(priostack.Pop(),n,d,ptr,times+1);&#125;int cmp(const void * a, const void * b) &#123; double d = (*((node**)b))-&gt;distance - (*((node**)a))-&gt;distance; return d &gt; 0 ? 1 : -1;&#125;double getdis(int x1, int y1, int x2, int y2) &#123; double ret = sqrt((x1-x2)*(x1-x2) + (y1-y2)*(y1-y2)); return ret;&#125;","categories":[{"name":"数据结构与算法","slug":"数据结构与算法","permalink":"https://ainevsia.github.io/categories/数据结构与算法/"}],"tags":[{"name":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","slug":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","permalink":"https://ainevsia.github.io/tags/中国大学MOOC-陈越、何钦铭-数据结构-2018秋/"}]},{"title":"A Woman decays like this","slug":"Woman-translate","date":"2018-10-12T10:10:46.000Z","updated":"2019-03-02T06:45:56.403Z","comments":true,"path":"2018/10/12/Woman-translate/","link":"","permalink":"https://ainevsia.github.io/2018/10/12/Woman-translate/","excerpt":"","text":"一个女人是这样衰老的1When I was twenty, walked around the campus in a vested denim skirt, my face flushed as my mouth open. Now I am thirty, sitting in my office and scolding my subordinates, crulty written on my face, “How can you dare to ask such a silly question before even making a draft?” 二十岁的时候，我穿着一条背心式牛仔裙在校园里走来走去，一说话就脸红。 三十岁的我穿着名牌套装，坐在办公桌前，满脸冷酷地对下属说：“这么愚蠢的问题你也敢问？也不先打个草稿。” 2When I was twenty, the books borrowed from the library were The Complete Works of Shakespeare, Self-portrait of a young artist and Ulysses. Now I am in my thirties, on the bedside table lays The scrects of following the banker, ELLE and A manager’s personal charm. 二十岁的时候，从图书馆借的是《莎士比亚全集》、《一个青年艺术家的自画像》和《尤里西斯》。 三十岁之后，床头摆的是《跟庄密笈》、《ELLE》和《经理人的个人魅力》. 3In the summer of my twenty, met the boy I crushed who was said to be admitted to a graduate school. Dismayed by the progress he had made, my heart torn with grief and my tears droped as it occured to me that it was beyond my whole life to become elegent enough so that he could gave me a glance. After thirty, searching everywhere for a bought MBA. 二十岁的暑假，在家乡的大街上偶遇自己的暗恋对象，听说他考上了研究生，被他的进步所打击，心如刀绞，想到这辈子终于不能出色得让他看我一眼，不禁怅然泪下。 三十岁之后，到处打听那里可以花钱买个MBA. 4In my twenty, indicating my age from time to time, even before they asked. After thirty, find it an odious thing when asked about age. If you do, “have a guess”. 二十岁的时候，随时随地向人透露我的年龄，答得比问的还快。 三十岁之后，最恨别人问年龄，你要是非问不可，你猜啊。 5In my twenty, overwhelmed with the idea to date with boys majoring in sports or arts. After thirty, regard myself then as an idiot. 二十岁的时候，一心想和体育系、美术系的男生约会。 三十岁后，我简直认为自己当年是白痴。 6In my twenty, saw a bookstore and went in, have books there and bought. After thirty, turn a blind eye to bookstores and directly went into the Beauty Salon next door. 二十岁的时候，有书店必须逛，有书必买。 三十岁之后，对书店视而不见，直接去了隔壁的美容院。 7In my twenty, bet on myself that I wasn’t as outdated as defending this place till dead. Live elsewhere. After thirty, run out of my legs for a house in this city that I satisfied and can afford. 二十岁的时候，打赌说我这辈子不可能土到死守在一个地方，生活在别处嘛。 三十岁之后，我为了在这座城市买个满意又便宜的房子跑断了双腿. 8In my twenty, went to a movie with someone at night. Hand in hand without conscious which made me happy for a whole summer. After thirty, sitting in the revolving restaurant of Shangri-La Hotel to accompany clients and eat self help meals. As the restaurant rotates slowly, I feels an unknow inanity and suddenly grows boring toward the whole world. 二十岁的时候，和某个人晚上一起去看了场电影，不经意中拉了一次手，结果幸福了整整一个夏天。 三十岁之后，坐在香格里拉酒店的旋转餐厅陪客户吃自主助餐，在缓缓的转动之中，莫名其妙地一阵空虚，突然间对一切感到索然无味 Acknowledgement 周可, my handsome roommate who inspired me to translate this passage that moved me so much.","categories":[{"name":"translation","slug":"translation","permalink":"https://ainevsia.github.io/categories/translation/"}],"tags":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/tags/SJTU/"}]},{"title":"7-11 关键活动","slug":"DS-7-11","date":"2018-09-19T09:18:49.000Z","updated":"2019-01-15T07:48:06.617Z","comments":true,"path":"2018/09/19/DS-7-11/","link":"","permalink":"https://ainevsia.github.io/2018/09/19/DS-7-11/","excerpt":"","text":"进展 题目是什么意思啊？我一开始以为是最小生成树，后来觉得是dijkstra,现在我已经弄不清楚了。 有向图 需要判断是不是有回路 好吧，似乎是拓扑排序…. 预备知识 AOV网络(Activity on Vertex) Top拓扑序:若v-&gt;w 则v先输出 拓扑排序：AOV若有合理的拓扑序(无环)，则必定是有向无环图(DAG, Directed Acyclic Graph) 关键路径问题：AOE网络(Activity on Edge) 题目描述原题在这 思路难点体会与感想 好累啊，好想哭啊 刷OJ最难受的事情就是要求太多的输出格式 一道题卡了两天的感受实在是太难受了 学习的过程绝对的连续的 一旦你停止在一件事情上花时间，他马上就会给你颜色看关键代码 7-11.cpp","categories":[{"name":"数据结构与算法题目集（中文）","slug":"数据结构与算法题目集（中文）","permalink":"https://ainevsia.github.io/categories/数据结构与算法题目集（中文）/"}],"tags":[{"name":"最小生成树","slug":"最小生成树","permalink":"https://ainevsia.github.io/tags/最小生成树/"}]},{"title":"02-线性结构1 两个有序链表序列的合并","slug":"DS-02-线性结构1","date":"2018-09-14T11:33:58.000Z","updated":"2019-03-02T06:44:23.276Z","comments":true,"path":"2018/09/14/DS-02-线性结构1/","link":"","permalink":"https://ainevsia.github.io/2018/09/14/DS-02-线性结构1/","excerpt":"","text":"感想 写程序题实在是太麻烦了 好久没用malloc了，连头指针和头结点都分不清楚了。 使用头结点可以很方便地解决很多的问题 源代码123456789101112131415161718192021222324252627282930List Merge( List L1, List L2 )&#123; List head = (List)malloc(sizeof(struct Node)); PtrToNode current = head; PtrToNode ptr1 = L1-&gt;Next; PtrToNode ptr2 = L2-&gt;Next; while (1) &#123; if (!ptr1) &#123; current-&gt;Next = ptr2; break; &#125; if (!ptr2) &#123; current-&gt;Next = ptr1; break; &#125; if (ptr1-&gt;Data &lt; ptr2-&gt;Data) &#123; current-&gt;Next = ptr1; current = ptr1; ptr1 = ptr1-&gt;Next; &#125;else&#123; current-&gt;Next = ptr2; current = ptr2; ptr2 = ptr2-&gt;Next; &#125; &#125; L1-&gt;Next = NULL; L2-&gt;Next = NULL; return head;&#125; 顺便把二分查找的代码也贴上来12345678910111213Position BinarySearch( List L, ElementType X )&#123; int start = 1, end = L-&gt;Last, mid; while (start&lt;=end) &#123; mid = (start + end) / 2; if (L-&gt;Data[mid]&lt;X) &#123; start = mid + 1; &#125;else if (L-&gt;Data[mid]&gt;X) &#123; end = mid - 1; &#125;else if (L-&gt;Data[mid]==X) return mid; &#125; return NotFound;&#125;","categories":[{"name":"数据结构与算法","slug":"数据结构与算法","permalink":"https://ainevsia.github.io/categories/数据结构与算法/"}],"tags":[{"name":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","slug":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","permalink":"https://ainevsia.github.io/tags/中国大学MOOC-陈越、何钦铭-数据结构-2018秋/"}]},{"title":"03-树2 List Leaves","slug":"DS-03-树2","date":"2018-09-14T08:57:28.000Z","updated":"2019-03-02T06:43:26.831Z","comments":true,"path":"2018/09/14/DS-03-树2/","link":"","permalink":"https://ainevsia.github.io/2018/09/14/DS-03-树2/","excerpt":"","text":"thoughts 重要的细节，也是全部写完之后发现的唯一一个错误：char的数字向int装换的时候要-‘0’； 实现细节，就是给每一个节点一个完全二叉树时的序号，然后sort qsort的具体使用细节 参数表：qsort(void *, num, sizeof(), cmp) cmp的参数：int cmp(const void front, const void rear)，不可以自己改 return的参数：返回正数就是说 cmp 传入参数第一个要放在第二个后面, 负数就是传入参数第一个要放第二个前面, 如果是 0, 那就无所谓谁前谁后. ‘’+’’ 需要swap ‘’-‘’ 不要交换 int cmp(const void small, const void big) return small - big 从小到大 codes123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293#include &lt;iostream&gt;#include &lt;cstdlib&gt;using namespace std;struct node &#123; int data; bool leaf; unsigned int pos; char left; char right;&#125;;int readtree(node * tree, int n, int * num);void attachweight(node * tree, int ptr, int weight);void printleaf(node * tree, int n);int cmp(const void * front, const void * rear);int main(int argc, char const *argv[]) &#123; freopen(\"D:\\\\SJTU\\\\Freshman Summer\\\\DS\\\\test.txt\", \"r\", stdin); int n;cin &gt;&gt; n; node * tree = new node [n]; int leafnum = 0; int head = readtree(tree,n,&amp;leafnum); //cout &lt;&lt; head; attachweight(tree,head,1); //cout &lt;&lt; \"attach done\"; qsort(tree,n,sizeof(node),cmp); //cout &lt;&lt; \"sorted\"; printleaf(tree,leafnum); delete [] tree; return 0;&#125;void printleaf(node * tree, int n) &#123; int cnt = 0; for (int i = 0; true; i++) &#123; if (tree[i].leaf) &#123; cout &lt;&lt; tree[i].data; ++cnt; if (cnt!=n) &#123; cout &lt;&lt; ' '; &#125;else return; &#125; &#125;&#125;int cmp(const void * front, const void * rear) &#123; int ret = ((node*)front)-&gt;pos - ((node*)rear)-&gt;pos; return ret;&#125;void attachweight(node * tree, int ptr, int weight) &#123; tree[ptr].pos = weight; if (tree[ptr].left!='-') &#123; attachweight(tree,tree[ptr].left-'0',2*weight); &#125; if (tree[ptr].right!='-') &#123; attachweight(tree,tree[ptr].right-'0',2*weight+1); &#125;&#125;int readtree(node * tree, int n, int * num) &#123; bool * ishead = new bool [n]; for (int i = 0; i &lt; n; i++) &#123; ishead[i] = true; &#125; for (int i = 0; i &lt; n; i++) &#123; tree[i].data = i; tree[i].leaf = true; cin &gt;&gt; tree[i].left &gt;&gt; tree[i].right; if (tree[i].left!='-') &#123; tree[i].leaf = false; ishead[tree[i].left-'0'] = false; &#125; if (tree[i].right!='-') &#123; tree[i].leaf = false; ishead[tree[i].right-'0'] = false; &#125; if (tree[i].leaf) &#123; (*num)++; &#125; &#125; int head = 0; for (int i = 0; i &lt; n; i++) &#123; if (ishead[i]==true) &#123; head = i; break; &#125; &#125; delete [] ishead; return head;&#125;","categories":[{"name":"数据结构与算法","slug":"数据结构与算法","permalink":"https://ainevsia.github.io/categories/数据结构与算法/"}],"tags":[{"name":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","slug":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","permalink":"https://ainevsia.github.io/tags/中国大学MOOC-陈越、何钦铭-数据结构-2018秋/"}]},{"title":"02-线性结构4 Pop Sequence","slug":"DS-02-线性结构4","date":"2018-09-14T04:11:54.000Z","updated":"2019-03-02T06:43:50.474Z","comments":true,"path":"2018/09/14/DS-02-线性结构4/","link":"","permalink":"https://ainevsia.github.io/2018/09/14/DS-02-线性结构4/","excerpt":"","text":"thoughts too simple: just stack simulation 这一次真的是爽啊，一次性过，代码简洁没有任何冗余的边界调试 这样的题目是可遇而不可求啊！ 我用树和用图也要达到我用堆的这样的境界！ codes12345678910111213141516171819202122232425262728293031323334#include &lt;iostream&gt;using namespace std;bool check(int m, int n);int main(int argc, char const *argv[]) &#123; int m, n, k;cin &gt;&gt; m &gt;&gt; n &gt;&gt; k; for (int i = 0; i &lt; k; i++) &#123; bool valid = check(m,n); if (valid) cout &lt;&lt; \"YES\" &lt;&lt; endl; else cout &lt;&lt; \"NO\" &lt;&lt; endl; &#125; return 0;&#125;bool check(int m, int n) &#123; int * stack = new int [n], stk = -1; int * store = new int [n], str = 0; for (int i = 0; i &lt; n; i++) &#123; cin &gt;&gt; store[i]; &#125; bool valid = false; for (int topush = 1; topush &lt;= n; topush++) &#123; stack[++stk] = topush; if (stk==m) break; while (stk!=-1 &amp;&amp; store[str]==stack[stk]) &#123; stk--;str++; &#125; &#125; if (stk==-1) valid = true; delete [] stack; return valid;&#125;","categories":[{"name":"数据结构与算法","slug":"数据结构与算法","permalink":"https://ainevsia.github.io/categories/数据结构与算法/"}],"tags":[{"name":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","slug":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","permalink":"https://ainevsia.github.io/tags/中国大学MOOC-陈越、何钦铭-数据结构-2018秋/"}]},{"title":"02-线性结构3 Reversing Linked List","slug":"DS-02-线性结构3","date":"2018-09-12T06:03:19.000Z","updated":"2019-03-02T06:44:12.829Z","comments":true,"path":"2018/09/12/DS-02-线性结构3/","link":"","permalink":"https://ainevsia.github.io/2018/09/12/DS-02-线性结构3/","excerpt":"","text":"进展 时间 进展 2018年9月12日中午 到目前为止还有两个测试点没过一个是全部反转，我测试的时候是对的呀；还有一个是超时 2018年9月13日21:02:58 AC 难点 容易想到一些歪门邪道，比如说我第一次想到的排序方法。 模拟内存的想法。 具体进行逆转的时候的操作 反思 做OJ的题目有一些注意事项是你不得不放在心上的 边界条件 代码1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980#include &lt;iostream&gt;#include &lt;iomanip&gt;#define max 100005using namespace std;struct node &#123; int ads; int data; int next;&#125;;node memory[max];int getlength(node * head);node * reverse(node * head, int k);void print(node * head, int length);int main(int argc, char const *argv[]) &#123; freopen(\"D:\\\\SJTU\\\\Freshman Summer\\\\DS\\\\test.txt\", \"r\", stdin); int ads, n, k;cin &gt;&gt; ads &gt;&gt; n &gt;&gt; k; int address, data, next; for (int i = 0; i &lt; n; i++) &#123; cin &gt;&gt; address &gt;&gt; data &gt;&gt; next; memory[address].ads = address; memory[address].data = data; memory[address].next = next; &#125; node head, *headptr; head.next = ads; headptr = &amp;head; int length = getlength(headptr); for (size_t i = k; i &lt;= length; i+=k) &#123; int front = headptr-&gt;next; headptr-&gt;next = reverse(headptr,k)-&gt;ads; headptr = &amp;memory[front]; //print(&amp;head,length);cout &lt;&lt; endl; &#125; headptr = &amp;head; print(headptr,length); return 0;&#125;node * reverse(node * head, int k) &#123; node * front = &amp;memory[head-&gt;next]; node * rear = &amp;memory[front-&gt;next]; node * temp; int cnt = 1; while (cnt&lt;k) &#123; temp = &amp;memory[rear-&gt;next]; rear-&gt;next = front-&gt;ads; front = rear; rear = temp; cnt++; &#125; memory[head-&gt;next].next = rear-&gt;ads; return front;&#125;int getlength(node * head) &#123; int cnt = 0, adds = head-&gt;next; while (adds!=-1) &#123; cnt++; adds = memory[adds].next; &#125; return cnt;&#125;void print(node * head, int length) &#123; node * ptr = &amp;memory[head-&gt;next]; for (size_t i = 0; i &lt; length; i++) &#123; cout &lt;&lt; setw(5) &lt;&lt; setfill('0') &lt;&lt; ptr-&gt;ads; cout &lt;&lt; ' ' &lt;&lt; ptr-&gt;data &lt;&lt; ' '; if ( i==length-1 ) cout &lt;&lt; \"-1\"; else cout &lt;&lt; setw(5) &lt;&lt; setfill('0') &lt;&lt; ptr-&gt;next &lt;&lt; endl; ptr = &amp;memory[ptr-&gt;next]; &#125;&#125;","categories":[{"name":"数据结构与算法","slug":"数据结构与算法","permalink":"https://ainevsia.github.io/categories/数据结构与算法/"}],"tags":[{"name":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","slug":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","permalink":"https://ainevsia.github.io/tags/中国大学MOOC-陈越、何钦铭-数据结构-2018秋/"}]},{"title":"01-复杂度2 Maximum Subsequence Sum","slug":"DS-01-复杂度2","date":"2018-09-12T06:03:19.000Z","updated":"2019-03-02T06:43:03.271Z","comments":true,"path":"2018/09/12/DS-01-复杂度2/","link":"","permalink":"https://ainevsia.github.io/2018/09/12/DS-01-复杂度2/","excerpt":"","text":"主要做的几个改动 引入track变量来控制ij的记录时间点 修补了maxsum=0的一个小bug 反思 好好看清楚题目再做很重要，不要觉得自己做过一遍就有多懂了，还不是花了2h多吗，看看清楚要输出序号还是要输出值。","categories":[{"name":"数据结构与算法","slug":"数据结构与算法","permalink":"https://ainevsia.github.io/categories/数据结构与算法/"}],"tags":[{"name":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","slug":"中国大学MOOC-陈越、何钦铭-数据结构-2018秋","permalink":"https://ainevsia.github.io/tags/中国大学MOOC-陈越、何钦铭-数据结构-2018秋/"}]},{"title":"7-10 公路村村通","slug":"DS-7-10","date":"2018-08-24T11:53:23.004Z","updated":"2019-02-15T07:08:13.247Z","comments":true,"path":"2018/08/24/DS-7-10/","link":"","permalink":"https://ainevsia.github.io/2018/08/24/DS-7-10/","excerpt":"","text":"预备知识 最小生成树(Minimum Spanning Tree) 是一棵树 是由原图生成的 包含图内的所有的顶点 所有的边都是图中的边 权最小 图连通 等价 存在最小生成树 贪心算法 每一步都要眼前最好的 约束条件 Prim算法-让小数长大 算法复杂度 平方级别 稠密图 Kruskal算法-将森林合并成树 算法复杂度 ElogE 稀疏图 需要储备的数据结构：集合、并查集、最小堆 集合存储实现： 树结构：双亲表示法 孩子指向父节点 数组： 根节点为-1 堆是用数组实现的完全二叉树题目描述(更新)原题在这 思路Prim算法，日后再实现Kruskal算法 难点Prim算法的实现 体会与感想 Prim算法简直了，和Dijkstra算法一模一样 好tm烦啊 关键代码 7-10-Prim.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748int Prim(int ** G, int n) &#123; bool * collected = new bool [n]; int * dist = new int [n], mincost = 0; for (int i = 0; i &lt; n; i++) &#123; collected[i] = false; dist[i] = inf; &#125; collected[0] = true; dist[0] = 0; for (int i = 1; i &lt; n; i++) &#123; if (G[0][i]&lt;dist[i]) &#123; dist[i] = G[0][i]; &#125; &#125; while (true) &#123; bool found = false; int min = inf, v = 0; for (int i = 1; i &lt; n; i++) &#123; if (!collected[i] &amp;&amp; dist[i]&lt;min) &#123; found = true; min = dist[i]; v = i; &#125; &#125; if (!found) &#123; break; &#125; mincost += min; collected[v] = true; dist[v] = 0; // for every node w linking to the node v for (int w = 0; w &lt; n; w++) &#123; if (G[v][w]!=inf &amp;&amp; !collected[w]) &#123; if (G[v][w] &lt; dist[w]) &#123; dist[w] = G[v][w]; &#125; &#125; &#125; &#125; for (int i = 0; i &lt; n; i++) &#123; if (collected[i]==false) &#123; return -1; &#125; &#125; return mincost;&#125;","categories":[{"name":"数据结构与算法题目集（中文）","slug":"数据结构与算法题目集（中文）","permalink":"https://ainevsia.github.io/categories/数据结构与算法题目集（中文）/"}],"tags":[{"name":"数据结构与算法题目集（中文）","slug":"数据结构与算法题目集（中文）","permalink":"https://ainevsia.github.io/tags/数据结构与算法题目集（中文）/"}]},{"title":"军训日记","slug":"MilitaryTrainning","date":"2018-08-23T13:32:45.000Z","updated":"2018-09-03T08:45:22.586Z","comments":true,"path":"2018/08/23/MilitaryTrainning/","link":"","permalink":"https://ainevsia.github.io/2018/08/23/MilitaryTrainning/","excerpt":"","text":"8月23日8月24日今天上午的训练结束之前连长组织了会操，我觉得自己的口令下的没什么毛病，同学们做的也都很好，可是没有被表扬。可能是走的时候排面还是没有标齐。 8月26日昨天晚上忘记知米背单词的打卡了，今天早上才发现，心里好难受。 今天上午还是下雨，我们班的进度我感觉已经十分落后了。大家正步走的时候分解动作都不稳。 下午教唱歌：打靶归来、有我在、军中绿花。 下午主攻正步走和跑步走的连贯练习。 先是正步走的臂腿结合一步两动的练习 8月27日哈哈哈昨晚拉练。 很开心，现在只记得前面的连是3连，后面的连是八连，走到凯旋门之前我们一直在疯狂拉歌。拍完照之后前后连队距离都比较大，也就没有再拉歌了。 记一下一件我认为是宝贵教训的一次经历：过了凯旋门的那一个加油点我居然怂恿梁力佳去女生手里拿了一瓶农夫山泉orz。然后他不要我就背自己包里了。我本来带的两瓶水明明正正好好，结果后半程我就在疯狂喝水，结果到最后还没喝完。 你要的东西会成为你的负担。 想清楚你要什么。 8月29日昨天晚上和7连联谊，玩到熄灯了才猛然惊醒，收拾收拾回宿舍了。 我总是觉得我准备的还不够充分，觉得自己没有买水果，买的士力架发现是辣花生味的。 说实话，联谊，有点累的。 今天下午我原来带的班被拆掉了，负责新的一列，是方阵的队形。 然后下午练跑步走的时候再一次被当场活捉。orz捉奸现场 今天不开连务会，早点休息。好想王宏武…… 8月30日今天一整天都是练方阵，orz，先送上一首分列式进行曲，此乃洗脑神曲也。 然后结束的时候我们营长来验收，我们好像把自己走的最差的一次展现给了营长看…. 从（1，4）的位置调到了（9,1）的位置，很舒服，能直接看到标兵，就是标齐感觉有些困难。 连着两天内务满分，嘤嘤嘤，我们好强。 加油，所有的一切终将消失，好好珍惜剩下的仅剩4天的训练时间吧！ 8月31日今天还是在练无聊的方阵。中途被连长T出去休息了好一会，最后又被连长调上第一列了orz 求无聊的日子快点结束吧！ 9月1日今天早上醒来发现手机开不了，悲剧。昨天夜间不就是设置了一个夜间更新然后今早起来就爆掉了。 上午去胡法光体育场练了三遍，踢的乱七八糟、一塌糊涂。 在等手机开了之后去取周可的杯子。 9月3日军训明天就结束了，看了一遍《悟空》，真的很难说再见。 王宏武说这会是一个难忘的军训，确实，真的很难忘。 我该怎样去告别这一段岁月。 这一敬，你我命运相交。 别人穿上军装就是这么好看，而为什么穿在自己的身上却觉得没那么好看了呢？ 昨晚的军训晚会坐在了很偏的位置，只能听到下面女生的尖叫声，和舞台上不停变幻着的刺眼灯光。","categories":[{"name":"军训","slug":"军训","permalink":"https://ainevsia.github.io/categories/军训/"}],"tags":[{"name":"SJTU","slug":"SJTU","permalink":"https://ainevsia.github.io/tags/SJTU/"}]},{"title":"7-9 旅游规划","slug":"DS-7-9","date":"2018-08-17T11:01:28.000Z","updated":"2018-08-17T12:37:14.995Z","comments":true,"path":"2018/08/17/DS-7-9/","link":"","permalink":"https://ainevsia.github.io/2018/08/17/DS-7-9/","excerpt":"","text":"预备知识 Floyd算法：复杂度 V^3 重要前提：一步一步向后推的 三重循环，每次从DK 归纳推理到 DK+1 其中DK是只经过编号为i（i&lt;K）时各个点对间的最短路 Dijkstra算法: 复杂度最高 V^2+E 这就是运行超时和答案正确之间的区别 题目描述原题在这 思路原先想着用Floyd算法去做的，写完发现有一个测试点运行超时了，无奈只好回到了Dijkstra算法，思路基本一致，唯一的不同点就是图换成了邻接矩阵表示，同时还多了一个fee的权需要检测。 难点不能用Floyd，本题实质是单源有权图的最短路问题（从s到d）。 体会与感想 stray ‘\\357’ in program```出现此类错误的原因，在编辑器中使用的utf-8的格式保存源代码中出现了中文的标点符号。12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485# 关键代码&gt;7-9-Floyd.cpp```C++#include &lt;iostream&gt;#define inf 10000using namespace std;int ** readGraph(int n, int m, int *** cost);void deleteGraph(int ** G, int n, int ** cost);void Floyd(int ** G, int n, int ** cost);int main(int argc, char const *argv[]) &#123; freopen(&quot;D:\\\\SJTU\\\\Freshman Summer\\\\DS\\\\test.txt&quot;, &quot;r&quot;, stdin); int n, m, s, d, ** cost = NULL; cin &gt;&gt; n &gt;&gt; m &gt;&gt; s &gt;&gt; d; int ** G = readGraph(n,m,&amp;cost); Floyd(G,n,cost); int length = G[s][d]; int fee = cost[s][d]; cout &lt;&lt; length &lt;&lt; &apos; &apos; &lt;&lt; fee; deleteGraph(G,n,cost); return 0;&#125;void Floyd(int ** G, int n, int ** cost) &#123; for (int k = 0; k &lt; n; k++) &#123; for (int i = 0; i &lt; n; i++) &#123; for (int j = 0; j &lt; n; j++) &#123; if (G[i][j] &gt; G[i][k]+G[k][j]) &#123; G[i][j] = G[i][k] + G[k][j]; cost[i][j] = cost[i][k] + cost[k][j]; &#125; else if (G[i][j] == G[i][k]+G[k][j]) &#123; if (cost[i][j] &gt; cost[i][k] + cost[k][j]) &#123; cost[i][j] = cost[i][k] + cost[k][j]; &#125; &#125; &#125; &#125; &#125;&#125;void deleteGraph(int ** G, int n, int ** cost) &#123; for (int i = 0; i &lt; n; i++) &#123; delete [] G[i]; delete [] cost[i]; &#125; delete [] G; delete [] cost;&#125;int ** readGraph(int n, int m, int *** cost) &#123; int ** G = new int* [n]; *cost = new int* [n]; for (int i = 0; i &lt; n; i++) &#123; G[i] = new int [n]; (*cost)[i] = new int [n]; &#125; for (int i = 0; i &lt; n; i++) &#123; G[i][i] = 0; (*cost)[i][i] = 0; &#125; for (int i = 1; i &lt; n; i++) &#123; for (int j = 0; j &lt; i; j++) &#123; G[i][j] = inf; G[j][i] = inf; (*cost)[i][j] = inf; (*cost)[j][i] = inf; &#125; &#125; int city1, city2, length, fee; for (int i = 0; i &lt; m; i++) &#123; cin &gt;&gt; city1 &gt;&gt; city2 &gt;&gt; length &gt;&gt; fee; G[city1][city2] = length; G[city2][city1] = length; (*cost)[city1][city2] = fee; (*cost)[city2][city1] = fee; &#125; return G;&#125; 7-9-Dijkstra.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115#include &lt;iostream&gt;#define inf 10000using namespace std;int ** readGraph(int n, int m, int *** cost);void deleteGraph(int ** G, int n, int ** cost);int Dijkstra(int** G,int n,int s,int d,int** cost,int *spend);int main(int argc, char const *argv[]) &#123; freopen(\"D:\\\\SJTU\\\\Freshman Summer\\\\DS\\\\test.txt\", \"r\", stdin); int n, m, s, d, ** cost = NULL, fee; cin &gt;&gt; n &gt;&gt; m &gt;&gt; s &gt;&gt; d; int ** G = readGraph(n,m,&amp;cost); int length = Dijkstra(G,n,s,d,cost,&amp;fee); cout &lt;&lt; length &lt;&lt; ' ' &lt;&lt; fee; deleteGraph(G,n,cost); return 0;&#125;int Dijkstra(int** G,int n,int s,int d,int** cost,int *spend)&#123; int * dist = new int [n]; int * fee = new int [n]; bool * collected = new bool [n]; for (int i = 0; i &lt; n; i++) &#123; dist[i] = inf; fee[i] = inf; collected[i] = false; &#125; dist[s] = 0; collected[s] = true; for (int i = 0; i &lt; n; i++) &#123; if(!collected[i] &amp;&amp; G[s][i]!=inf) &#123; dist[i] = G[s][i]; fee[i] = cost[s][i]; &#125; &#125; int v = -1; while (true) &#123; int min = inf; v = -1; for (int i = 0; i &lt; n; i++) &#123; if (!collected[i] &amp;&amp; dist[i]!=-1 &amp;&amp; dist[i]&lt;min) &#123; min = dist[i]; v = i; &#125; &#125; if (v==d || v==-1) break; collected[v] = true; for (int w = 0; w &lt; n; w++) &#123; if(!collected[w] &amp;&amp; G[v][w]!=inf) &#123; if (dist[v]+G[v][w]&lt;dist[w]) &#123; dist[w] = dist[v] + G[v][w]; fee[w] = fee[v] + cost[v][w]; &#125;else if (dist[v]+G[v][w]==dist[w]) &#123; if (fee[w] &gt; fee[v] + cost[v][w]) &#123; fee[w] = fee[v] + cost[v][w]; &#125; &#125; &#125; &#125; &#125; int ret = dist[v]; *spend = fee[v]; delete [] dist; delete [] fee; delete [] collected; return ret;&#125;void deleteGraph(int ** G, int n, int ** cost) &#123; for (int i = 0; i &lt; n; i++) &#123; delete [] G[i]; delete [] cost[i]; &#125; delete [] G; delete [] cost;&#125;int ** readGraph(int n, int m, int *** cost) &#123; int ** G = new int* [n]; *cost = new int* [n]; for (int i = 0; i &lt; n; i++) &#123; G[i] = new int [n]; (*cost)[i] = new int [n]; &#125; for (int i = 0; i &lt; n; i++) &#123; G[i][i] = 0; (*cost)[i][i] = 0; &#125; for (int i = 1; i &lt; n; i++) &#123; for (int j = 0; j &lt; i; j++) &#123; G[i][j] = inf; G[j][i] = inf; (*cost)[i][j] = inf; (*cost)[j][i] = inf; &#125; &#125; int city1, city2, length, fee; for (int i = 0; i &lt; m; i++) &#123; cin &gt;&gt; city1 &gt;&gt; city2 &gt;&gt; length &gt;&gt; fee; G[city1][city2] = length; G[city2][city1] = length; (*cost)[city1][city2] = fee; (*cost)[city2][city1] = fee; &#125; return G;&#125;","categories":[{"name":"数据结构与算法题目集（中文）","slug":"数据结构与算法题目集（中文）","permalink":"https://ainevsia.github.io/categories/数据结构与算法题目集（中文）/"}],"tags":[{"name":"数据结构与算法题目集（中文）","slug":"数据结构与算法题目集（中文）","permalink":"https://ainevsia.github.io/tags/数据结构与算法题目集（中文）/"}]},{"title":"7-8 哈利·波特的考试","slug":"DS-7-8","date":"2018-08-17T04:46:16.000Z","updated":"2019-02-15T10:11:55.641Z","comments":true,"path":"2018/08/17/DS-7-8/","link":"","permalink":"https://ainevsia.github.io/2018/08/17/DS-7-8/","excerpt":"","text":"预备知识 最短路径问题的分类： 单源最短路：从固定的源点出发求其到所有其他顶点的最短路径 无权图 BFS算法 有权图 Dijkstra 多源最短路 无权图的单源最短路算法：BFS算法 按照递增的顺序找出找出源点到各个顶点的最短路 算法要点：需要两个数组dist和path分别记录最短距离和上一个顶点 有权图的单源最短路算法：Dijkstra算法 分为已经确定最短路的集合S以及一个长度数组dist 实现原理：若路径是按照递增顺序生成的，则： 下一个加入S的点必定只经过S内的点（不然不是S内的点应该比当前点先加入S） 每次选一个dist最小的加入S（贪心算法） 加入点后会影响dist，影响的都是加入点的邻接点 算法实现要点： 需要dist、path和collected数组分别记录最短距离、上一个节点以及是否被收入S的信息 初始化条件：dist都为无穷大，path都没有，collect全不是 123dist[i] = inf;path[i] = -1;collected[i] = false; 修改源点的数据，进入Dijkstra函数 题目描述原题在这给定一张有权图，判断是否连通，若连通，则求使从一个顶点出发最长的最短路最短的那个节点。 思路Dijsktra算法对每一个节点使用 难点Dijsktra算法实现 体会与感想 这个金光闪闪的算法一定要记在脑子里啊~ 关键代码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657int Dijkstra(node * G, int n, int s)&#123; int * dist = new int [n]; int * path = new int [n]; bool * collected = new bool [n]; for (int i = 0; i &lt; n; i++) &#123; dist[i] = inf; path[i] = -1; collected[i] = false; &#125; dist[s] = 0; collected[s] = true; node * ptr = G[s].next; while (ptr) &#123; if (!collected[ptr-&gt;element]) &#123; int w = ptr-&gt;element; if (dist[s]+ptr-&gt;weight&lt;dist[w]) &#123; dist[w] = dist[s] + ptr-&gt;weight; path[w] = s; &#125; &#125; ptr = ptr-&gt;next; &#125; while (true) &#123; int min = inf, v = -1; for (int i = 0; i &lt; n; i++) &#123; if (!collected[i] &amp;&amp; dist[i]!=-1 &amp;&amp; dist[i]&lt;min) &#123; min = dist[i]; v = i; &#125; &#125; if (min==inf || v&lt;0) break; collected[v] = true; node * ptr = G[v].next; while (ptr) &#123; if (!collected[ptr-&gt;element]) &#123; int w = ptr-&gt;element; if (dist[v]+ptr-&gt;weight&lt;dist[w]) &#123; dist[w] = dist[v] + ptr-&gt;weight; path[w] = v; &#125; &#125; ptr = ptr-&gt;next; &#125; &#125; int min = -1; for (int i = 0; i &lt; n; i++) &#123; if (dist[i]==inf) return -1; if (dist[i]&gt;min) min = dist[i]; &#125; delete [] dist; delete [] path; delete [] collected; return min;&#125;","categories":[],"tags":[{"name":"数据结构与算法题目集（中文）","slug":"数据结构与算法题目集（中文）","permalink":"https://ainevsia.github.io/tags/数据结构与算法题目集（中文）/"}]},{"title":"7-7 六度空间","slug":"DS-7-7","date":"2018-08-15T09:51:11.000Z","updated":"2018-08-15T09:59:22.659Z","comments":true,"path":"2018/08/15/DS-7-7/","link":"","permalink":"https://ainevsia.github.io/2018/08/15/DS-7-7/","excerpt":"","text":"预备知识 六度空间理论：社交关系图中，任一两个节点总可以在六步之内相互关联。 题目描述用深度优先搜索一幅图的每一个节点相对于其他所有节点满足六度空间理论的百分率。 思路用上次写的邻接表表示的图，基本没什么多的操作，就是控制一下BFS的层数就结束了。 难点没有难点 体会与感想 在Clion中调试的时候，想看new出来的一片连续空间时，需要在new watch中添加命令123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175- c++想要控制输出固定位小数时，先用fixed固定好小数点，在用setprecesion控制保留几位小数- setprecesion本来是用来控制有效数字的# 源代码```C++#include &lt;iostream&gt;#include &lt;iomanip&gt;using namespace std;struct node &#123; int element; node * next;&#125;;struct Queue &#123; int * queue; int head; int tail; int size;&#125;;node * createGraph(int n);void readGraph(node * G, int e);int BFSvalid(node * G, int i, int n);void deleteGraph(node * G, int n);int main(int argc, char const *argv[]) &#123; freopen(&quot;D:\\\\SJTU\\\\Freshman Summer\\\\DS\\\\test.txt&quot;, &quot;r&quot;, stdin); int n, m;cin &gt;&gt; n &gt;&gt; m; node * G = createGraph(n); readGraph(G,m); for (int i = 0; i &lt; n; i++) &#123; int valid = BFSvalid(G,i,n); double percentage = valid / (double)n; cout &lt;&lt; i + 1 &lt;&lt; &quot;: &quot;; cout &lt;&lt; fixed &lt;&lt; setprecision(2) &lt;&lt; 100 * percentage; cout &lt;&lt; &apos;%&apos; &lt;&lt; endl; &#125; deleteGraph(G,n); return 0;&#125;int findMin(node * ptr, bool * visited) &#123; int min; while (ptr-&gt;next &amp;&amp; visited[ptr-&gt;next-&gt;element]) &#123; ptr = ptr-&gt;next; &#125; if (ptr-&gt;next==NULL) return -1; else min = ptr-&gt;next-&gt;element; ptr = ptr-&gt;next-&gt;next; while (ptr) &#123; if (ptr-&gt;element&lt;min &amp;&amp; !visited[ptr-&gt;element]) &#123; min = ptr-&gt;element; &#125; ptr = ptr-&gt;next; &#125; return min;&#125;bool remains(node * ptr, bool * visited) &#123; while (ptr-&gt;next) &#123; if (!visited[ptr-&gt;next-&gt;element]) &#123; return true; &#125; ptr = ptr-&gt;next; &#125; return false;&#125;Queue * creatQueue(int n) &#123; Queue * q = new Queue; q-&gt;size = n; q-&gt;queue = new int [n]; q-&gt;head = 0; q-&gt;tail = -1; return q;&#125;void deleteQueue(Queue * q) &#123; delete [] q-&gt;queue; delete q;&#125;void enQueue(Queue * q, int element) &#123; q-&gt;queue[++q-&gt;tail] = element;&#125;int deQueue(Queue * q) &#123; return q-&gt;queue[q-&gt;head++];&#125;void push(Queue * q, node * ptr, bool * visited, int * cnt) &#123; while (remains(ptr,visited)) &#123; int min = findMin(ptr,visited); if (min==-1) return; enQueue(q,min); (*cnt)++; visited[min] = true; &#125;&#125;int BFSvalid(node * G, int start, int n) &#123; //return the number of valid nodes Queue * q = creatQueue(n); //of the BFS of node i bool * visited = new bool [n]; for (int i = 0; i &lt; n; i++) &#123; visited[i] = false; &#125; int cnt = 1, degree = 6; enQueue(q,start); visited[start] = true; int sentry = q-&gt;tail; while (q-&gt;head!=q-&gt;tail+1 &amp;&amp; degree&gt;0) &#123; while (q-&gt;head!=sentry+1) &#123; int popelement = deQueue(q); push(q,&amp;G[popelement],visited,&amp;cnt); &#125; sentry = q-&gt;tail; degree--; &#125; delete [] visited; deleteQueue(q); return cnt;&#125;void deleteGraph(node * G, int n) &#123; for (int i = 0; i &lt; n; i++) &#123; node * ptr = G[i].next; while (ptr) &#123; node * temp = ptr-&gt;next; delete ptr; ptr = temp; &#125; &#125; delete [] G;&#125;void insertEdge(node * G, int i, int j) &#123; node * ptr = &amp;G[i]; while (ptr-&gt;next) &#123; ptr = ptr-&gt;next; &#125; ptr-&gt;next = new node; ptr = ptr-&gt;next; ptr-&gt;element = j; ptr-&gt;next = NULL; ptr = &amp;G[j]; while (ptr-&gt;next) &#123; ptr = ptr-&gt;next; &#125; ptr-&gt;next = new node; ptr = ptr-&gt;next; ptr-&gt;element = i; ptr-&gt;next = NULL;&#125;void readGraph(node * G, int e) &#123; int vi, vj; for (int i = 0; i &lt; e; i++) &#123; cin &gt;&gt; vi &gt;&gt; vj; insertEdge(G, vi-1, vj-1); &#125;&#125;node * createGraph(int n) &#123; node * G = new node [n]; for (int i = 0; i &lt; n; i++) &#123; G[i].element = i; G[i].next = NULL; &#125; return G;&#125;","categories":[],"tags":[{"name":"数据结构与算法题目集（中文）","slug":"数据结构与算法题目集（中文）","permalink":"https://ainevsia.github.io/tags/数据结构与算法题目集（中文）/"}]},{"title":"7-6 列出连通集","slug":"DS-7-6","date":"2018-08-14T13:16:52.000Z","updated":"2018-08-14T13:25:13.636Z","comments":true,"path":"2018/08/14/DS-7-6/","link":"","permalink":"https://ainevsia.github.io/2018/08/14/DS-7-6/","excerpt":"","text":"预备知识 图 多对多的关系 无向边（u v） 有向边 线性表 一对一 树 一对多 抽象数据类型定义的三要 类型名称 数据对象集 操作集 网络 带权重的图 图的表示方法取决于你要解决的具体问题 DFS 深度优先搜索 出栈 DFS 时间复杂度取决于图的表示方法 领接表 O(N+E) 邻接矩阵 O(N^2) BFS 广度优先 DFS BFS 复杂度相同 广优的话，占内存多，能找到最优解，必须遍历所有分枝. 广优的一个应用就是迪科斯彻单元最短路径算法. 深优的话，占内存少，能找到最优解（一定条件下），但能很快找到接近解（优点），可能不必遍历所有分枝（也就是速度快）, 深优的一个应用就是连连看游戏. 连通分量 一次DFS 遍历了一个连通分量 题目描述分别用深度优先搜索和广度优先搜索遍历一幅图的所有节点。 思路首先就是考虑这个图该用领接表还是邻接矩阵来表示，后来在码代码的过程中发现确实是邻接矩阵方便的多，不用findmin函数。但我没用过邻接表，这次练习一下。 难点基本没有难点 体会与感想 大工程绝对不要企图用一个.cpp文件就想写完，太天真了。 果然写的太长了是因为我太菜了嘛 半天200行的效率 反复传图指针很难受 还没来得及看视频 源代码 这次的代码比较长，放一个文件里也比较乱 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191#include &lt;iostream&gt;using namespace std;struct node &#123; int element; node * next;&#125;;struct Queue &#123; int * queue; int head; int tail; int size;&#125;;node * createGraph(int n);void readGraph(node * G, int e);void DFSlistComponents(node * G, int n);void deleteGraph(node * G, int n);void BFSlistComponents(node * G, int n);int main(int argc, char const *argv[]) &#123; freopen(\"D:\\\\SJTU\\\\Freshman Summer\\\\DS\\\\test.txt\", \"r\", stdin); int n, e;cin &gt;&gt; n &gt;&gt; e; node * G = createGraph(n); readGraph(G,e); DFSlistComponents(G,n); BFSlistComponents(G,n); deleteGraph(G,n); return 0;&#125;int findMin(node * ptr, bool * visited) &#123; int min; while (ptr-&gt;next &amp;&amp; visited[ptr-&gt;next-&gt;element]) &#123; ptr = ptr-&gt;next; &#125; if (ptr-&gt;next==NULL) return -1; else min = ptr-&gt;next-&gt;element; ptr = ptr-&gt;next-&gt;next; while (ptr) &#123; if (ptr-&gt;element&lt;min &amp;&amp; !visited[ptr-&gt;element]) &#123; min = ptr-&gt;element; &#125; ptr = ptr-&gt;next; &#125; return min;&#125;bool remains(node * ptr, bool * visited) &#123; while (ptr-&gt;next) &#123; if (!visited[ptr-&gt;next-&gt;element]) &#123; return true; &#125; ptr = ptr-&gt;next; &#125; return false;&#125;Queue * creatQueue(int n) &#123; Queue * q = new Queue; q-&gt;size = n; q-&gt;queue = new int [n]; q-&gt;head = 0; q-&gt;tail = -1; return q;&#125;void deleteQueue(Queue * q) &#123; delete [] q-&gt;queue; delete q;&#125;void enQueue(Queue * q, int element) &#123; q-&gt;queue[++q-&gt;tail] = element;&#125;int deQueue(Queue * q) &#123; return q-&gt;queue[q-&gt;head++];&#125;void push(Queue * q, node * ptr, bool * visited) &#123; while (remains(ptr,visited)) &#123; int min = findMin(ptr,visited); if (min==-1) return; enQueue(q,min); visited[min] = true; &#125;&#125;void BFSlistComponents(node * G, int n) &#123; Queue * q = creatQueue(n); bool * visited = new bool [n]; for (int i = 0; i &lt; n; i++) &#123; visited[i] = false; &#125; for (int i = 0; i &lt; n; i++) &#123; if (!visited[i]) &#123; cout &lt;&lt; \"&#123; \"; enQueue(q,i); visited[i] = true; while (q-&gt;head!=q-&gt;tail+1) &#123; int popelement = deQueue(q); cout &lt;&lt; popelement &lt;&lt;\" \"; push(q,&amp;G[popelement],visited); &#125; cout &lt;&lt; '&#125;' &lt;&lt; endl; &#125; &#125; delete [] visited; deleteQueue(q);&#125;void DFS(node * G, int i, bool * visited) &#123; while (remains(&amp;G[i],visited)) &#123; int min = findMin(&amp;G[i],visited); if (min==-1) return; cout &lt;&lt; min &lt;&lt;\" \"; visited[min] = true; DFS(G,min,visited); &#125;&#125;void DFSlistComponents(node * G, int n) &#123; bool * visited = new bool [n]; for (int i = 0; i &lt; n; i++) &#123; visited[i] = false; &#125; for (int i = 0; i &lt; n; i++) &#123; if (visited[i]) continue; cout &lt;&lt; \"&#123; \"; if (!visited[i]) &#123; cout &lt;&lt; i &lt;&lt;\" \"; visited[i] = true; DFS(G,i,visited); &#125; cout &lt;&lt; \"&#125;\" &lt;&lt; endl; &#125; delete [] visited;&#125;void deleteGraph(node * G, int n) &#123; for (int i = 0; i &lt; n; i++) &#123; node * ptr = G[i].next; while (ptr) &#123; node * temp = ptr-&gt;next; delete ptr; ptr = temp; &#125; &#125; delete [] G;&#125;void insertEdge(node * G, int i, int j) &#123; node * ptr = &amp;G[i]; while (ptr-&gt;next) &#123; ptr = ptr-&gt;next; &#125; ptr-&gt;next = new node; ptr = ptr-&gt;next; ptr-&gt;element = j; ptr-&gt;next = NULL; ptr = &amp;G[j]; while (ptr-&gt;next) &#123; ptr = ptr-&gt;next; &#125; ptr-&gt;next = new node; ptr = ptr-&gt;next; ptr-&gt;element = i; ptr-&gt;next = NULL;&#125;void readGraph(node * G, int e) &#123; int vi, vj; for (int i = 0; i &lt; e; i++) &#123; cin &gt;&gt; vi &gt;&gt; vj; insertEdge(G, vi, vj); &#125;&#125;node * createGraph(int n) &#123; node * G = new node [n]; for (int i = 0; i &lt; n; i++) &#123; G[i].element = i; G[i].next = NULL; &#125; return G;&#125;","categories":[],"tags":[{"name":"数据结构与算法题目集（中文）","slug":"数据结构与算法题目集（中文）","permalink":"https://ainevsia.github.io/tags/数据结构与算法题目集（中文）/"}]},{"title":"自搭梯子翻越GFW","slug":"GFW","date":"2018-08-12T12:04:23.000Z","updated":"2019-03-02T06:44:41.634Z","comments":true,"path":"2018/08/12/GFW/","link":"","permalink":"https://ainevsia.github.io/2018/08/12/GFW/","excerpt":"","text":"主要借鉴 十分钟搭建自己的科学上网SSR梯子非常感谢！ 思路 首先你得先租借好专用的VPS，推荐的有Digitalocean和Vultr 我先是试了试Singapore的服务器发现很慢，于是换了LA的，爽的不行。 然后就是在登陆服务器之后通过rrsmu.sh脚本安装ShadowsocksR 最后在自己的客户端装上SSR 奇迹就这样发生了","categories":[],"tags":[]},{"title":"7-4 是否同一棵二叉搜索树","slug":"DS-7-4","date":"2018-08-12T03:28:11.000Z","updated":"2018-08-12T08:52:25.880Z","comments":true,"path":"2018/08/12/DS-7-4/","link":"","permalink":"https://ainevsia.github.io/2018/08/12/DS-7-4/","excerpt":"","text":"题目描述判断给定的插入序列是否构成同一棵二叉搜索树 （二叉搜索树：所有左子树元素都小于自身，所有右子树元素都大于自身） 输入12345678984 23 1 4 23 4 1 23 2 4 12 12 11 20 输出123YesNoNo 思路判断数列的奇淫技巧，测试点1过不了。 哈哈现在我的奇淫技巧过了。 更新了根据即将插入的根进行判断。 难点选择比较的方法以及原始数据和比较数据的储存形式 体会与感想自己写的代码多看几遍总归是能看懂的，理清楚的。 还有很想说的是cmake不支持中文以及文件名中的空格，以后再也不用中文了。 真的，实在是..所有中文一律乱码 看了视频之后再写真的是畅通无比，一次提交直接AC。 膜递归… 源代码12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879#include &lt;iostream&gt;using namespace std;void comparetree(int n, int l);int main(int argc, char const *argv[]) &#123; freopen(\"D:\\\\SJTU\\\\Freshman Summer\\\\DS\\\\test.txt\", \"r\", stdin); while (true) &#123; int n;cin&gt;&gt;n; if (n==0) break; int l;cin&gt;&gt;l; comparetree(n,l); &#125; return 0;&#125;void print(bool same)&#123; switch (same) &#123; case true: cout &lt;&lt; \"Yes\" &lt;&lt; endl;break; case false:cout &lt;&lt; \"No\" &lt;&lt; endl;break; &#125;&#125;void comparetree(int n, int l)&#123; int * src = new int [n]; //src--the original array int * select = new int [n]; //select 0--&gt;not added to the cmp tree for (size_t i = 0; i &lt; n; i++) cin &gt;&gt; src[i]; //select 1--&gt;added to the cmp tree int * cmp = new int [n]; for (size_t i = 0; i &lt; l; i++) &#123; bool same = true; for (size_t i = 0; i &lt; n; i++) &#123;cin &gt;&gt; cmp[i];select[i]=0;&#125; if (src[0]!=cmp[0]) &#123; //judge the head same = false; print(same); continue; &#125;else select[0] = 1; for (size_t i = 1; i &lt; n &amp;&amp; same; i++) &#123; //i--indecate the cmp node int rootcmp = src[0]; for (size_t k = 1; k &lt; n; k++) &#123; if (src[k]&gt;rootcmp&amp;&amp;select[k]==1&amp;&amp;cmp[i]&gt;rootcmp) &#123; rootcmp = src[k]; &#125;else if (src[k]&lt;rootcmp&amp;&amp;select[k]==1&amp;&amp;cmp[i]&lt;rootcmp) &#123; rootcmp = src[k]; &#125; &#125; for (size_t j = 1; j &lt; n; j++) &#123; if (select[j]==1) continue; if (cmp[i]==src[j]) &#123; select[j] = 1; break; &#125; int rootsrc = src[0]; for (size_t k = 1; k &lt; j; k++) &#123; if (src[k]&gt;rootsrc&amp;&amp;src[j]&gt;rootsrc) &#123; rootsrc = src[k]; &#125;else if (src[k]&lt;rootsrc&amp;&amp;src[j]&lt;rootsrc) &#123; rootsrc = src[k]; &#125; &#125; if (rootcmp==rootsrc) &#123; if (cmp[i]&gt;rootcmp&amp;&amp;src[j]&gt;rootsrc&amp;&amp;cmp[i]!=src[j]) &#123; same = false; print(same); break; &#125; if (cmp[i]&lt;rootcmp&amp;&amp;src[j]&lt;rootsrc&amp;&amp;cmp[i]!=src[j]) &#123; same = false; print(same); break; &#125; &#125; &#125; &#125; if (same) print(same); &#125;&#125; 顺便再贴一下看了视频之后的源码结构更加清晰 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108#include &lt;iostream&gt;using namespace std;struct node &#123; int value; node * left; node * right; int select;&#125;;node * maketree(int n);void deletetree(node * tree);bool treecmp(node * tree, int n);int main(int argc, char const *argv[]) &#123; freopen(\"D:\\\\SJTU\\\\Freshman Summer\\\\DS\\\\test.txt\", \"r\", stdin); int n;cin &gt;&gt; n; while (n) &#123; int l;cin &gt;&gt; l; node * tree = maketree(n); for (int i = 0; i &lt; l; i++) &#123; if (treecmp(tree,n)) cout &lt;&lt; \"Yes\" &lt;&lt; endl; else cout &lt;&lt; \"No\" &lt;&lt; endl; &#125; deletetree(tree); cin &gt;&gt; n; &#125; return 0;&#125;bool check(node * tree, int v)&#123; if (!tree) return false; if (tree-&gt;value==v) &#123; tree-&gt;select = 1; return true; &#125; if (tree-&gt;select==0) &#123; return false; &#125; if (tree-&gt;value&gt;v) &#123; return check(tree-&gt;left,v); &#125;else&#123; return check(tree-&gt;right,v); &#125;&#125;void settree(node * tree)&#123; if (!tree) return; if (tree-&gt;left) settree(tree-&gt;left) ; if (tree-&gt;right) settree(tree-&gt;right); tree-&gt;select = 0;&#125;bool treecmp(node * tree, int n)&#123; settree(tree); int v; bool ret = true; for (int i = 0; i &lt; n; i++) &#123; cin &gt;&gt; v; if (!check(tree,v)) ret = false; &#125; return ret;&#125;void deletetree(node * tree)&#123; if (!tree) return; if (tree-&gt;left) deletetree(tree-&gt;left) ; if (tree-&gt;right) deletetree(tree-&gt;right); delete tree;&#125;node * newnode(int value)&#123; node * treenode = new node; treenode-&gt;left = NULL ; treenode-&gt;right = NULL ; treenode-&gt;value = value ; treenode-&gt;select = 0 ; return treenode;&#125;node * attachnode(node * tree, int value)&#123; if (!tree) &#123; return newnode(value); &#125;else&#123; if (tree-&gt;value&gt;value) tree-&gt;left = attachnode(tree-&gt;left ,value); else tree-&gt;right= attachnode(tree-&gt;right,value); return tree; &#125;&#125;node * maketree(int n)&#123; int value; node * tree = NULL; for (int i = 0; i &lt; n; i++) &#123; cin &gt;&gt; value; tree = attachnode(tree,value); &#125; return tree;&#125;","categories":[],"tags":[{"name":"数据结构与算法题目集（中文）","slug":"数据结构与算法题目集（中文）","permalink":"https://ainevsia.github.io/tags/数据结构与算法题目集（中文）/"}]},{"title":"7-3 树的同构","slug":"DS-7-3","date":"2018-08-11T14:12:10.000Z","updated":"2018-08-11T14:31:09.215Z","comments":true,"path":"2018/08/11/DS-7-3/","link":"","permalink":"https://ainevsia.github.io/2018/08/11/DS-7-3/","excerpt":"","text":"题目描述判断给出的两棵树是否是同构的（同构-即左右子树可以相互交换位置） 输入1234567891011121314151617188A 1 2B 3 4C 5 -D - -E 6 -G 7 -F - -H - -8G - 4B 7 6F - -A 5 1H - -C 0 -D - -E 2 - 输出1Yes 思路刚开始听了MOOC上说用静态链表（简单来说就是数组，只不过每个元素带有指针效果的元素）后这么想的：读入需要两个inArray，再根据这两个Array构造两个满二叉树的char型数组，然后用递归写一个cmp在满二叉树的char型数组上比较。实在太麻烦了。 然后就用了MOOC上的方法。搞了全局变量，简直不要太舒服。 最后一个边界条件（n=0）引起的段错误调的我ooxx 难点怎么组织你的数据，就像老师讲的： 你打算怎么储存两棵树 怎么找到根节点（这个简单） 怎么比较同构1和3我现在都还是无法驾驭。1是熟练掌握数据结构的应用，3是写递归程序。 体会与感想深深地体会到了大神的代码和我自己的代码之间的区别（100+行都写不完和60行AC的差距）orz 当你函数的参数≥四个并且还是在反复传同一个参数的时候，你就该想想你的思路是不是不太对了。 有时候全局变量该用就得用，否则到时候难受的是你自己。 main函数里东西越少越好，代码质量越高，可读性越好。 递归函数感觉还是比较虚，边界条件有时理不清。 尽可能地检查边界条件（极小与极大）。 源代码1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192#include &lt;iostream&gt;#define max 10#define null -1using namespace std;struct node &#123; char element; int left; int right;&#125;tree1[max], tree2[max];int build(node * tree);bool isomorphic(int r1, int r2);int main(int argc, char const *argv[]) &#123; freopen(\"D:\\\\SJTU\\\\Freshman Summer\\\\DS\\\\test.txt\", \"r\", stdin); int r1 = 0, r2 = 0; r1 = build(tree1); r2 = build(tree2); if (r1!=-1 &amp;&amp; r2!=-1) &#123; if (isomorphic(r1,r2)) cout &lt;&lt; \"Yes\"; else cout &lt;&lt; \"No\"; &#125;else if (r1==-1 &amp;&amp; r2==-1) &#123; cout &lt;&lt; \"Yes\"; &#125;else cout &lt;&lt; \"No\"; return 0;&#125;bool isomorphic(int r1, int r2)&#123; if (r1==null &amp;&amp; r2==null) return true; if (r1==null || r2==null) return false; int n1 = 0, n2 = 0; if (tree1[r1].left==null) n1++; if (tree1[r1].right==null) n1++; if (tree2[r2].left==null) n2++; if (tree2[r2].right==null) n2++; if (n1!=n2) return false; if (tree1[r1].element!=tree2[r2].element) return false; if (n1==2) return true; else if (n1==1) &#123; if (tree1[r1].left==null&amp;&amp;tree2[r2].left==null) &#123; return isomorphic(tree1[r1].right,tree2[r2].right); &#125; else if (tree1[r1].left==null&amp;&amp;tree2[r2].right==null) &#123; return isomorphic(tree1[r1].right,tree2[r2].left); &#125; else if (tree1[r1].right==null&amp;&amp;tree2[r2].left==null) &#123; return isomorphic(tree1[r1].left,tree2[r2].right); &#125; else if (tree1[r1].right==null&amp;&amp;tree2[r2].right==null) &#123; return isomorphic(tree1[r1].left,tree2[r2].left); &#125; &#125; else if (n1==0) &#123; if (tree1[tree1[r1].left].element==tree2[tree2[r2].left].element) &#123; return isomorphic(tree1[r1].left,tree2[r2].left) &amp;&amp; isomorphic(tree1[r1].right,tree2[r2].right); &#125;else&#123; return isomorphic(tree1[r1].left,tree2[r2].right) &amp;&amp; isomorphic(tree1[r1].right,tree2[r2].left); &#125; &#125; return true;&#125;int build(node * tree)&#123; int n;cin &gt;&gt; n; if (n==0) return -1; int * select = new int [n]; char le, ri; for (int i = 0; i &lt; n; i++) select[i] = 0; for (int i = 0; i &lt; n; i++) &#123; cin &gt;&gt; tree[i].element &gt;&gt; le &gt;&gt; ri; if (le!='-') &#123; tree[i].left = le - '0'; select[tree[i].left] = 1; &#125;else tree[i].left = null; if (ri!='-') &#123; tree[i].right = ri - '0'; select[tree[i].right] = 1; &#125;else tree[i].right = null; &#125; int ret = 0; for (int i = 0; i &lt; n; i++) &#123; if (select[i]==0) &#123; ret = i; break; &#125; &#125; delete [] select; return ret;&#125;","categories":[],"tags":[{"name":"数据结构与算法题目集（中文）","slug":"数据结构与算法题目集（中文）","permalink":"https://ainevsia.github.io/tags/数据结构与算法题目集（中文）/"}]},{"title":"JavaScript编程艺术读后感","slug":"jsdom","date":"2018-08-02T04:18:00.000Z","updated":"2018-08-02T04:36:40.543Z","comments":true,"path":"2018/08/02/jsdom/","link":"","permalink":"https://ainevsia.github.io/2018/08/02/jsdom/","excerpt":"","text":"关于本书知乎上不知道是看了谁的推荐找到的这本书，从上周五放假了之后花了一周陆陆续续看完了 感想js感觉和c没什么差别啦最大的感觉就是web规范还有穿透全书的两大主题：平稳退化以及渐进增强 平稳退化：就是你要考虑到当你写的js被禁用的时候网页会变成什么样子。是直接蹦了还是跑样式了还是能勉强浏览。这是作者始终在强调的，可是我觉得现在我是理解无能的。说实话，有点小小抵触这种想法，我学js不就是为了实现那些行为效果吗，可能以后会有更深的理解的。 渐进增强：由底向上编程。了解了web才知道HTML css js这三驾马车，缺一不可。HTML是网站的主体内容，css负责美工上色，js负责网页行为交互。书最后还介绍了Ajax，我是看不懂了。总之看了这本书给我的一个启示就是：我不喜欢js。","categories":[],"tags":[{"name":"阅读","slug":"阅读","permalink":"https://ainevsia.github.io/tags/阅读/"}]},{"title":"小学期结束了，假期开始了","slug":"SummerSemesterEnd","date":"2018-07-27T08:40:02.000Z","updated":"2018-07-27T08:58:07.171Z","comments":true,"path":"2018/07/27/SummerSemesterEnd/","link":"","permalink":"https://ainevsia.github.io/2018/07/27/SummerSemesterEnd/","excerpt":"","text":"离别昨天傍晚阿阳一家就已经接他回江苏了，今早阿可一个人很早就出发了，中午的时候，阿韬的爸妈也来接他回江苏了。寝室里的人一个个地减少，最后，现在只剩下我了。 宿舍里的生气渐渐变少，阳台上晒着的衣服一件件地被不同的人收了进来，带回了家，阳台变得一干二净。上铺的床被搬空，书架上的书被带回了家，书桌被收拾的干干净净。窗外的蝉叫的更响亮了。 离别的气息充斥。 我一个人默默地考完最后一场考试，从东上院走出来。路上没有什么人，整个校园安安静静，仿佛整个世界只剩下闷热的空气。 孤独是一种常态吧，是嘛？ 我曾经不停地希望着中午回到寝室他们能不要吵，让我安安静静地再看一会儿书。 人可真是奇怪的动物，哈哈。 QQ也已经聊得很少了，在学期里明明是不想过多地去了解别人的消息，可是现在却热切地渴望着掌握别人的动态。 起航这个假期我准备干些什么呢？ 我想准备GRE，复习数据结构，看js书，多多做一些家务，多学一些日常本领。 还想预习一下下学期的电学基础课，多看一些文学书。 想保证一个健康的作息。","categories":[],"tags":[{"name":"Freshman-Summer","slug":"Freshman-Summer","permalink":"https://ainevsia.github.io/tags/Freshman-Summer/"}]},{"title":"7-2 一元多项式的乘法与加法运算","slug":"DS-7-2","date":"2018-07-18T12:09:50.000Z","updated":"2018-07-18T12:24:29.697Z","comments":true,"path":"2018/07/18/DS-7-2/","link":"","permalink":"https://ainevsia.github.io/2018/07/18/DS-7-2/","excerpt":"","text":"题目描述设计函数分别求两个一元多项式的乘积与和。 输入124 3 4 -5 2 6 1 -2 03 5 20 -7 4 3 1 输出1215 24 -25 22 30 21 -10 20 -21 8 35 6 -33 5 14 4 -15 3 18 2 -6 15 20 -4 4 -5 2 9 1 -2 0 思路首先要确定多项式的储存结构，决定用链表按照指数递降顺序存储。 接下来无非就是两个难题，一个是怎么加，一个是怎么乘。 难点一开始的时候我乘法用了我现在用的加法算法在一个个向后推，可以说是相当的蠢萌了。 加法标准做法是3个循环搞定，第一轮循环两个链表同时向后推，一个推到最后就把另一个剩下的全接上去就可以了。 乘法有很多种做法，我用了老师讲的插入法。 两轮循环，每一次都要向已有的链表上插入一个新的点，有时需要合并，有时需要删点。 源代码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197#include &lt;iostream&gt;using namespace std;const int MAX = 1003;struct node&#123; int coef;//系数 int expo;//指数 node * next;&#125;;node * CreatList(node * head); //单链表的读入与创建void PrintList(node * head); //输出以head为头结点的链表node * MultiplyList(node * p1, node *p2); //多项式乘法void Attach(int coef, int expo, node **nodepointer); //插入一个节点至nodepointer后node * AddList(node * p1, node *p2); //多项式加法void FreeList(node * p); //内存释放int main(int argc, char const *argv[]) &#123; node *head1 = NULL, *head2 = NULL; head1 = CreatList(head1); head2 = CreatList(head2); node *multi = MultiplyList(head1, head2); node *add = AddList(head1, head2); PrintList(multi);cout &lt;&lt; endl; PrintList(add); FreeList(head1);FreeList(head2);FreeList(multi);FreeList(add); return 0;&#125;node * CreatList(node * head)&#123; int coef, expo, k; node * p; head = new node; cin &gt;&gt; k; if ( !k ) return NULL; cin &gt;&gt; coef &gt;&gt; expo; head-&gt;coef = coef; head-&gt;expo = expo; head-&gt;next = NULL; p = head; for (size_t i = 1; i &lt; k; i++) &#123; cin &gt;&gt; coef &gt;&gt; expo; node *temp = new node; p-&gt;next = temp; temp-&gt;coef = coef; temp-&gt;expo = expo; temp-&gt;next = NULL; p = temp; &#125; return head;&#125;void PrintList(node * head)&#123; if ( !head ) &#123; cout &lt;&lt; \"0 0\"; &#125; while ( head ) &#123; cout &lt;&lt; head-&gt;coef &lt;&lt; \" \" &lt;&lt; head-&gt;expo; head = head-&gt;next; if ( head ) cout &lt;&lt; \" \"; &#125;&#125;//by inserting to the right place 2 loopsnode * MultiplyList(node * p1, node *p2)//p is the pointor&#123; //poining to the current node node *head = new node; head-&gt;expo = MAX; head-&gt;next = NULL; while ( p1 ) &#123; node *p = p2; while ( p ) &#123; //PrintList(head-&gt;next); //cout &lt;&lt; endl &lt;&lt; endl; int coef = p1-&gt;coef * p-&gt;coef; int expo = p1-&gt;expo + p-&gt;expo; node *temp = head; while ( true ) &#123; //point to one in front // cout &lt;&lt; \"once \"; if ( !(temp-&gt;next) || temp-&gt;next-&gt;expo&lt;=expo ) break; temp = temp-&gt;next; &#125; //now temp points to the insert place ahead // cout &lt;&lt; \"now expo is \" &lt;&lt; expo; // cout &lt;&lt; \"my temp-&gt;expo = \" &lt;&lt; temp-&gt;expo &lt;&lt; endl; if ( temp-&gt;next &amp;&amp; temp-&gt;next-&gt;expo == expo ) &#123; if ( temp-&gt;next-&gt;coef + coef == 0 ) &#123; //delete node * tobefreed = temp-&gt;next; temp-&gt;next = tobefreed-&gt;next; delete tobefreed; &#125;else &#123; //join together temp-&gt;next-&gt;coef += coef; &#125; &#125;else Attach(coef, expo, &amp;temp); p = p-&gt;next; &#125; p1 = p1-&gt;next; &#125; node * tobedeleted = head; head = head-&gt;next; delete tobedeleted; return head;&#125;void Attach(int coef, int expo, node **nodepointer)&#123; // cout &lt;&lt; \"now coef=\" &lt;&lt; coef &lt;&lt; \" expo=\" &lt;&lt; expo &lt;&lt; // \" inserted after expo=\" &lt;&lt; (*nodepointer)-&gt;expo &lt;&lt; endl; node * temp = new node; temp-&gt;coef = coef; temp-&gt;expo = expo; temp-&gt;next = (*nodepointer)-&gt;next; (*nodepointer)-&gt;next = temp;//here // cout &lt;&lt; \"now temp-&gt;next=\" &lt;&lt; temp-&gt;next; // cout &lt;&lt; \" *nodepointer points to expo\" &lt;&lt; (*nodepointer)-&gt;expo;&#125;node * AddList(node * p1, node *p2) //receive 2 pointers and return the AddList&#123; //head is a pointer to the head node node * p, * head; head = new node; //head is a head noder contains p = head; //nothing but a next pointor head-&gt;coef = 0; head-&gt;expo = 0; head-&gt;next = NULL; while ( p1 &amp;&amp; p2 ) &#123; int expo1, expo2; expo1 = p1-&gt;expo; expo2 = p2-&gt;expo; if ( expo1 &gt; expo2 ) &#123;//copy p-&gt;next = new node; p = p-&gt;next; p-&gt;next = NULL; p-&gt;expo = p1-&gt;expo; p-&gt;coef = p1-&gt;coef; p1 = p1-&gt;next; &#125;else if ( expo1 &lt; expo2 ) &#123; p-&gt;next = new node; p = p-&gt;next; p-&gt;next = NULL; p-&gt;expo = p2-&gt;expo; p-&gt;coef = p2-&gt;coef; p2 = p2-&gt;next; &#125;else &#123; int coef = p1-&gt;coef + p2-&gt;coef; if ( coef ) &#123; p-&gt;next = new node; p = p-&gt;next; p-&gt;next = NULL; p-&gt;expo = p1-&gt;expo; p-&gt;coef = coef; &#125; p1 = p1-&gt;next; p2 = p2-&gt;next; &#125; &#125; while ( p2 ) &#123; p-&gt;next = new node; p = p-&gt;next; p-&gt;next = NULL; p-&gt;expo = p2-&gt;expo; p-&gt;coef = p2-&gt;coef; p2 = p2-&gt;next; &#125; while ( p1 ) &#123; p-&gt;next = new node; p = p-&gt;next; p-&gt;next = NULL; p-&gt;expo = p1-&gt;expo; p-&gt;coef = p1-&gt;coef; p1 = p1-&gt;next; &#125; //cout &lt;&lt; head-&gt;next; p = head; head = head-&gt;next; delete p; return head; // if ( head-&gt;next ) &#123; // &#125;else &#123; // return head; // &#125;&#125;void FreeList(node * p)&#123; node * next; while ( p ) &#123; next = p-&gt;next; delete p; p = p-&gt;next; &#125;&#125;/*程序最后的两个细节问题1- 当加法结果为零时的输出2- 当有一个k为零时的输出*/","categories":[],"tags":[{"name":"数据结构与算法题目集（中文）","slug":"数据结构与算法题目集（中文）","permalink":"https://ainevsia.github.io/tags/数据结构与算法题目集（中文）/"}]},{"title":"期末感想","slug":"dark-time-reflection","date":"2018-06-07T04:07:48.000Z","updated":"2018-06-07T07:42:29.162Z","comments":true,"path":"2018/06/07/dark-time-reflection/","link":"","permalink":"https://ainevsia.github.io/2018/06/07/dark-time-reflection/","excerpt":"","text":"我曾经一直以为期末挂科是不可能的 现在发现我太天真了It is possible that I am going to fail the 大学物理 量子物理 电路理论就是因为别人不在听，所以我就没有动力去做吗就是因为觉得课程弱智，一点都帮不到我，所以我就一拖再拖，拖到最后就不做吗网络并不是万能的远远不是万能的 他搜索不到钱寅哲的下落 你永远都想不到你连大英都会挂我并不认为自己比别人差我认为把自己在做的事情做到最好就可以了 这只不过是一道坎罢了 坚持下去 跨过去 你就会成长what doesn’t kill you makes you stronger. 为了加分使劲地举手 很令人丢脸吗我的存在对他人的影响 有很大吗 有电脑在手上 就是把自由带在了身边不要把别人想的想你一样浅薄 是什么让我变得平庸 他们从来都没有失败我觉得他们比我自己强多了失败让他们变得更加强大那么我呢失败是否会击败我还是让我变的更加强大呢 成绩难道不是我自己求得的吗只是我自己的随想罢了 我本来很强嘛我觉得思考这些东西很累说实话 让我去思考什么全球化的东西 我一点感想都没有让我对时政发表看法 我一点想法都没有我认为别人会时时刻刻地关注我然而 他们并没有 他们只是关注于自己的事情罢了就像我自己一样我有时候很讨厌说话装逼的人我有时候讨厌那些说大话空话的人我有时候根本就不想说话我有时候想享受大家对我的关心然而却不愿意去主动关心他人 你学到的东西eye contact","categories":[],"tags":[{"name":"不要放弃 熬过去就行了","slug":"不要放弃-熬过去就行了","permalink":"https://ainevsia.github.io/tags/不要放弃-熬过去就行了/"}]},{"title":"PAT-A-1051","slug":"PAT-A-1051","date":"2018-05-07T11:52:55.000Z","updated":"2018-05-07T12:00:41.743Z","comments":true,"path":"2018/05/07/PAT-A-1051/","link":"","permalink":"https://ainevsia.github.io/2018/05/07/PAT-A-1051/","excerpt":"","text":"DescriptionGiven a stack which can keep M numbers at most. Push N numbers in the order of 1, 2, 3, …, N and pop randomly. You are supposed to tell if a given sequence of numbers is a possible pop sequence of the stack. For example, if M is 5 and N is 7, we can obtain 1, 2, 3, 4, 5, 6, 7 from the stack, but not 3, 2, 1, 7, 5, 6, 4. Thoughtsjust Stack simulation Long time no code and my coding ability drops significantly. This problem may be rather simple for some one, but it just serve the purpose of revieweing the basic knowledges for me. Sometimes a tiny bug can drive you crazy. No one can come to the final solution at the first glance, but as long as you spend your time on it, it will no doubt seem more ane more clear to you. Codes1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768#include &lt;iostream&gt;using namespace std;int main(int argc, char const *argv[]) &#123; //freopen(&quot;D:\\\\cpphomework\\\\test.txt&quot;, &quot;r&quot;, stdin); int m, n, k;cin &gt;&gt; m &gt;&gt; n &gt;&gt; k; int **Sequence = new int * [k]; for (size_t i = 0; i &lt; k; i++) Sequence[i] = new int [n]; int *used = new int [n+1], *result = new int [n]; int remaining = m; for (size_t i = 0; i &lt; k; i++) &#123; result[i] = 1; for (size_t j = 0; j &lt; n; j++) &#123; cin &gt;&gt; Sequence[i][j]; &#125; &#125; //prepare for (size_t i = 0; i &lt; k; i++) &#123; remaining = m; for (size_t j = 1; j &lt;= n; j++) used[j]=0; int q = 1, c = 0; //start while ( q&lt;=n &amp;&amp; remaining&gt;0 &amp;&amp; result[i] ) &#123; if ( q==Sequence[i][c] ) &#123; used[q] = 1; while ( c+1&lt;n &amp;&amp; Sequence[i][c+1]&lt;Sequence[i][c] ) &#123; int examine = Sequence[i][c]-1; while ( used[examine]==1 ) examine--; if ( Sequence[i][c+1]==examine ) &#123; used[examine] = 1; remaining++;c++; &#125;else &#123; result[i] = 0;break; &#125; &#125; q++;c++; &#125; else &#123; q++;remaining--; &#125; &#125; if ( q&lt;=n ) &#123; result[i] = 0; &#125; for (size_t j = 1; result[i] &amp;&amp; j &lt;= n; j++) &#123; if ( used[j]!=1 ) &#123; result[j] = 0; break; &#125; &#125; &#125; //output for (size_t i = 0; i &lt; k; i++) &#123; switch ( result[i] ) &#123; case 1: cout &lt;&lt; &quot;YES&quot;;break; case 0: cout &lt;&lt; &quot;NO&quot;;break; &#125; if ( i!=k-1 ) cout &lt;&lt; endl; &#125; //delete for (size_t i = 0; i &lt; k; i++) delete [] Sequence[i]; delete [] Sequence; delete [] used; delete [] result; return 0;&#125;","categories":[],"tags":[{"name":"PAT-Advanced-Level","slug":"PAT-Advanced-Level","permalink":"https://ainevsia.github.io/tags/PAT-Advanced-Level/"}]},{"title":"18-04-03","slug":"reflectino","date":"2018-04-03T05:34:09.000Z","updated":"2018-04-11T15:23:09.950Z","comments":true,"path":"2018/04/03/reflectino/","link":"","permalink":"https://ainevsia.github.io/2018/04/03/reflectino/","excerpt":"","text":"我并不是讨厌生活，我只是讨厌现在的自己中午搜了半小时的《向死而生》的当年看过的那篇博客。 然后就发现了，我确实是不会用搜索引擎。 上午的高数课最后一小点儿我没听懂 大物课我也是最后的质心参考系没跟上老师的进度。 我只是想把我在做的每一件事都尽我的可能做到最好，为什么这么简单的要求我还是做不到？昨天两次实验全部做崩。 物理实验线性关系没有做出来 化学实验产率13% 思路一旦没有转过来我就全完蛋 这几天为什么都诸事不顺啊高数做10题能错7题。离散上周的作业都留到了这周才做。思修小组作业没有做。练琴没有时间练。电路理论上了课作业还是不会做。 大学和高中完全不同。 大学可能是玄学。 怎么在巩固好学业的基础上处理学生事务、生活事务。 不要灰心、不要沮丧、坚持、坚持、坚持、坚持、坚持。 黎明前的黑暗是最难熬的。 不要再自我安慰了离散你只是上课去听个课你说你能学好吗？ 就像你只听老师讲c++自己不码代码绝对的挂科。 晚安。 开心一点。 再过几分钟就是全新的一天了。 明天加油。 思修课抱到大腿了超级大的腿 天生的演讲者 不劳而获的愧疚感 不要一直只想着自己 多为别人考虑考虑","categories":[],"tags":[{"name":"心情日记","slug":"心情日记","permalink":"https://ainevsia.github.io/tags/心情日记/"}]},{"title":"寒假见闻","slug":"寒假见闻","date":"2018-02-14T13:49:51.000Z","updated":"2018-09-08T14:33:28.206Z","comments":true,"path":"2018/02/14/寒假见闻/","link":"","permalink":"https://ainevsia.github.io/2018/02/14/寒假见闻/","excerpt":"","text":"这个寒假我干了啥呢？ 日期 事件 5日 去九院看牙齿，得知还不能装上牙套，母生气，徐家汇购物，校医院配药 6日 外婆家，高烧，傍晚五院点滴 7日 科目四，查询报销 8日 无所事事,忘了 9日 blog 10日 收快递，驾照，win7 11日 外婆家， 12日 ？ 13日 外婆，dokidoki cao，全tm记不起来了我一直以为我可以记得很tm清楚的 不得不说，我真的是一个很拖延的人，明明知道有些事是对的事，有些事是错的事，但是我并没有去做那些对的事，也没有改掉那些错的习惯。 离开舒适区，请，求你了。 大年三十又是糟糕的一天 一整天几乎就没干什么事情 在外婆家有一种什么都干不了的感觉 真的好烦。 与其坐以待毙，不如主动出击。 大一暑假假期见闻这个暑假好像很短啊！先是忙小学期，然后稍微修整了十多天军训就轰轰烈烈地开始了，度过了这个难忘的军训之后我抽空和几位舍友一起去南京玩了两天，回来之后就是现在了，开学了，我已经大二了。 首先说说小学期吧。这个小学期我选了三门非常喜欢的课：ICS、大学生健康教育和刑法与生活。真的是学到了很多的东西，虽然最后的成绩都不是很好看，但是回想上课的那四周我真的是完全地投入其中的。哎，期末的时候千万不要太放松，你一放松期末总评就刷刷往下掉，越到期末越是不能放松啊。 虽然这中间的十几天没有参加什么有意思有意义的社会实践，但是不久就开始小班长集训了。大学的军训我是一辈子都不会忘记的，这可能是大家最后一次表现地这么有凝聚力，共同齐心协力只为了一个共同的目标的时光了。我们收获珍贵的情谊，培养过硬的作风，把军人坚韧刚毅果敢的品质内化为自己的内心力量。虽然交大的军训确实是有点水，除了队列练习基本上没有什么别的主要的内容了，体贴学生简直到了放纵的地步，但是最后那几天方阵彩排的那个闷热的上午，我第一次知道我的手臂上居然能沁出如此细密的汗珠，第一次知道汗水流到眼睛里是多么的刺眼睛，第一次感受到汗水顺着腹部流下的奇痒难忍。","categories":[],"tags":[{"name":"寒假","slug":"寒假","permalink":"https://ainevsia.github.io/tags/寒假/"}]},{"title":"Reinstall my Win7 Ultimate","slug":"Win7-SSD","date":"2018-02-10T12:10:21.000Z","updated":"2019-03-02T06:45:43.475Z","comments":true,"path":"2018/02/10/Win7-SSD/","link":"","permalink":"https://ainevsia.github.io/2018/02/10/Win7-SSD/","excerpt":"","text":"TriggersMy old ThinkPad E430c, which my father bought in about 2012, is operatering more and more slowly nowadays. A few days ago, it even experienced several bruescreens breakups, and it took me a whole morning to just start it. After examing the hard-drive, I found that it was severely damaged, maybe due to the bumping on the road. So last night, I bought a SSD (TOSHIBA Q200 240G) PreparationsAfter searching the Internet for almost a whole day, I decided to still install the Win7 Ultimate. I also learned a lot through searching. :D I finally found a detailed tutorial called xitongcheng. It guided me to turn my original onlydisk into a USB setup disk. What I need now is only a Win7 system now (from msdn). Place the SSD in place and start your computerHere comes a terrible question.What should I do? I googled it and founded the solution. just type in three commands:123find --set-root /bootmgrchainloader /bootmgrboot and it entered the PE system. Then just choose the Win7 Ultimate. It works. install the DRIVERFirst of all, you should make sure that your computer can have access to the Internet. Then everything went on smoothly without explaination. Inflections I don’t want to reinstall any system any longer! It’s really complicated!","categories":[],"tags":[]}]}